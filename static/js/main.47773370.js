/*! For license information please see main.47773370.js.LICENSE.txt */
(()=>{"use strict";var e={43(e,t,n){e.exports=n(202)},153(e,t,n){var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:s,_owner:o.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202(e,t){var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function v(){}function _(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var b=_.prototype=new v;b.constructor=_,m(b,y.prototype),b.isPureReactComponent=!0;var w=Array.isArray,E=Object.prototype.hasOwnProperty,S={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function I(e,t,r){var i,s={},a=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)E.call(t,i)&&!T.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:a,ref:o,props:s,_owner:S.current}}function k(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function N(e,t,i,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===s?"."+A(l,0):s,w(a)?(i="",null!=e&&(i=e.replace(C,"$&/")+"/"),N(a,t,i,"",function(e){return e})):null!=a&&(k(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(C,"$&/")+"/")+e)),t.push(a)),1;if(l=0,s=""===s?".":s+":",w(e))for(var c=0;c<e.length;c++){var u=s+A(o=e[c],c);l+=N(o,t,i,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=N(o=o.value,t,i,u=s+A(o,c++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function x(e,t,n){if(null==e)return e;var r=[],i=0;return N(e,r,"","",function(e){return t.call(n,e,i++)}),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},D={transition:null},L={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:D,ReactCurrentOwner:S};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:x,forEach:function(e,t,n){x(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return x(e,function(){t++}),t},toArray:function(e){return x(e,function(e){return e})||[]},only:function(e){if(!k(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=a,t.PureComponent=_,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.act=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),s=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=S.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)E.call(t,c)&&!T.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:a,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=I,t.createFactory=function(e){var t=I.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=k,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},234(e,t){function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function w(e){if(g=!1,b(e),!m)if(null!==r(c))m=!0,D(E);else{var t=r(u);null!==t&&L(w,t.startTime-e)}}function E(e,n){m=!1,g&&(g=!1,v(k),k=-1),p=!0;var s=f;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!N());){var a=h.callback;if("function"===typeof a){h.callback=null,f=h.priorityLevel;var o=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&i(c),b(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&L(w,d.startTime-n),l=!1}return l}finally{h=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,T=!1,I=null,k=-1,C=5,A=-1;function N(){return!(t.unstable_now()-A<C)}function x(){if(null!==I){var e=t.unstable_now();A=e;var n=!0;try{n=I(!0,e)}finally{n?S():(T=!1,I=null)}}else T=!1}if("function"===typeof _)S=function(){_(x)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,P=R.port2;R.port1.onmessage=x,S=function(){P.postMessage(null)}}else S=function(){y(x,0)};function D(e){I=e,T||(T=!0,S())}function L(e,n){k=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,D(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(v(k),k=-1):g=!0,L(w,s-a))):(e.sortIndex=o,n(c,e),m||p||(m=!0,D(E))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391(e,t,n){var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579(e,t,n){e.exports=n(153)},730(e,t,n){var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,s,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function _(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),E=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),C=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var j,F=Object.assign;function M(e){if(void 0===j)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);j=t&&t[1]||""}return"\n"+j+e}var U=!1;function B(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),s=r.stack.split("\n"),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||i[a]!==s[o]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?M(e):""}function V(e){switch(e.tag){case 5:return M(e.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case E:return"Portal";case I:return"Profiler";case T:return"StrictMode";case N:return"Suspense";case x:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case k:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return z(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function J(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&_(e,"checked",t,!1)}function Z(e,t){X(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&J(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function se(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ye=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function _e(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ee=null,Se=null,Te=null;function Ie(e){if(e=_i(e)){if("function"!==typeof Ee)throw Error(s(280));var t=e.stateNode;t&&(t=wi(t),Ee(e.stateNode,e.type,t))}}function ke(e){Se?Te?Te.push(e):Te=[e]:Se=e}function Ce(){if(Se){var e=Se,t=Te;if(Te=Se=null,Ie(e),t)for(e=0;e<t.length;e++)Ie(t[e])}}function Ae(e,t){return e(t)}function Ne(){}var xe=!1;function Re(e,t,n){if(xe)return e(t,n);xe=!0;try{return Ae(e,t,n)}finally{xe=!1,(null!==Se||null!==Te)&&(Ne(),Ce())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=wi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var De=!1;if(u)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){De=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(ue){De=!1}function Oe(e,t,n,r,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var je=!1,Fe=null,Me=!1,Ue=null,Be={onError:function(e){je=!0,Fe=e}};function Ve(e,t,n,r,i,s,a,o,l){je=!1,Fe=null,Oe.apply(Be,arguments)}function ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(ze(e)!==e)throw Error(s(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return We(i),e;if(a===r)return We(i),t;a=a.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Je=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Xe=i.unstable_now,Ze=i.unstable_getCurrentPriorityLevel,$e=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~i;0!==o?r=dt(o):0!==(s&=a)&&(r=dt(s))}else 0!==(a=n&~i)?r=dt(a):0!==s&&(r=dt(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var _t=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,Et,St,Tt,It,kt=!1,Ct=[],At=null,Nt=null,xt=null,Rt=new Map,Pt=new Map,Dt=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":xt=null;break;case"pointerover":case"pointerout":Rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function jt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=_i(t))&&Et(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=vi(e.target);if(null!==t){var n=ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void It(e.priority,function(){St(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Mt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=_i(n))&&Et(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Ut(e,t,n){Mt(e)&&n.delete(t)}function Bt(){kt=!1,null!==At&&Mt(At)&&(At=null),null!==Nt&&Mt(Nt)&&(Nt=null),null!==xt&&Mt(xt)&&(xt=null),Rt.forEach(Ut),Pt.forEach(Ut)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,kt||(kt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Bt)))}function zt(e){function t(t){return Vt(t,e)}if(0<Ct.length){Vt(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==At&&Vt(At,e),null!==Nt&&Vt(Nt,e),null!==xt&&Vt(xt,e),Rt.forEach(t),Pt.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Dt.shift()}var Ht=b.ReactCurrentBatchConfig,Wt=!0;function qt(e,t,n,r){var i=_t,s=Ht.transition;Ht.transition=null;try{_t=1,Kt(e,t,n,r)}finally{_t=i,Ht.transition=s}}function Gt(e,t,n,r){var i=_t,s=Ht.transition;Ht.transition=null;try{_t=4,Kt(e,t,n,r)}finally{_t=i,Ht.transition=s}}function Kt(e,t,n,r){if(Wt){var i=Qt(e,t,n,r);if(null===i)Wr(e,t,r,Jt,n),Ot(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return At=jt(At,e,t,n,r,i),!0;case"dragenter":return Nt=jt(Nt,e,t,n,r,i),!0;case"mouseover":return xt=jt(xt,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Rt.set(s,jt(Rt.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Pt.set(s,jt(Pt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Ot(e,r),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var s=_i(i);if(null!==s&&wt(s),null===(s=Qt(e,t,n,r))&&Wr(e,t,r,Jt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Jt=null;function Qt(e,t,n,r){if(Jt=null,null!==(e=vi(e=we(r))))if(null===(t=ze(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Xt=null,Zt=null,$t=null;function en(){if($t)return $t;var e,t,n=Zt,r=n.length,i="value"in Xt?Xt.value:Xt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[s-t];t++);return $t=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),dn=F({},cn,{view:0,detail:0}),hn=sn(dn),fn=F({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:In,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=sn(fn),mn=sn(F({},fn,{dataTransfer:0})),gn=sn(F({},dn,{relatedTarget:0})),yn=sn(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_n=sn(vn),bn=sn(F({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function In(){return Tn}var kn=F({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:In,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=sn(kn),An=sn(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=sn(F({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:In})),xn=sn(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=F({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=sn(Rn),Dn=[9,13,27,32],Ln=u&&"CompositionEvent"in window,On=null;u&&"documentMode"in document&&(On=document.documentMode);var jn=u&&"TextEvent"in window&&!On,Fn=u&&(!Ln||On&&8<On&&11>=On),Mn=String.fromCharCode(32),Un=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function qn(e,t,n,r){ke(r),0<(t=Gr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Kn=null;function Jn(e){Mr(e,0)}function Qn(e){if(K(bi(e)))return e}function Yn(e,t){if("change"===e)return t}var Xn=!1;if(u){var Zn;if(u){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}Zn=$n}else Zn=!1;Xn=Zn&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),Kn=Gn=null)}function nr(e){if("value"===e.propertyName&&Qn(Kn)){var t=[];qn(t,Kn,e,we(e)),Re(Jn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Kn)}function sr(e,t){if("click"===e)return Qn(t)}function ar(e,t){if("input"===e||"change"===e)return Qn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!or(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=J((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=ur(n,s);var a=ur(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,_r=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_r||null==gr||gr!==J(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Gr(yr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Er={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Sr={},Tr={};function Ir(e){if(Sr[e])return Sr[e];if(!Er[e])return e;var t,n=Er[e];for(t in n)if(n.hasOwnProperty(t)&&t in Tr)return Sr[e]=n[t];return e}u&&(Tr=document.createElement("div").style,"AnimationEvent"in window||(delete Er.animationend.animation,delete Er.animationiteration.animation,delete Er.animationstart.animation),"TransitionEvent"in window||delete Er.transitionend.transition);var kr=Ir("animationend"),Cr=Ir("animationiteration"),Ar=Ir("animationstart"),Nr=Ir("transitionend"),xr=new Map,Rr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){xr.set(e,t),l(t,[e])}for(var Dr=0;Dr<Rr.length;Dr++){var Lr=Rr[Dr];Pr(Lr.toLowerCase(),"on"+(Lr[0].toUpperCase()+Lr.slice(1)))}Pr(kr,"onAnimationEnd"),Pr(Cr,"onAnimationIteration"),Pr(Ar,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Nr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Or="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Or));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,o,l,c){if(Ve.apply(this,arguments),je){if(!je)throw Error(s(198));var u=Fe;je=!1,Fe=null,Me||(Me=!0,Ue=u)}}(r,t,void 0,e),e.currentTarget=null}function Mr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Fr(i,o,c),s=l}else for(a=0;a<r.length;a++){if(l=(o=r[a]).instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Fr(i,o,c),s=l}}}if(Me)throw e=Ue,Me=!1,Ue=null,e}function Ur(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(Hr(t,e,2,!1),n.add(r))}function Br(e,t,n){var r=0;t&&(r|=4),Hr(n,e,r,t)}var Vr="_reactListening"+Math.random().toString(36).slice(2);function zr(e){if(!e[Vr]){e[Vr]=!0,a.forEach(function(t){"selectionchange"!==t&&(jr.has(t)||Br(t,!1,e),Br(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vr]||(t[Vr]=!0,Br("selectionchange",!1,t))}}function Hr(e,t,n,r){switch(Yt(t)){case 1:var i=qt;break;case 4:i=Gt;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var o=r.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==o;){if(null===(a=vi(o)))return;if(5===(l=a.tag)||6===l){r=s=a;continue e}o=o.parentNode}}r=r.return}Re(function(){var r=s,i=we(n),a=[];e:{var o=xr.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Cn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Nn;break;case kr:case Cr:case Ar:l=yn;break;case Nr:l=xn;break;case"scroll":l=hn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=_n;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==h&&(null!=(m=Pe(p,h))&&u.push(qr(p,m,f)))),d)break;p=p.return}0<u.length&&(o=new l(o,c,null,n,i),a.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!vi(c)&&!c[pi])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?vi(c):null)&&(c!==(d=ze(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,m="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=An,m="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?o:bi(l),f=null==c?o:bi(c),(o=new u(m,p+"leave",l,n,i)).target=d,o.relatedTarget=f,m=null,vi(i)===r&&((u=new u(h,p+"enter",c,n,i)).target=f,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,p=0,f=u=l;f;f=Kr(f))p++;for(f=0,m=h;m;m=Kr(m))f++;for(;0<p-f;)u=Kr(u),p--;for(;0<f-p;)h=Kr(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Kr(u),h=Kr(h)}u=null}else u=null;null!==l&&Jr(a,o,l,u,!1),null!==c&&null!==d&&Jr(a,d,c,u,!0)}if("select"===(l=(o=r?bi(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Yn;else if(Wn(o))if(Xn)g=ar;else{g=ir;var y=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=sr);switch(g&&(g=g(e,r))?qn(a,g,n,i):(y&&y(e,o,r),"focusout"===e&&(y=o._wrapperState)&&y.controlled&&"number"===o.type&&ee(o,"number",o.value)),y=r?bi(r):window,e){case"focusin":(Wn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":_r=!0;break;case"contextmenu":case"mouseup":case"dragend":_r=!1,br(a,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":br(a,n,i)}var v;if(Ln)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else zn?Bn(e,n)&&(_="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(_="onCompositionStart");_&&(Fn&&"ko"!==n.locale&&(zn||"onCompositionStart"!==_?"onCompositionEnd"===_&&zn&&(v=en()):(Zt="value"in(Xt=i)?Xt.value:Xt.textContent,zn=!0)),0<(y=Gr(r,_)).length&&(_=new bn(_,e,null,n,i),a.push({event:_,listeners:y}),v?_.data=v:null!==(v=Vn(n))&&(_.data=v))),(v=jn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Un=!0,Mn);case"textInput":return(e=t.data)===Mn&&Un?null:e;default:return null}}(e,n):function(e,t){if(zn)return"compositionend"===e||!Ln&&Bn(e,t)?(e=en(),$t=Zt=Xt=null,zn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(i=new bn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=v))}Mr(a,t)})}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Pe(e,n))&&r.unshift(qr(e,s,i)),null!=(s=Pe(e,t))&&r.push(qr(e,s,i))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Jr(e,t,n,r,i){for(var s=t._reactName,a=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,i?null!=(l=Pe(n,s))&&a.unshift(qr(n,l,o)):i||null!=(l=Pe(n,s))&&a.push(qr(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Qr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Xr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace(Yr,"")}function Zr(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(s(425))}function $r(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(oi)}:ri;function oi(e){setTimeout(function(){throw e})}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void zt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);zt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,fi="__reactProps$"+di,pi="__reactContainer$"+di,mi="__reactEvents$"+di,gi="__reactListeners$"+di,yi="__reactHandles$"+di;function vi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[hi])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function _i(e){return!(e=e[hi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function wi(e){return e[fi]||null}var Ei=[],Si=-1;function Ti(e){return{current:e}}function Ii(e){0>Si||(e.current=Ei[Si],Ei[Si]=null,Si--)}function ki(e,t){Si++,Ei[Si]=e.current,e.current=t}var Ci={},Ai=Ti(Ci),Ni=Ti(!1),xi=Ci;function Ri(e,t){var n=e.type.contextTypes;if(!n)return Ci;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Pi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Di(){Ii(Ni),Ii(Ai)}function Li(e,t,n){if(Ai.current!==Ci)throw Error(s(168));ki(Ai,t),ki(Ni,n)}function Oi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,H(e)||"Unknown",i));return F({},n,r)}function ji(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ci,xi=Ai.current,ki(Ai,e),ki(Ni,Ni.current),!0}function Fi(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Oi(e,t,xi),r.__reactInternalMemoizedMergedChildContext=e,Ii(Ni),Ii(Ai),ki(Ai,e)):Ii(Ni),ki(Ni,n)}var Mi=null,Ui=!1,Bi=!1;function Vi(e){null===Mi?Mi=[e]:Mi.push(e)}function zi(){if(!Bi&&null!==Mi){Bi=!0;var e=0,t=_t;try{var n=Mi;for(_t=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Mi=null,Ui=!1}catch(i){throw null!==Mi&&(Mi=Mi.slice(e+1)),Ke($e,zi),i}finally{_t=t,Bi=!1}}return null}var Hi=[],Wi=0,qi=null,Gi=0,Ki=[],Ji=0,Qi=null,Yi=1,Xi="";function Zi(e,t){Hi[Wi++]=Gi,Hi[Wi++]=qi,qi=e,Gi=t}function $i(e,t,n){Ki[Ji++]=Yi,Ki[Ji++]=Xi,Ki[Ji++]=Qi,Qi=e;var r=Yi;e=Xi;var i=32-at(r)-1;r&=~(1<<i),n+=1;var s=32-at(t)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Yi=1<<32-at(t)+i|n<<i|r,Xi=s+e}else Yi=1<<s|n<<i|r,Xi=e}function es(e){null!==e.return&&(Zi(e,1),$i(e,1,0))}function ts(e){for(;e===qi;)qi=Hi[--Wi],Hi[Wi]=null,Gi=Hi[--Wi],Hi[Wi]=null;for(;e===Qi;)Qi=Ki[--Ji],Ki[Ji]=null,Xi=Ki[--Ji],Ki[Ji]=null,Yi=Ki[--Ji],Ki[Ji]=null}var ns=null,rs=null,is=!1,ss=null;function as(e,t){var n=Pc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function os(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qi?{id:Yi,overflow:Xi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Pc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(is){var t=rs;if(t){var n=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=ci(n.nextSibling);var r=ns;t&&os(e,t)?as(r,n):(e.flags=-4097&e.flags|2,is=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,is=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function ds(e){if(e!==ns)return!1;if(!is)return us(e),is=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw hs(),Error(s(418));for(;t;)as(e,t),t=ci(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ci(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=rs;e;)e=ci(e.nextSibling)}function fs(){rs=ns=null,is=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var ms=b.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function ys(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vs(e){return(0,e._init)(e._payload)}function _s(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Lc(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Mc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===S?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===P&&vs(s)===t.type)?((r=i(t,n.props)).ref=gs(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=gs(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Uc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,s){return null===t||7!==t.tag?((t=jc(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Mc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case E:return(t=Uc(t,e.mode,n)).return=e,t;case P:return h(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=jc(t,e.mode,n,null)).return=e,t;ys(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?c(e,t,n,r):null;case E:return n.key===i?u(e,t,n,r):null;case P:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||O(n))return null!==i?null:d(e,t,n,r,null);ys(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case E:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case P:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||O(r))return d(t,e=e.get(n)||null,r,i,null);ys(t,r)}return null}function m(i,s,o,l){for(var c=null,u=null,d=s,m=s=0,g=null;null!==d&&m<o.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var y=f(i,d,o[m],l);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(i,d),s=a(y,s,m),null===u?c=y:u.sibling=y,u=y,d=g}if(m===o.length)return n(i,d),is&&Zi(i,m),c;if(null===d){for(;m<o.length;m++)null!==(d=h(i,o[m],l))&&(s=a(d,s,m),null===u?c=d:u.sibling=d,u=d);return is&&Zi(i,m),c}for(d=r(i,d);m<o.length;m++)null!==(g=p(d,i,m,o[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),s=a(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(i,e)}),is&&Zi(i,m),c}function g(i,o,l,c){var u=O(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var d=u=null,m=o,g=o=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var _=f(i,m,v.value,c);if(null===_){null===m&&(m=y);break}e&&m&&null===_.alternate&&t(i,m),o=a(_,o,g),null===d?u=_:d.sibling=_,d=_,m=y}if(v.done)return n(i,m),is&&Zi(i,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=h(i,v.value,c))&&(o=a(v,o,g),null===d?u=v:d.sibling=v,d=v);return is&&Zi(i,g),u}for(m=r(i,m);!v.done;g++,v=l.next())null!==(v=p(m,i,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),o=a(v,o,g),null===d?u=v:d.sibling=v,d=v);return e&&m.forEach(function(e){return t(i,e)}),is&&Zi(i,g),u}return function e(r,s,a,l){if("object"===typeof a&&null!==a&&a.type===S&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var c=a.key,u=s;null!==u;){if(u.key===c){if((c=a.type)===S){if(7===u.tag){n(r,u.sibling),(s=i(u,a.props.children)).return=r,r=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&vs(c)===u.type){n(r,u.sibling),(s=i(u,a.props)).ref=gs(r,u,a),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}a.type===S?((s=jc(a.props.children,r.mode,l,a.key)).return=r,r=s):((l=Oc(a.type,a.key,a.props,null,r.mode,l)).ref=gs(r,s,a),l.return=r,r=l)}return o(r);case E:e:{for(u=a.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(r,s.sibling),(s=i(s,a.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Uc(a,r.mode,l)).return=r,r=s}return o(r);case P:return e(r,s,(u=a._init)(a._payload),l)}if(te(a))return m(r,s,a,l);if(O(a))return g(r,s,a,l);ys(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,a)).return=r,r=s):(n(r,s),(s=Mc(a,r.mode,l)).return=r,r=s),o(r)):n(r,s)}}var bs=_s(!0),ws=_s(!1),Es=Ti(null),Ss=null,Ts=null,Is=null;function ks(){Is=Ts=Ss=null}function Cs(e){var t=Es.current;Ii(Es),e._currentValue=t}function As(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ns(e,t){Ss=e,Is=Ts=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(wo=!0),e.firstContext=null)}function xs(e){var t=e._currentValue;if(Is!==e)if(e={context:e,memoizedValue:t,next:null},null===Ts){if(null===Ss)throw Error(s(308));Ts=e,Ss.dependencies={lanes:0,firstContext:e}}else Ts=Ts.next=e;return t}var Rs=null;function Ps(e){null===Rs?Rs=[e]:Rs.push(e)}function Ds(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Ps(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ls(e,r)}function Ls(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Os=!1;function js(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ms(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Nl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ls(e,n)}return null===(i=r.interleaved)?(t.next=t,Ps(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ls(e,n)}function Bs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Vs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function zs(e,t,n,r){var i=e.updateQueue;Os=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?s=c:a.next=c,a=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=i.baseState;for(a=0,u=c=l=null,o=s;;){var h=o.lane,f=o.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(h=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=m.payload)?p.call(f,d,h):p)||void 0===h)break e;d=F({},d,h);break e;case 2:Os=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,a|=h;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(h=o).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);Fl|=a,e.lanes=a,e.memoizedState=d}}function Hs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var Ws={},qs=Ti(Ws),Gs=Ti(Ws),Ks=Ti(Ws);function Js(e){if(e===Ws)throw Error(s(174));return e}function Qs(e,t){switch(ki(Ks,t),ki(Gs,e),ki(qs,Ws),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ii(qs),ki(qs,t)}function Ys(){Ii(qs),Ii(Gs),Ii(Ks)}function Xs(e){Js(Ks.current);var t=Js(qs.current),n=le(t,e.type);t!==n&&(ki(Gs,e),ki(qs,n))}function Zs(e){Gs.current===e&&(Ii(qs),Ii(Gs))}var $s=Ti(0);function ea(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ta=[];function na(){for(var e=0;e<ta.length;e++)ta[e]._workInProgressVersionPrimary=null;ta.length=0}var ra=b.ReactCurrentDispatcher,ia=b.ReactCurrentBatchConfig,sa=0,aa=null,oa=null,la=null,ca=!1,ua=!1,da=0,ha=0;function fa(){throw Error(s(321))}function pa(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function ga(e,t,n,r,i,a){if(sa=a,aa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ra.current=null===e||null===e.memoizedState?eo:to,e=n(r,i),ua){a=0;do{if(ua=!1,da=0,25<=a)throw Error(s(301));a+=1,la=oa=null,t.updateQueue=null,ra.current=no,e=n(r,i)}while(ua)}if(ra.current=$a,t=null!==oa&&null!==oa.next,sa=0,la=oa=aa=null,ca=!1,t)throw Error(s(300));return e}function ya(){var e=0!==da;return da=0,e}function va(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?aa.memoizedState=la=e:la=la.next=e,la}function _a(){if(null===oa){var e=aa.alternate;e=null!==e?e.memoizedState:null}else e=oa.next;var t=null===la?aa.memoizedState:la.next;if(null!==t)la=t,oa=e;else{if(null===e)throw Error(s(310));e={memoizedState:(oa=e).memoizedState,baseState:oa.baseState,baseQueue:oa.baseQueue,queue:oa.queue,next:null},null===la?aa.memoizedState=la=e:la=la.next=e}return la}function ba(e,t){return"function"===typeof t?t(e):t}function wa(e){var t=_a(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=oa,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((sa&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,aa.lanes|=d,Fl|=d}u=u.next}while(null!==u&&u!==a);null===c?o=r:c.next=l,or(r,t.memoizedState)||(wo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,aa.lanes|=a,Fl|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ea(e){var t=_a(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{a=e(a,o.action),o=o.next}while(o!==i);or(a,t.memoizedState)||(wo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Sa(){}function Ta(e,t){var n=aa,r=_a(),i=t(),a=!or(r.memoizedState,i);if(a&&(r.memoizedState=i,wo=!0),r=r.queue,ja(Ca.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,Ra(9,ka.bind(null,n,r,i,t),void 0,null),null===xl)throw Error(s(349));0!==(30&sa)||Ia(n,t,i)}return i}function Ia(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ka(e,t,n,r){t.value=n,t.getSnapshot=r,Aa(t)&&Na(e)}function Ca(e,t,n){return n(function(){Aa(t)&&Na(e)})}function Aa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function Na(e){var t=Ls(e,1);null!==t&&rc(t,e,1,-1)}function xa(e){var t=va();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:e},t.queue=e,e=e.dispatch=Qa.bind(null,aa,e),[t.memoizedState,e]}function Ra(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Pa(){return _a().memoizedState}function Da(e,t,n,r){var i=va();aa.flags|=e,i.memoizedState=Ra(1|t,n,void 0,void 0===r?null:r)}function La(e,t,n,r){var i=_a();r=void 0===r?null:r;var s=void 0;if(null!==oa){var a=oa.memoizedState;if(s=a.destroy,null!==r&&pa(r,a.deps))return void(i.memoizedState=Ra(t,n,s,r))}aa.flags|=e,i.memoizedState=Ra(1|t,n,s,r)}function Oa(e,t){return Da(8390656,8,e,t)}function ja(e,t){return La(2048,8,e,t)}function Fa(e,t){return La(4,2,e,t)}function Ma(e,t){return La(4,4,e,t)}function Ua(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ba(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,La(4,4,Ua.bind(null,t,e),n)}function Va(){}function za(e,t){var n=_a();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&pa(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ha(e,t){var n=_a();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&pa(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Wa(e,t,n){return 0===(21&sa)?(e.baseState&&(e.baseState=!1,wo=!0),e.memoizedState=n):(or(n,t)||(n=mt(),aa.lanes|=n,Fl|=n,e.baseState=!0),t)}function qa(e,t){var n=_t;_t=0!==n&&4>n?n:4,e(!0);var r=ia.transition;ia.transition={};try{e(!1),t()}finally{_t=n,ia.transition=r}}function Ga(){return _a().memoizedState}function Ka(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ya(e))Xa(t,n);else if(null!==(n=Ds(e,t,n,r))){rc(n,e,r,tc()),Za(n,t,r)}}function Qa(e,t,n){var r=nc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ya(e))Xa(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(i.hasEagerState=!0,i.eagerState=o,or(o,a)){var l=t.interleaved;return null===l?(i.next=i,Ps(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Ds(e,t,i,r))&&(rc(n,e,r,i=tc()),Za(n,t,r))}}function Ya(e){var t=e.alternate;return e===aa||null!==t&&t===aa}function Xa(e,t){ua=ca=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Za(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var $a={readContext:xs,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},eo={readContext:xs,useCallback:function(e,t){return va().memoizedState=[e,void 0===t?null:t],e},useContext:xs,useEffect:Oa,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Da(4194308,4,Ua.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Da(4194308,4,e,t)},useInsertionEffect:function(e,t){return Da(4,2,e,t)},useMemo:function(e,t){var n=va();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=va();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ka.bind(null,aa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},va().memoizedState=e},useState:xa,useDebugValue:Va,useDeferredValue:function(e){return va().memoizedState=e},useTransition:function(){var e=xa(!1),t=e[0];return e=qa.bind(null,e[1]),va().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=aa,i=va();if(is){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===xl)throw Error(s(349));0!==(30&sa)||Ia(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Oa(Ca.bind(null,r,a,e),[e]),r.flags|=2048,Ra(9,ka.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=va(),t=xl.identifierPrefix;if(is){var n=Xi;t=":"+t+"R"+(n=(Yi&~(1<<32-at(Yi)-1)).toString(32)+n),0<(n=da++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ha++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},to={readContext:xs,useCallback:za,useContext:xs,useEffect:ja,useImperativeHandle:Ba,useInsertionEffect:Fa,useLayoutEffect:Ma,useMemo:Ha,useReducer:wa,useRef:Pa,useState:function(){return wa(ba)},useDebugValue:Va,useDeferredValue:function(e){return Wa(_a(),oa.memoizedState,e)},useTransition:function(){return[wa(ba)[0],_a().memoizedState]},useMutableSource:Sa,useSyncExternalStore:Ta,useId:Ga,unstable_isNewReconciler:!1},no={readContext:xs,useCallback:za,useContext:xs,useEffect:ja,useImperativeHandle:Ba,useInsertionEffect:Fa,useLayoutEffect:Ma,useMemo:Ha,useReducer:Ea,useRef:Pa,useState:function(){return Ea(ba)},useDebugValue:Va,useDeferredValue:function(e){var t=_a();return null===oa?t.memoizedState=e:Wa(t,oa.memoizedState,e)},useTransition:function(){return[Ea(ba)[0],_a().memoizedState]},useMutableSource:Sa,useSyncExternalStore:Ta,useId:Ga,unstable_isNewReconciler:!1};function ro(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function io(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var so={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),s=Ms(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,i))&&(rc(t,e,i,r),Bs(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),s=Ms(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,i))&&(rc(t,e,i,r),Bs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),i=Ms(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Us(e,i,r))&&(rc(t,e,r,n),Bs(t,e,r))}};function ao(e,t,n,r,i,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,s))}function oo(e,t,n){var r=!1,i=Ci,s=t.contextType;return"object"===typeof s&&null!==s?s=xs(s):(i=Pi(t)?xi:Ai.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ri(e,i):Ci),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=so,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function lo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&so.enqueueReplaceState(t,t.state,null)}function co(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},js(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=xs(s):(s=Pi(t)?xi:Ai.current,i.context=Ri(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(io(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&so.enqueueReplaceState(i,i.state,null),zs(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function uo(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function ho(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function fo(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var po="function"===typeof WeakMap?WeakMap:Map;function mo(e,t,n){(n=Ms(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ql||(ql=!0,Gl=r),fo(0,t)},n}function go(e,t,n){(n=Ms(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){fo(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){fo(0,t),"function"!==typeof r&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function yo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new po;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=kc.bind(null,e,t,n),t.then(e,e))}function vo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function _o(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ms(-1,1)).tag=2,Us(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var bo=b.ReactCurrentOwner,wo=!1;function Eo(e,t,n,r){t.child=null===e?ws(t,null,n,r):bs(t,e.child,n,r)}function So(e,t,n,r,i){n=n.render;var s=t.ref;return Ns(t,i),r=ga(e,t,n,r,s,i),n=ya(),null===e||wo?(is&&n&&es(t),t.flags|=1,Eo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qo(e,t,i))}function To(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Dc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Io(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return qo(e,t,i)}return t.flags|=1,(e=Lc(s,r)).ref=t.ref,e.return=t,t.child=e}function Io(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(wo=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,qo(e,t,i);0!==(131072&e.flags)&&(wo=!0)}}return Ao(e,t,n,r,i)}function ko(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ki(Ll,Dl),Dl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ki(Ll,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,ki(Ll,Dl),Dl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,ki(Ll,Dl),Dl|=r;return Eo(e,t,i,n),t.child}function Co(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ao(e,t,n,r,i){var s=Pi(n)?xi:Ai.current;return s=Ri(t,s),Ns(t,i),n=ga(e,t,n,r,s,i),r=ya(),null===e||wo?(is&&r&&es(t),t.flags|=1,Eo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qo(e,t,i))}function No(e,t,n,r,i){if(Pi(n)){var s=!0;ji(t)}else s=!1;if(Ns(t,i),null===t.stateNode)Wo(e,t),oo(t,n,r),co(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=xs(c):c=Ri(t,c=Pi(n)?xi:Ai.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==r||l!==c)&&lo(t,a,r,c),Os=!1;var h=t.memoizedState;a.state=h,zs(t,r,a,i),l=t.memoizedState,o!==r||h!==l||Ni.current||Os?("function"===typeof u&&(io(t,n,u,r),l=t.memoizedState),(o=Os||ao(t,n,o,r,h,l,c))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Fs(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:ro(t.type,o),a.props=c,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=xs(l):l=Ri(t,l=Pi(n)?xi:Ai.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==d||h!==l)&&lo(t,a,r,l),Os=!1,h=t.memoizedState,a.state=h,zs(t,r,a,i);var p=t.memoizedState;o!==d||h!==p||Ni.current||Os?("function"===typeof f&&(io(t,n,f,r),p=t.memoizedState),(c=Os||ao(t,n,c,r,h,p,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return xo(e,t,n,r,s,i)}function xo(e,t,n,r,i,s){Co(e,t);var a=0!==(128&t.flags);if(!r&&!a)return i&&Fi(t,n,!1),qo(e,t,s);r=t.stateNode,bo.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=bs(t,e.child,null,s),t.child=bs(t,null,o,s)):Eo(e,t,o,s),t.memoizedState=r.state,i&&Fi(t,n,!0),t.child}function Ro(e){var t=e.stateNode;t.pendingContext?Li(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Li(0,t.context,!1),Qs(e,t.containerInfo)}function Po(e,t,n,r,i){return fs(),ps(i),t.flags|=256,Eo(e,t,n,r),t.child}var Do,Lo,Oo,jo={dehydrated:null,treeContext:null,retryLane:0};function Fo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Mo(e,t,n){var r,i=t.pendingProps,a=$s.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),ki($s,1&a),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,o?(i=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Fc(l,i,0,null),e=jc(e,i,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Fo(n),t.memoizedState=jo,e):Uo(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,o){if(n)return 256&t.flags?(t.flags&=-257,Bo(e,t,o,r=ho(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Fc({mode:"visible",children:r.children},i,0,null),(a=jc(a,i,o,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&bs(t,e.child,null,o),t.child.memoizedState=Fo(o),t.memoizedState=jo,a);if(0===(1&t.mode))return Bo(e,t,o,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Bo(e,t,o,r=ho(a=Error(s(419)),r,void 0))}if(l=0!==(o&e.childLanes),wo||l){if(null!==(r=xl)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|o))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Ls(e,i),rc(r,e,i,-1))}return gc(),Bo(e,t,o,r=ho(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Ac.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,rs=ci(i.nextSibling),ns=t,is=!0,ss=null,null!==e&&(Ki[Ji++]=Yi,Ki[Ji++]=Xi,Ki[Ji++]=Qi,Yi=e.id,Xi=e.overflow,Qi=t),t=Uo(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,a,n);if(o){o=i.fallback,l=t.mode,r=(a=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Lc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==r?o=Lc(r,o):(o=jc(o,l,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,l=null===(l=e.child.memoizedState)?Fo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=jo,i}return e=(o=e.child).sibling,i=Lc(o,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Uo(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bo(e,t,n,r){return null!==r&&ps(r),bs(t,e.child,null,n),(e=Uo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Vo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),As(e.return,t,n)}function zo(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Ho(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(Eo(e,t,r.children,n),0!==(2&(r=$s.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Vo(e,n,t);else if(19===e.tag)Vo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ki($s,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ea(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),zo(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ea(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}zo(t,!0,n,null,s);break;case"together":zo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Lc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Lc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Go(e,t){if(!is)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ko(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Jo(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ko(t),null;case 1:case 17:return Pi(t.type)&&Di(),Ko(t),null;case 3:return r=t.stateNode,Ys(),Ii(Ni),Ii(Ai),na(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(oc(ss),ss=null))),Ko(t),null;case 5:Zs(t);var i=Js(Ks.current);if(n=t.type,null!==e&&null!=t.stateNode)Lo(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Ko(t),null}if(e=Js(qs.current),ds(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[hi]=t,r[fi]=a,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(i=0;i<Or.length;i++)Ur(Or[i],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":Y(r,a),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ur("invalid",r);break;case"textarea":ie(r,a),Ur("invalid",r)}for(var l in ve(n,a),i=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&Zr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Zr(r.textContent,c,e),i=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":G(r),$(r,a,!0);break;case"textarea":G(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=$r)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hi]=t,e[fi]=r,Do(e,t),t.stateNode=e;e:{switch(l=_e(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),i=r;break;case"iframe":case"object":case"embed":Ur("load",e),i=r;break;case"video":case"audio":for(i=0;i<Or.length;i++)Ur(Or[i],e);i=r;break;case"source":Ur("error",e),i=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),i=r;break;case"details":Ur("toggle",e),i=r;break;case"input":Y(e,r),i=Q(e,r),Ur("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=F({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Ur("invalid",e)}for(a in ve(n,i),c=i)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?ge(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Ur("scroll",e):null!=u&&_(e,a,u,l))}switch(n){case"input":G(e),$(e,r,!1);break;case"textarea":G(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ko(t),null;case 6:if(e&&null!=t.stateNode)Oo(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Js(Ks.current),Js(qs.current),ds(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(a=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Zr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Ko(t),null;case 13:if(Ii($s),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(is&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))hs(),fs(),t.flags|=98560,a=!1;else if(a=ds(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[hi]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ko(t),a=!1}else null!==ss&&(oc(ss),ss=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&$s.current)?0===Ol&&(Ol=3):gc())),null!==t.updateQueue&&(t.flags|=4),Ko(t),null);case 4:return Ys(),null===e&&zr(t.stateNode.containerInfo),Ko(t),null;case 10:return Cs(t.type._context),Ko(t),null;case 19:if(Ii($s),null===(a=t.memoizedState))return Ko(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Go(a,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ea(e))){for(t.flags|=128,Go(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ki($s,1&$s.current|2),t.child}e=e.sibling}null!==a.tail&&Xe()>Hl&&(t.flags|=128,r=!0,Go(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ea(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Go(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!is)return Ko(t),null}else 2*Xe()-a.renderingStartTime>Hl&&1073741824!==n&&(t.flags|=128,r=!0,Go(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Xe(),t.sibling=null,n=$s.current,ki($s,r?1&n|2:1&n),t):(Ko(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(Ko(t),6&t.subtreeFlags&&(t.flags|=8192)):Ko(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Qo(e,t){switch(ts(t),t.tag){case 1:return Pi(t.type)&&Di(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ys(),Ii(Ni),Ii(Ai),na(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zs(t),null;case 13:if(Ii($s),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ii($s),null;case 4:return Ys(),null;case 10:return Cs(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Do=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Lo=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Js(qs.current);var s,a=null;switch(n){case"input":i=Q(e,i),r=Q(e,r),a=[];break;case"select":i=F({},i,{value:void 0}),r=F({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=$r)}for(u in ve(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ur("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Oo=function(e,t,n,r){n!==r&&(t.flags|=4)};var Yo=!1,Xo=!1,Zo="function"===typeof WeakSet?WeakSet:Set,$o=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ic(e,t,r)}else n.current=null}function tl(e,t,n){try{n()}catch(r){Ic(e,t,r)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&tl(t,n,s)}i=i.next}while(i!==r)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[fi],delete t[mi],delete t[gi],delete t[yi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$r));else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var dl=null,hl=!1;function fl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(o){}switch(n.tag){case 5:Xo||el(n,t);case 6:var r=dl,i=hl;dl=null,fl(e,t,n),hl=i,null!==(dl=r)&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),zt(e)):li(dl,n.stateNode));break;case 4:r=dl,i=hl,dl=n.stateNode.containerInfo,hl=!0,fl(e,t,n),dl=r,hl=i;break;case 0:case 11:case 14:case 15:if(!Xo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,void 0!==a&&(0!==(2&s)||0!==(4&s))&&tl(n,t,a),i=i.next}while(i!==r)}fl(e,t,n);break;case 1:if(!Xo&&(el(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Ic(n,t,o)}fl(e,t,n);break;case 21:fl(e,t,n);break;case 22:1&n.mode?(Xo=(r=Xo)||null!==n.memoizedState,fl(e,t,n),Xo=r):fl(e,t,n);break;default:fl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Zo),t.forEach(function(t){var r=Nc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function gl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,hl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===dl)throw Error(s(160));pl(a,o,i),dl=null,hl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Ic(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)yl(t,e),t=t.sibling}function yl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),vl(e),4&r){try{rl(3,e,e.return),il(3,e)}catch(g){Ic(e,e.return,g)}try{rl(5,e,e.return)}catch(g){Ic(e,e.return,g)}}break;case 1:gl(t,e),vl(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(gl(t,e),vl(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(g){Ic(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&X(i,a),_e(l,o);var u=_e(l,a);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];"style"===d?ge(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):_(i,d,h,u)}switch(l){case"input":Z(i,a);break;case"textarea":se(i,a);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?ne(i,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[fi]=a}catch(g){Ic(e,e.return,g)}}break;case 6:if(gl(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){Ic(e,e.return,g)}}break;case 3:if(gl(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(g){Ic(e,e.return,g)}break;case 4:default:gl(t,e),vl(e);break;case 13:gl(t,e),vl(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(zl=Xe())),4&r&&ml(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Xo=(u=Xo)||d,gl(t,e),Xo=u):gl(t,e),vl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for($o=e,d=e.child;null!==d;){for(h=$o=d;null!==$o;){switch(p=(f=$o).child,f.tag){case 0:case 11:case 14:case 15:rl(4,f,f.return);break;case 1:el(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Ic(r,n,g)}}break;case 5:el(f,f.return);break;case 22:if(null!==f.memoizedState){El(h);continue}}null!==p?(p.return=f,$o=p):El(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,u?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){Ic(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Ic(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gl(t,e),vl(e),4&r&&ml(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),ul(e,ll(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;cl(e,ll(e),a);break;default:throw Error(s(161))}}catch(Ja){Ic(e,e.return,Ja)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function _l(e,t,n){$o=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==$o;){var i=$o,s=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Yo;if(!a){var o=i.alternate,l=null!==o&&null!==o.memoizedState||Xo;o=Yo;var c=Xo;if(Yo=a,(Xo=l)&&!c)for($o=i;null!==$o;)l=(a=$o).child,22===a.tag&&null!==a.memoizedState?Sl(i):null!==l?(l.return=a,$o=l):Sl(i);for(;null!==s;)$o=s,bl(s,t,n),s=s.sibling;$o=i,Yo=o,Xo=c}wl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,$o=s):wl(e)}}function wl(e){for(;null!==$o;){var t=$o;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xo||il(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xo)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ro(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Hs(t,a,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Hs(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&zt(h)}}}break;default:throw Error(s(163))}Xo||512&t.flags&&sl(t)}catch(f){Ic(t,t.return,f)}}if(t===e){$o=null;break}if(null!==(n=t.sibling)){n.return=t.return,$o=n;break}$o=t.return}}function El(e){for(;null!==$o;){var t=$o;if(t===e){$o=null;break}var n=t.sibling;if(null!==n){n.return=t.return,$o=n;break}$o=t.return}}function Sl(e){for(;null!==$o;){var t=$o;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(Ja){Ic(t,n,Ja)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(Ja){Ic(t,i,Ja)}}var s=t.return;try{sl(t)}catch(Ja){Ic(t,s,Ja)}break;case 5:var a=t.return;try{sl(t)}catch(Ja){Ic(t,a,Ja)}}}catch(Ja){Ic(t,t.return,Ja)}if(t===e){$o=null;break}var o=t.sibling;if(null!==o){o.return=t.return,$o=o;break}$o=t.return}}var Tl,Il=Math.ceil,kl=b.ReactCurrentDispatcher,Cl=b.ReactCurrentOwner,Al=b.ReactCurrentBatchConfig,Nl=0,xl=null,Rl=null,Pl=0,Dl=0,Ll=Ti(0),Ol=0,jl=null,Fl=0,Ml=0,Ul=0,Bl=null,Vl=null,zl=0,Hl=1/0,Wl=null,ql=!1,Gl=null,Kl=null,Jl=!1,Ql=null,Yl=0,Xl=0,Zl=null,$l=-1,ec=0;function tc(){return 0!==(6&Nl)?Xe():-1!==$l?$l:$l=Xe()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Nl)&&0!==Pl?Pl&-Pl:null!==ms.transition?(0===ec&&(ec=mt()),ec):0!==(e=_t)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function rc(e,t,n,r){if(50<Xl)throw Xl=0,Zl=null,Error(s(185));yt(e,n,r),0!==(2&Nl)&&e===xl||(e===xl&&(0===(2&Nl)&&(Ml|=n),4===Ol&&lc(e,Pl)),ic(e,r),1===n&&0===Nl&&0===(1&t.mode)&&(Hl=Xe()+500,Ui&&zi()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-at(s),o=1<<a,l=i[a];-1===l?0!==(o&n)&&0===(o&r)||(i[a]=ft(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var r=ht(e,e===xl?Pl:0);if(0===r)null!==n&&Je(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Je(n),1===t)0===e.tag?function(e){Ui=!0,Vi(e)}(cc.bind(null,e)):Vi(cc.bind(null,e)),ai(function(){0===(6&Nl)&&zi()}),n=null;else{switch(bt(r)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=xc(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if($l=-1,ec=0,0!==(6&Nl))throw Error(s(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var r=ht(e,e===xl?Pl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=yc(e,r);else{t=r;var i=Nl;Nl|=2;var a=mc();for(xl===e&&Pl===t||(Wl=null,Hl=Xe()+500,fc(e,t));;)try{_c();break}catch(l){pc(e,l)}ks(),kl.current=a,Nl=i,null!==Rl?t=0:(xl=null,Pl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=ac(e,i))),1===t)throw n=jl,fc(e,0),lc(e,r),ic(e,Xe()),n;if(6===t)lc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!or(s(),i))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=yc(e,r))&&(0!==(a=pt(e))&&(r=a,t=ac(e,a))),1===t))throw n=jl,fc(e,0),lc(e,r),ic(e,Xe()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:Ec(e,Vl,Wl);break;case 3:if(lc(e,r),(130023424&r)===r&&10<(t=zl+500-Xe())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(Ec.bind(null,e,Vl,Wl),t);break}Ec(e,Vl,Wl);break;case 4:if(lc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-at(r);a=1<<o,(o=t[o])>i&&(i=o),r&=~a}if(r=i,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Il(r/1960))-r)){e.timeoutHandle=ri(Ec.bind(null,e,Vl,Wl),r);break}Ec(e,Vl,Wl);break;default:throw Error(s(329))}}}return ic(e,Xe()),e.callbackNode===n?sc.bind(null,e):null}function ac(e,t){var n=Bl;return e.current.memoizedState.isDehydrated&&(fc(e,t).flags|=256),2!==(e=yc(e,t))&&(t=Vl,Vl=n,null!==t&&oc(t)),e}function oc(e){null===Vl?Vl=e:Vl.push.apply(Vl,e)}function lc(e,t){for(t&=~Ul,t&=~Ml,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Nl))throw Error(s(327));Sc();var t=ht(e,0);if(0===(1&t))return ic(e,Xe()),null;var n=yc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=ac(e,r))}if(1===n)throw n=jl,fc(e,0),lc(e,t),ic(e,Xe()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ec(e,Vl,Wl),ic(e,Xe()),null}function uc(e,t){var n=Nl;Nl|=1;try{return e(t)}finally{0===(Nl=n)&&(Hl=Xe()+500,Ui&&zi())}}function dc(e){null!==Ql&&0===Ql.tag&&0===(6&Nl)&&Sc();var t=Nl;Nl|=1;var n=Al.transition,r=_t;try{if(Al.transition=null,_t=1,e)return e()}finally{_t=r,Al.transition=n,0===(6&(Nl=t))&&zi()}}function hc(){Dl=Ll.current,Ii(Ll)}function fc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Rl)for(n=Rl.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Di();break;case 3:Ys(),Ii(Ni),Ii(Ai),na();break;case 5:Zs(r);break;case 4:Ys();break;case 13:case 19:Ii($s);break;case 10:Cs(r.type._context);break;case 22:case 23:hc()}n=n.return}if(xl=e,Rl=e=Lc(e.current,null),Pl=Dl=t,Ol=0,jl=null,Ul=Ml=Fl=0,Vl=Bl=null,null!==Rs){for(t=0;t<Rs.length;t++)if(null!==(r=(n=Rs[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var a=s.next;s.next=i,r.next=a}n.pending=r}Rs=null}return e}function pc(e,t){for(;;){var n=Rl;try{if(ks(),ra.current=$a,ca){for(var r=aa.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ca=!1}if(sa=0,la=oa=aa=null,ua=!1,da=0,Cl.current=null,null===n||null===n.return){Ol=1,jl=t,Rl=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=Pl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=vo(o);if(null!==p){p.flags&=-257,_o(p,o,l,0,t),1&p.mode&&yo(a,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){yo(a,u,t),gc();break e}c=Error(s(426))}else if(is&&1&l.mode){var y=vo(o);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),_o(y,o,l,0,t),ps(uo(c,l));break e}}a=c=uo(c,l),4!==Ol&&(Ol=2),null===Bl?Bl=[a]:Bl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Vs(a,mo(0,c,t));break e;case 1:l=c;var v=a.type,_=a.stateNode;if(0===(128&a.flags)&&("function"===typeof v.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===Kl||!Kl.has(_)))){a.flags|=65536,t&=-t,a.lanes|=t,Vs(a,go(a,l,t));break e}}a=a.return}while(null!==a)}wc(n)}catch(b){t=b,Rl===n&&null!==n&&(Rl=n=n.return);continue}break}}function mc(){var e=kl.current;return kl.current=$a,null===e?$a:e}function gc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===xl||0===(268435455&Fl)&&0===(268435455&Ml)||lc(xl,Pl)}function yc(e,t){var n=Nl;Nl|=2;var r=mc();for(xl===e&&Pl===t||(Wl=null,fc(e,t));;)try{vc();break}catch(i){pc(e,i)}if(ks(),Nl=n,kl.current=r,null!==Rl)throw Error(s(261));return xl=null,Pl=0,Ol}function vc(){for(;null!==Rl;)bc(Rl)}function _c(){for(;null!==Rl&&!Qe();)bc(Rl)}function bc(e){var t=Tl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?wc(e):Rl=t,Cl.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Jo(n,t,Dl)))return void(Rl=n)}else{if(null!==(n=Qo(n,t)))return n.flags&=32767,void(Rl=n);if(null===e)return Ol=6,void(Rl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Rl=t);Rl=t=e}while(null!==t);0===Ol&&(Ol=5)}function Ec(e,t,n){var r=_t,i=Al.transition;try{Al.transition=null,_t=1,function(e,t,n,r){do{Sc()}while(null!==Ql);if(0!==(6&Nl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,a),e===xl&&(Rl=xl=null,Pl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Jl||(Jl=!0,xc(tt,function(){return Sc(),null})),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Al.transition,Al.transition=null;var o=_t;_t=1;var l=Nl;Nl|=4,Cl.current=null,function(e,t){if(ei=Wt,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(ma){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(l=o+i),h!==a||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===i&&(l=o),f===a&&++d===r&&(c=o),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Wt=!1,$o=t;null!==$o;)if(e=(t=$o).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$o=e;else for(;null!==$o;){t=$o;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,_=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:ro(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(s(163))}}catch(ma){Ic(t,t.return,ma)}if(null!==(e=t.sibling)){e.return=t.return,$o=e;break}$o=t.return}m=nl,nl=!1}(e,n),yl(n,e),pr(ti),Wt=!!ei,ti=ei=null,e.current=n,_l(n,e,i),Ye(),Nl=l,_t=o,Al.transition=a}else e.current=n;if(Jl&&(Jl=!1,Ql=e,Yl=i),a=e.pendingLanes,0===a&&(Kl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ql)throw ql=!1,e=Gl,Gl=null,e;0!==(1&Yl)&&0!==e.tag&&Sc(),a=e.pendingLanes,0!==(1&a)?e===Zl?Xl++:(Xl=0,Zl=e):Xl=0,zi()}(e,t,n,r)}finally{Al.transition=i,_t=r}return null}function Sc(){if(null!==Ql){var e=bt(Yl),t=Al.transition,n=_t;try{if(Al.transition=null,_t=16>e?16:e,null===Ql)var r=!1;else{if(e=Ql,Ql=null,Yl=0,0!==(6&Nl))throw Error(s(331));var i=Nl;for(Nl|=4,$o=e.current;null!==$o;){var a=$o,o=a.child;if(0!==(16&$o.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for($o=u;null!==$o;){var d=$o;switch(d.tag){case 0:case 11:case 15:rl(8,d,a)}var h=d.child;if(null!==h)h.return=d,$o=h;else for(;null!==$o;){var f=(d=$o).sibling,p=d.return;if(al(d),d===u){$o=null;break}if(null!==f){f.return=p,$o=f;break}$o=p}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}$o=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,$o=o;else e:for(;null!==$o;){if(0!==(2048&(a=$o).flags))switch(a.tag){case 0:case 11:case 15:rl(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,$o=v;break e}$o=a.return}}var _=e.current;for($o=_;null!==$o;){var b=(o=$o).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,$o=b;else e:for(o=_;null!==$o;){if(0!==(2048&(l=$o).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(E){Ic(l,l.return,E)}if(l===o){$o=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,$o=w;break e}$o=l.return}}if(Nl=i,zi(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(E){}r=!0}return r}finally{_t=n,Al.transition=t}}return!1}function Tc(e,t,n){e=Us(e,t=mo(0,t=uo(n,t),1),1),t=tc(),null!==e&&(yt(e,1,t),ic(e,t))}function Ic(e,t,n){if(3===e.tag)Tc(e,e,n);else for(;null!==t;){if(3===t.tag){Tc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Kl||!Kl.has(r))){t=Us(t,e=go(t,e=uo(n,e),1),1),e=tc(),null!==t&&(yt(t,1,e),ic(t,e));break}}t=t.return}}function kc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,xl===e&&(Pl&n)===n&&(4===Ol||3===Ol&&(130023424&Pl)===Pl&&500>Xe()-zl?fc(e,0):Ul|=n),ic(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tc();null!==(e=Ls(e,t))&&(yt(e,t,n),ic(e,n))}function Ac(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function Nc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Cc(e,n)}function xc(e,t){return Ke(e,t)}function Rc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pc(e,t,n,r){return new Rc(e,t,n,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Lc(e,t){var n=e.alternate;return null===n?((n=Pc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,i,a){var o=2;if(r=e,"function"===typeof e)Dc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case S:return jc(n.children,i,a,t);case T:o=8,i|=8;break;case I:return(e=Pc(12,n,t,2|i)).elementType=I,e.lanes=a,e;case N:return(e=Pc(13,n,t,i)).elementType=N,e.lanes=a,e;case x:return(e=Pc(19,n,t,i)).elementType=x,e.lanes=a,e;case D:return Fc(n,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case k:o=10;break e;case C:o=9;break e;case A:o=11;break e;case R:o=14;break e;case P:o=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Pc(o,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function jc(e,t,n,r){return(e=Pc(7,e,r,t)).lanes=n,e}function Fc(e,t,n,r){return(e=Pc(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Mc(e,t,n){return(e=Pc(6,e,null,t)).lanes=n,e}function Uc(e,t,n){return(t=Pc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Vc(e,t,n,r,i,s,a,o,l){return e=new Bc(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Pc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},js(s),e}function zc(e){if(!e)return Ci;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Pi(n))return Oi(e,n,t)}return t}function Hc(e,t,n,r,i,s,a,o,l){return(e=Vc(n,r,!0,e,0,s,0,o,l)).context=zc(null),n=e.current,(s=Ms(r=tc(),i=nc(n))).callback=void 0!==t&&null!==t?t:null,Us(n,s,i),e.current.lanes=i,yt(e,i,r),ic(e,r),e}function Wc(e,t,n,r){var i=t.current,s=tc(),a=nc(i);return n=zc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ms(s,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Us(i,t,a))&&(rc(e,i,a,s),Bs(e,i,a)),a}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}Tl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ni.current)wo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return wo=!1,function(e,t,n){switch(t.tag){case 3:Ro(t),fs();break;case 5:Xs(t);break;case 1:Pi(t.type)&&ji(t);break;case 4:Qs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;ki(Es,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(ki($s,1&$s.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Mo(e,t,n):(ki($s,1&$s.current),null!==(e=qo(e,t,n))?e.sibling:null);ki($s,1&$s.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Ho(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),ki($s,$s.current),r)break;return null;case 22:case 23:return t.lanes=0,ko(e,t,n)}return qo(e,t,n)}(e,t,n);wo=0!==(131072&e.flags)}else wo=!1,is&&0!==(1048576&t.flags)&&$i(t,Gi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Wo(e,t),e=t.pendingProps;var i=Ri(t,Ai.current);Ns(t,n),i=ga(null,t,r,e,i,n);var a=ya();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pi(r)?(a=!0,ji(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,js(t),i.updater=so,t.stateNode=i,i._reactInternals=t,co(t,r,e,n),t=xo(null,t,r,!0,a,n)):(t.tag=0,is&&a&&es(t),Eo(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Wo(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===R)return 14}return 2}(r),e=ro(r,e),i){case 0:t=Ao(null,t,r,e,n);break e;case 1:t=No(null,t,r,e,n);break e;case 11:t=So(null,t,r,e,n);break e;case 14:t=To(null,t,r,ro(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ao(e,t,r,i=t.elementType===r?i:ro(r,i),n);case 1:return r=t.type,i=t.pendingProps,No(e,t,r,i=t.elementType===r?i:ro(r,i),n);case 3:e:{if(Ro(t),null===e)throw Error(s(387));r=t.pendingProps,i=(a=t.memoizedState).element,Fs(e,t),zs(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Po(e,t,r,n,i=uo(Error(s(423)),t));break e}if(r!==i){t=Po(e,t,r,n,i=uo(Error(s(424)),t));break e}for(rs=ci(t.stateNode.containerInfo.firstChild),ns=t,is=!0,ss=null,n=ws(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),r===i){t=qo(e,t,n);break e}Eo(e,t,r,n)}t=t.child}return t;case 5:return Xs(t),null===e&&cs(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,o=i.children,ni(r,i)?o=null:null!==a&&ni(r,a)&&(t.flags|=32),Co(e,t),Eo(e,t,o,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Mo(e,t,n);case 4:return Qs(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=bs(t,null,r,n):Eo(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,So(e,t,r,i=t.elementType===r?i:ro(r,i),n);case 7:return Eo(e,t,t.pendingProps,n),t.child;case 8:case 12:return Eo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,ki(Es,r._currentValue),r._currentValue=o,null!==a)if(or(a.value,o)){if(a.children===i.children&&!Ni.current){t=qo(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===a.tag){(c=Ms(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),As(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),As(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}Eo(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ns(t,n),r=r(i=xs(i)),t.flags|=1,Eo(e,t,r,n),t.child;case 14:return i=ro(r=t.type,t.pendingProps),To(e,t,r,i=ro(r.type,i),n);case 15:return Io(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ro(r,i),Wo(e,t),t.tag=1,Pi(r)?(e=!0,ji(t)):e=!1,Ns(t,n),oo(t,r,i),co(t,r,i,n),xo(null,t,r,!0,e,n);case 19:return Ho(e,t,n);case 22:return ko(e,t,n)}throw Error(s(156,t.tag))};var Jc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $c(){}function eu(e,t,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if("function"===typeof i){var o=i;i=function(){var e=qc(a);o.call(e)}}Wc(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=qc(a);s.call(e)}}var a=Hc(t,r,e,0,null,!1,0,"",$c);return e._reactRootContainer=a,e[pi]=a.current,zr(8===e.nodeType?e.parentNode:e),dc(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var o=r;r=function(){var e=qc(l);o.call(e)}}var l=Vc(e,0,!1,null,0,!1,0,"",$c);return e._reactRootContainer=l,e[pi]=l.current,zr(8===e.nodeType?e.parentNode:e),dc(function(){Wc(t,l,n,r)}),l}(n,t,e,i,r);return qc(a)}Yc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Wc(e,t,null,null)},Yc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){Wc(null,e,null,null)}),t[pi]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ft(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),ic(t,Xe()),0===(6&Nl)&&(Hl=Xe()+500,zi()))}break;case 13:dc(function(){var t=Ls(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}}),Kc(e,1)}},Et=function(e){if(13===e.tag){var t=Ls(e,134217728);if(null!==t)rc(t,e,134217728,tc());Kc(e,134217728)}},St=function(e){if(13===e.tag){var t=nc(e),n=Ls(e,t);if(null!==n)rc(n,e,t,tc());Kc(e,t)}},Tt=function(){return _t},It=function(e,t){var n=_t;try{return _t=e,t()}finally{_t=n}},Ee=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=wi(r);if(!i)throw Error(s(90));K(r),Z(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ae=uc,Ne=dc;var tu={usingClientEntryPoint:!1,Events:[_i,bi,wi,ke,Ce,uc]},nu={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ru={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{it=iu.inject(ru),st=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:E,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xc(e))throw Error(s(299));var n=!1,r="",i=Jc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Vc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,zr(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Zc(t))throw Error(s(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xc(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",o=Jc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Hc(t,null,e,1,null!=n?n:null,i,0,a,o),e[pi]=t.current,zr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Yc(t)},t.render=function(e,t,n){if(!Zc(t))throw Error(s(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zc(e))throw Error(s(40));return!!e._reactRootContainer&&(dc(function(){eu(null,null,e,!1,function(){e._reactRootContainer=null,e[pi]=null})}),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return eu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853(e,t,n){e.exports=n(234)},950(e,t,n){!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}();var r=n(43),i=n(391);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function a(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}function o(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function u(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const d={button:"Button_button__P93qT",primary:"Button_primary__oa-Wz",secondary:"Button_secondary__esv3s",ghost:"Button_ghost__bbBzJ",danger:"Button_danger__pnaON",fullWidth:"Button_fullWidth__Cvsqf"};var h=n(579);const f=["variant","children","className","type"];function p(e){let{variant:t="primary",children:n,className:r="",type:i="button"}=e,s=u(e,f);const a=[d.button,d[t],r].filter(Boolean).join(" ");return(0,h.jsx)("button",c(c({type:i,className:a},s),{},{children:n}))}const m={listAndDetailWrap:"TradeJournal_listAndDetailWrap__nicef",listOnly:"TradeJournal_listOnly__LtgnH",cardFullBleedTrade:"TradeJournal_cardFullBleedTrade__mWyWS",tradesArea:"TradeJournal_tradesArea__9iAK2",leftPane:"TradeJournal_leftPane__SCzI1",table:"TradeJournal_table__QI4KH",tableWrap:"TradeJournal_tableWrap__QVUr7",positionsList:"TradeJournal_positionsList__NKmge",ultraWide:"TradeJournal_ultraWide__p7Dts",ultraWideToggle:"TradeJournal_ultraWideToggle__UG6e4",ultraWideToggleActive:"TradeJournal_ultraWideToggleActive__gFFKA",rightPane:"TradeJournal_rightPane__prnjO",analysisActive:"TradeJournal_analysisActive__kUMku",left:"TradeJournal_left__dfuK1",right:"TradeJournal_right__yu0Lh",grid:"TradeJournal_grid__1fLcD",controls:"TradeJournal_controls__gZ+dm",filterPills:"TradeJournal_filterPills__RxNr1",actions:"TradeJournal_actions__5LIoY",title:"TradeJournal_title__wWNlK",symbolCell:"TradeJournal_symbolCell__fBN49",symbol:"TradeJournal_symbol__G-SjY",secondaryDetailsRow:"TradeJournal_secondaryDetailsRow__YFpmM",gridCompact:"TradeJournal_gridCompact__HFgeh",form:"TradeJournal_form__SypUK",row:"TradeJournal_row__0jLsi",positionsPlaceholder:"TradeJournal_positionsPlaceholder__+BIUD",headerRow:"TradeJournal_headerRow__p0NdB",tradesFilters:"TradeJournal_tradesFilters__fR7fV",mainRow:"TradeJournal_mainRow__n-nEc",mainRowExpanded:"TradeJournal_mainRowExpanded__H9qlB",chevCell:"TradeJournal_chevCell__aSjmr",chev:"TradeJournal_chev__Ut4Y7",externalBtn:"TradeJournal_externalBtn__0TUGI",sideLong:"TradeJournal_sideLong__GVeR8",sideShort:"TradeJournal_sideShort__Nk9vM",sideBadge:"TradeJournal_sideBadge__VmCP6",plPositive:"TradeJournal_plPositive__bsN-Z",plNegative:"TradeJournal_plNegative__Dyegj",secondaryRow:"TradeJournal_secondaryRow__ExXkf",secondaryInner:"TradeJournal_secondaryInner__00Sgc",secondaryLeft:"TradeJournal_secondaryLeft__KjgOW",secondaryRight:"TradeJournal_secondaryRight__0HgrK",marketHeader:"TradeJournal_marketHeader__FDtkY",statusOpen:"TradeJournal_statusOpen__hWucT",statusClosed:"TradeJournal_statusClosed__ws1iv",statusFilled:"TradeJournal_statusFilled__boWHL",filterPill:"TradeJournal_filterPill__pSZI0",secondaryNotesRow:"TradeJournal_secondaryNotesRow__2rHlS",positionItem:"TradeJournal_positionItem__ddg9i",positionExpandRow:"TradeJournal_positionExpandRow__VCrQI",small:"TradeJournal_small__8Bvfs",metaPiece:"TradeJournal_metaPiece__P7NDn",positionExpandGrid:"TradeJournal_positionExpandGrid__5VJsz",tpAdvancedGrid:"TradeJournal_tpAdvancedGrid__xwKZA",tpColLeft:"TradeJournal_tpColLeft__J87s2",tpColRight:"TradeJournal_tpColRight__PfZAM",input:"TradeJournal_input__PLM-0",tpInput:"TradeJournal_tpInput__fAoEm",slBeBtn:"TradeJournal_slBeBtn__Q-qNY",slHitBtn:"TradeJournal_slHitBtn__nmbu8",analysisBadgeBtn:"TradeJournal_analysisBadgeBtn__i24Qd",editor:"TradeJournal_editor__ziM65",fullScreen:"TradeJournal_fullScreen__LcJmb",tradesHeader:"TradeJournal_tradesHeader__PnlTR",tradesTitle:"TradeJournal_tradesTitle__ZJaPZ",tradesControls:"TradeJournal_tradesControls__OtRmi",marketFiltersWrap:"TradeJournal_marketFiltersWrap__xsPYK",analysisControls:"TradeJournal_analysisControls__PbtGj",analysisCreateBtn:"TradeJournal_analysisCreateBtn__f2O3g",tradesStatusRow:"TradeJournal_tradesStatusRow__cdJTK",button:"TradeJournal_button__i2oKM",tradesTabs:"TradeJournal_tradesTabs__DD6hT",tradesTab:"TradeJournal_tradesTab__wL2LG",tradesTabActive:"TradeJournal_tradesTabActive__YJL0F",tradesCount:"TradeJournal_tradesCount__5Q9lE",newTradeWrapper:"TradeJournal_newTradeWrapper__uyf1G",newTradeHeader:"TradeJournal_newTradeHeader__OQnKj",newTradeGrid:"TradeJournal_newTradeGrid__V-0dU",newTradeField:"TradeJournal_newTradeField__Pb+ix",full:"TradeJournal_full__H0bht",backdrop:"TradeJournal_backdrop__gLyTa",mockDialog:"TradeJournal_mockDialog__I3D5w",mockOption:"TradeJournal_mockOption__xInr0",compactSummary:"TradeJournal_compactSummary__PaY+K",compactControls:"TradeJournal_compactControls__zHpmy",compactPlaceholder:"TradeJournal_compactPlaceholder__dfwrn",advanced:"TradeJournal_advanced__Zunk2",advancedOpen:"TradeJournal_advancedOpen__4-OnL",advancedToggle:"TradeJournal_advancedToggle__Z-pAq",mobileNewTradeBtnWrap:"TradeJournal_mobileNewTradeBtnWrap__eiHNL",mobileNewTradeBtn:"TradeJournal_mobileNewTradeBtn__+H0wv",mobileModalBackdrop:"TradeJournal_mobileModalBackdrop__Cz7LG",mobileModalContent:"TradeJournal_mobileModalContent__o4wdV",sheetSlideUp:"TradeJournal_sheetSlideUp__9ReOn",mobileModalFooter:"TradeJournal_mobileModalFooter__JLb7m",tpRow:"TradeJournal_tpRow__VKe5Q",tpGridTwoCol:"TradeJournal_tpGridTwoCol__B4Sz1",tpLeftRow:"TradeJournal_tpLeftRow__w0Un-",tpRightCol:"TradeJournal_tpRightCol__KHT1X",tradesHeaderColumn:"TradeJournal_tradesHeaderColumn__BKCp-",spacer12:"TradeJournal_spacer12__-yeX0",compactSummaryInner:"TradeJournal_compactSummaryInner__VhK5W",strong:"TradeJournal_strong__WUwIP",mutedSmall:"TradeJournal_mutedSmall__0ofON",compactPlaceholderTitle:"TradeJournal_compactPlaceholderTitle__Wtjme",mutedText:"TradeJournal_mutedText__0zcp4"},g="ConfirmDialog_backdrop__XouNl",y="ConfirmDialog_dialog__Nc-tt",v="ConfirmDialog_title__h86gv",_="ConfirmDialog_message__2ZQ4W",b="ConfirmDialog_actions__yPdSz",w="ConfirmDialog_cancel__9hPQO",E="ConfirmDialog_confirm__dOxJ5",S="ConfirmDialog_confirmDanger__jaEdX";function T(e){let{open:t,title:n,message:r,confirmLabel:i="Confirm",cancelLabel:s="Cancel",onConfirm:a,onCancel:o,confirmVariant:l="primary"}=e;return t?(0,h.jsx)("div",{className:g,role:"dialog","aria-modal":"true",children:(0,h.jsxs)("div",{className:y,children:[n&&(0,h.jsx)("div",{className:v,children:n}),(0,h.jsx)("div",{className:_,children:r}),(0,h.jsxs)("div",{className:b,children:[(0,h.jsx)("button",{type:"button",className:w,onClick:o,children:s}),(0,h.jsx)("button",{type:"button",className:"danger"===l?S:E,onClick:a,children:i})]})]})}):null}const I={createBtn:"Analysis_createBtn__wOXw5",container:"Analysis_container__2XXNQ",title:"Analysis_title__ldw7N",headerBlock:"Analysis_headerBlock__4HeDc",headerRow:"Analysis_headerRow__TcupF",headerActions:"Analysis_headerActions__TpAni",headerText:"Analysis_headerText__rZ2Z2",headerLabelRow:"Analysis_headerLabelRow__-Iw25",countBadge:"Analysis_countBadge__aFUgc",headerMeta:"Analysis_headerMeta__rGoRw",filtersRow:"Analysis_filtersRow__nArL+",listOnlyLayout:"Analysis_listOnlyLayout__mVTl0",listCard:"Analysis_listCard__TLB+S",inlineDetail:"Analysis_inlineDetail__aUV8s",detailLoading:"Analysis_detailLoading__b1UHP",actionDropdownWrap:"Analysis_actionDropdownWrap__JsrtH",dropdownWrap:"Analysis_dropdownWrap__z9xt8",deleteBtn:"Analysis_deleteBtn__RSqcL",noSelection:"Analysis_noSelection__+q+QB",deleteWrap:"Analysis_deleteWrap__gJho9",deleteSpinner:"Analysis_deleteSpinner__6+Hzv",deleteStatus:"Analysis_deleteStatus__YzVf+"},k={card:"Card_card__61JvT",title:"Card_title__wvKdD",content:"Card_content__Jri4Q",tabBar:"Card_tabBar__jdijb",tab:"Card_tab__x2uYo",tabActive:"Card_tabActive__myAzN",cardCompact:"Card_cardCompact__NbOT9",cardFullBleed:"Card_cardFullBleed__UdjhY"};function C(e){var t,n;let{title:r,children:i,className:s="",tabs:a,activeTabKey:o,onTabChange:l,fullBleed:c=!1}=e;const u=Array.isArray(a)&&a.length>0,d=null!==o&&void 0!==o?o:u?a[0].key:void 0;return(0,h.jsxs)("div",{className:[k.card,c?k.cardFullBleed:"",s].filter(Boolean).join(" "),children:[r&&(0,h.jsx)("div",{className:k.title,children:r}),u&&(0,h.jsx)("div",{className:k.tabBar,role:"tablist",children:a.map(e=>(0,h.jsx)("button",{type:"button",role:"tab","aria-selected":e.key===d,className:[k.tab,e.key===d?k.tabActive:""].filter(Boolean).join(" "),onClick:()=>null===l||void 0===l?void 0:l(e.key),children:e.title},e.key))}),(0,h.jsx)("div",{className:k.content,children:u?null===(t=a.find(e=>e.key===d))||void 0===t||null===(n=t.render)||void 0===n?void 0:n.call(t):i})]})}const A={container:"AnalysisList_container__Qp-mR",empty:"AnalysisList_empty__8SCee",list:"AnalysisList_list__Z3gOx",item:"AnalysisList_item__P50RN",compact:"AnalysisList_compact__9Huts",selected:"AnalysisList_selected__UbFYz",header:"AnalysisList_header__byrC0",headerActions:"AnalysisList_headerActions__4rQRf",actionBtn:"AnalysisList_actionBtn__oLUEF",symbol:"AnalysisList_symbol__A34Ld",openButton:"AnalysisList_openButton__97WqY",meta:"AnalysisList_meta__OmCwV",notes:"AnalysisList_notes__cxomJ",expanded:"AnalysisList_expanded__r1Uon"};function N(e){let{items:t=[],compactView:n=!1,selectedId:r=null,onSelect:i,onOpen:s,renderActions:a,renderExpandedContent:o}=e;return t&&0!==t.length?(0,h.jsx)("div",{className:A.container,"data-testid":"analysis-list",children:(0,h.jsx)("div",{className:A.list,role:"list",children:t.map(e=>{const t=r===e.id;return(0,h.jsxs)("div",{"data-testid":"analysis-item-".concat(e.id),role:"listitem","aria-pressed":t,className:[A.item,n?A.compact:"",t?A.selected:""].filter(Boolean).join(" "),onClick:()=>{i&&i(e.id)},onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),i&&i(e.id))},tabIndex:0,children:[(0,h.jsxs)("div",{className:A.header,children:[(0,h.jsx)("strong",{className:A.symbol,role:"button",tabIndex:0,onClick:t=>{t.stopPropagation(),i&&i(e.id,"symbol")},onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),t.stopPropagation(),i&&i(e.id,"symbol"))},children:e.symbol}),a?(0,h.jsx)("div",{className:A.headerActions,children:a(e)}):s?(0,h.jsx)("div",{className:A.headerActions,children:(0,h.jsx)(p,{variant:"ghost",className:A.actionBtn,onClick:t=>{t.stopPropagation(),null===s||void 0===s||s(e.id),i&&i(e.id)},children:"Open"})}):null]}),(0,h.jsxs)("div",{className:A.meta,children:[(0,h.jsx)("span",{className:A.date,children:new Date(e.createdAt).toLocaleString()}),e.notes?(0,h.jsx)("p",{className:A.notes,children:e.notes}):null]}),t&&o?(0,h.jsx)("div",{className:A.expanded,children:o(e)}):null]},e.id)})})}):(0,h.jsx)("div",{className:A.container,"data-testid":"analysis-list",children:(0,h.jsx)("div",{className:A.empty,children:"Keine Analysen vorhanden"})})}const x="AnalysisDetail_container__2Nu53",R="AnalysisDetail_header__mdbKP",P="AnalysisDetail_symbol__45pYx",D="AnalysisDetail_notes__+XIeZ",L="AnalysisDetail_timeframes__ivtFA",O="AnalysisDetail_tf__vMaQn",j="AnalysisDetail_tfHeader__LRYzL",F="AnalysisDetail_link__YQjvH",M="AnalysisDetail_tvIcon__jQH9q",U="AnalysisDetail_tfNote__s7bKT",B="AnalysisDetail_metaBlock__hUOF+",V="AnalysisDetail_setupsBlock__XW3rI",z="AnalysisDetail_setupsList__3dVAX",H="AnalysisDetail_fibTag__00KBi",W="AnalysisDetail_compact__N8Qx0",q={setupsBlock:"AnalysisEditor_setupsBlock__u2LNu",setupsLabel:"AnalysisEditor_setupsLabel__ycovl",setupsTags:"AnalysisEditor_setupsTags__kF20U",form:"AnalysisEditor_form__Q2JWF",row:"AnalysisEditor_row__nhSBh",symbolField:"AnalysisEditor_symbolField__RzZSh",fieldErrorRight:"AnalysisEditor_fieldErrorRight__-O1Xm",label:"AnalysisEditor_label__z7fKB",input:"AnalysisEditor_input__TZyAd",timeframes:"AnalysisEditor_timeframes__zjG5f",tfTitle:"AnalysisEditor_tfTitle__7trK4",tfRow:"AnalysisEditor_tfRow__j3MnI",tfLabel:"AnalysisEditor_tfLabel__2Xx4T",tfInput:"AnalysisEditor_tfInput__0Jrul",actions:"AnalysisEditor_actions__F-UI1",button:"AnalysisEditor_button__X4qxw",fieldError:"AnalysisEditor_fieldError__WUwsP"},G={wrapper:"Input_wrapper__fMh0O",label:"Input_label__E9d5O",input:"Input_input__65TkF",inputError:"Input_inputError__rh4Dg",inputCompact:"Input_inputCompact__vzzNR"},K=["label","className","hasError","inputRef"];function J(e){let{label:t,className:n="",hasError:r=!1,inputRef:i}=e,s=u(e,K);const a=[G.input,r?G.inputError:"",n].filter(Boolean).join(" ");return(0,h.jsxs)("label",{className:G.wrapper,children:[t&&(0,h.jsx)("span",{className:G.label,children:t}),(0,h.jsx)("input",c({ref:i,className:a},s))]})}const Q={wrapper:"Textarea_wrapper__zgp24",label:"Textarea_label__zFzw3",textarea:"Textarea_textarea__2DCy1",textareaError:"Textarea_textareaError__CUnn4"},Y=["label","className","hasError","inputRef"];function X(e){let{label:t,className:n="",hasError:r=!1,inputRef:i}=e,s=u(e,Y);const a=[Q.textarea,r?Q.textareaError:"",n].filter(Boolean).join(" ");return(0,h.jsxs)("label",{className:Q.wrapper,children:[t&&(0,h.jsx)("span",{className:Q.label,children:t}),(0,h.jsx)("textarea",c({ref:i,className:a},s))]})}const Z=["monthly","weekly","daily","4h","2h","1h","15min"],$="MarketSelect_container__JWIGP",ee="MarketSelect_badge__A4NyQ",te="MarketSelect_active__ds7Gv",ne="MarketSelect_compact__RrSTE",re="MarketSelect_error__lt-rl";function ie(e){let{value:t,onChange:n,compact:r=!1,showAll:i=!0,label:s,hasError:a=!1,ariaDescribedBy:o}=e;const l=i?["All","Forex","Crypto"]:["Forex","Crypto"],c=(0,h.jsx)("div",{className:"".concat($," ").concat(a?re:""),role:"tablist","aria-label":"Market select","aria-describedby":o,children:l.map(e=>(0,h.jsx)("button",{role:"tab","aria-selected":t===e,className:"".concat(ee," ").concat(t===e?te:""," ").concat(r?ne:""),onClick:()=>n(e),children:e},e))});return s?(0,h.jsxs)("label",{className:G.wrapper,children:[(0,h.jsx)("span",{className:G.label,children:s}),c]}):c}const se=ie,ae="TimeframeWizard_wizard__cUG+z",oe="TimeframeWizard_pager__RG6H-",le="TimeframeWizard_pagerBtn__NKIU+",ce="TimeframeWizard_badge__lqc4z",ue="TimeframeWizard_headerActions__8W3ti",de="TimeframeWizard_formRow__orR-+",he="TimeframeWizard_title__fftTK",fe="TimeframeWizard_leftActions__3gOiI",pe="TimeframeWizard_rightActions__6weyy",me="AddFormCard_header__ZdQY1",ge="AddFormCard_title__VbP37",ye="AddFormCard_actions__g-AJt",ve="AddFormCard_content__mL6q0";const _e=function(e){let{title:t,children:n,actions:r,testId:i}=e;return(0,h.jsxs)(C,{"data-testid":i,children:[(0,h.jsxs)("div",{className:me,children:[(0,h.jsx)("div",{className:ge,children:t}),r?(0,h.jsx)("div",{className:ye,children:r}):null]}),(0,h.jsx)("div",{className:ve,children:n})]})};function be(e){var t,n;let{timeframes:i,onChangeTimeframe:s,onFinish:a}=e;const[o,l]=(0,r.useState)(0),c=i[o],u=e=>s(o,e),d=(0,h.jsxs)("div",{className:ue,children:[(0,h.jsxs)("div",{className:fe,children:[(0,h.jsx)(p,{type:"button",variant:"ghost",onClick:()=>l(e=>Math.max(e-1,0)),disabled:0===o,children:"Back"}),(0,h.jsx)(p,{type:"button",variant:"secondary",onClick:()=>{l(e=>Math.min(e+1,i.length-1))},children:"Skip"})]}),(0,h.jsx)("div",{className:pe,children:o<i.length-1?(0,h.jsx)(p,{type:"button",variant:"primary",onClick:()=>l(e=>Math.min(e+1,i.length-1)),children:"Next"}):(0,h.jsx)(p,{type:"button",variant:"primary",onClick:()=>a&&a(),children:"Finish"})})]});return(0,h.jsx)(_e,{title:"Timeframes",actions:d,testId:"timeframe-wizard-card",children:(0,h.jsxs)("div",{className:ae,"data-testid":"timeframe-wizard",children:[(0,h.jsx)("div",{className:oe,children:i.map((e,t)=>(0,h.jsxs)(p,{type:"button",variant:t===o?"primary":"ghost",className:le,onClick:()=>l(t),"aria-pressed":t===o,"aria-label":"Jump to ".concat(e.timeframe," timeframe"),children:[e.timeframe.toUpperCase(),(0,h.jsx)("span",{className:ce,"aria-hidden":!0,children:e.tradingViewLink||e.note?"\u25cf":"\u2013"})]},e.timeframe))}),(0,h.jsx)("div",{className:de,children:(0,h.jsx)("h4",{className:he,children:(c.timeframe||"").toUpperCase()})}),(0,h.jsx)("div",{className:de,children:(0,h.jsx)(J,{label:"TradingView Link",value:null!==(t=c.tradingViewLink)&&void 0!==t?t:"",onChange:e=>u({tradingViewLink:e.target.value}),placeholder:"https://www.tradingview.com/..."})}),(0,h.jsx)("div",{className:de,children:(0,h.jsx)(X,{label:"Note",value:null!==(n=c.note)&&void 0!==n?n:"",onChange:e=>u({note:e.target.value})})})]})})}function we(e){var t,n,i;let{initial:s={},onSave:a,focusField:o}=e;const[l,u]=(0,r.useState)(null!==(t=s.symbol)&&void 0!==t?t:""),[d,f]=(0,r.useState)(null!==(n=s.notes)&&void 0!==n?n:""),[m,g]=(0,r.useState)(()=>{var e;return null!==(e=s.market)&&void 0!==e?e:"Forex"}),[y,v]=(0,r.useState)(!0),[_]=(0,r.useState)(null!==(i=s.setups)&&void 0!==i?i:[]),[b,w]=(0,r.useState)(()=>{const e=Z.map(e=>({timeframe:e}));return s.timeframes?e.map(e=>{const t=s.timeframes[e.timeframe];return c(c({},e),{},{tradingViewLink:null===t||void 0===t?void 0:t.tradingViewLink,note:null===t||void 0===t?void 0:t.note})}):e}),[E,S]=(0,r.useState)(!1),[T,I]=(0,r.useState)({}),[k,C]=(0,r.useState)({}),[A,N]=(0,r.useState)(!1),x=r.useRef(null),R=r.useRef(null),P=r.useRef({}),D=r.useRef({});r.useEffect(()=>{o&&setTimeout(()=>{try{if("symbol"===o&&x.current&&x.current.focus(),"notes"===o&&R.current&&R.current.focus(),o.startsWith("tf:")){const e=o.split(":");if(3===e.length){const t=e[1],n=e[2];"note"===n&&D.current[t]&&D.current[t].focus(),"link"===n&&P.current[t]&&P.current[t].focus()}}}catch(e){}},50)},[o]);const L=(e,t)=>{w(n=>{const r=n.slice();return r[e]=c(c({},r[e]),t),r})};return(0,h.jsxs)("form",{className:q.form,onSubmit:async e=>{e.preventDefault();const t=function(e){const t={};return e.symbol&&""!==e.symbol.trim()||(t.symbol="Symbol ist erforderlich"),e.symbol&&e.symbol.length>20&&(t.symbol="Symbol zu lang"),t}({symbol:l,notes:d,market:m,setups:_});if(I(t),N(!0),!(Object.keys(t).length>0)&&a){S(!0);try{await a({symbol:l,notes:d,timeframes:b,market:m,setups:_})}finally{S(!1)}}},"data-testid":"analysis-editor",children:[(0,h.jsxs)("div",{className:q.row,children:[(0,h.jsxs)("div",{className:q.symbolField,children:[(0,h.jsx)(J,{label:"Symbol",value:l,onChange:e=>u(e.target.value),inputRef:x,"aria-label":"Symbol",onBlur:()=>C(e=>c(c({},e),{},{symbol:!0})),hasError:Boolean(T.symbol&&(k.symbol||A)),"aria-describedby":T.symbol&&(k.symbol||A)?"symbol-error":void 0}),T.symbol&&(k.symbol||A)&&(0,h.jsx)("div",{id:"symbol-error",className:q.fieldError,children:T.symbol})]}),(0,h.jsx)("div",{style:{marginLeft:12},children:(0,h.jsx)(ie,{label:"Market",value:m,onChange:e=>g(e),showAll:!1,compact:!0,hasError:Boolean(T.market&&(k.market||A)),ariaDescribedBy:T.market&&(k.market||A)?"market-error":void 0})}),T.market&&(k.market||A)&&(0,h.jsx)("div",{id:"market-error",className:q.fieldError,children:T.market})]}),(0,h.jsx)(X,{label:"Notes",value:d,onChange:e=>f(e.target.value),inputRef:R}),(0,h.jsx)("div",{className:q.setupsBlock,style:{margin:"18px 0 8px 0"},children:(0,h.jsx)("div",{className:q.setupsLabel,style:{marginBottom:6,fontWeight:500},children:"Setups"})}),(0,h.jsxs)("div",{className:q.timeframesHeader,style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,h.jsx)("h4",{className:q.tfTitle,children:"Timeframes"}),(0,h.jsx)("div",{children:(0,h.jsx)(p,{type:"button",variant:"ghost",onClick:()=>v(e=>!e),className:q.toggleWizardBtn,children:y?"Use list":"Use wizard"})})]}),y?(0,h.jsx)(be,{timeframes:b,onChangeTimeframe:L,onFinish:()=>v(!1)}):(0,h.jsx)("div",{className:q.timeframes,children:b.map((e,t)=>{var n,r;return(0,h.jsxs)("div",{className:q.tfRow,children:[(0,h.jsx)("div",{className:q.tfLabel,children:e.timeframe.toUpperCase()}),(0,h.jsx)(J,{className:q.tfInput,placeholder:"TradingView Link",value:null!==(n=e.tradingViewLink)&&void 0!==n?n:"",onChange:e=>L(t,{tradingViewLink:e.target.value}),inputRef:t=>{t?P.current[e.timeframe]=t:delete P.current[e.timeframe]}}),(0,h.jsx)(J,{className:q.tfInput,placeholder:"Note",value:null!==(r=e.note)&&void 0!==r?r:"",onChange:e=>L(t,{note:e.target.value}),inputRef:t=>{t?D.current[e.timeframe]=t:delete D.current[e.timeframe]}})]},e.timeframe)})}),(0,h.jsx)("div",{className:q.actions,children:(0,h.jsx)(p,{type:"submit",variant:"primary",className:q.button,disabled:E,children:E?"Saving...":"Save"})})]})}function Ee(e){var t,n;let{analysis:i,compactView:s=!1,onSave:a,startEditingField:o,showSymbolTitle:l=!0}=e;const[u,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{try{const e=localStorage.getItem("mt_trades_v1");if(e){const t=JSON.parse(e);d(Array.isArray(t)&&t.some(e=>e.analysisId===i.id&&e.symbol===i.symbol))}else d(!1)}catch(e){d(!1)}},[i.id,i.symbol]);const f=e=>{if(e){if("object"===typeof e&&e&&"value"in e&&"string"===typeof e.value){const t=e.value;return"Forex"===t||"Crypto"===t?t:void 0}return"Forex"===e||"Crypto"===e?e:void 0}},[m,g]=(0,r.useState)(!1),[y,v]=(0,r.useState)(void 0);return r.useEffect(()=>{o&&g(!0)},[o]),(0,h.jsxs)("div",{className:x,"data-testid":"analysis-detail",children:[(0,h.jsx)("div",{className:R,children:l?(0,h.jsx)("h2",{className:P,onClick:()=>{g(!0),v("symbol"),setTimeout(()=>v(void 0),200)},role:"button","aria-label":"Edit analysis ".concat(i.symbol),style:{cursor:"pointer"},children:i.symbol}):null}),m?(0,h.jsxs)("div",{style:{paddingTop:8},children:[(0,h.jsx)(we,{initial:{symbol:i.symbol,notes:i.notes,market:f(i.market),timeframes:Object.values(i.timeframes).reduce((e,t)=>c(c({},e),{},{[t.timeframe]:t}),{})},focusField:null!==o&&void 0!==o?o:y,onSave:async e=>{var t,n,r;const s=(e.timeframes||[]).reduce((e,t)=>c(c({},e),{},{[t.timeframe]:{timeframe:t.timeframe,tradingViewLink:t.tradingViewLink,note:t.note}}),{}),o=c(c({},i),{},{symbol:null!==(t=e.symbol)&&void 0!==t?t:i.symbol,notes:null!==(n=e.notes)&&void 0!==n?n:i.notes,timeframes:Object.keys(s).length?s:i.timeframes,updatedAt:(new Date).toISOString(),market:null!==(r=e.market)&&void 0!==r?r:f(i.market)});try{a&&await a(o)}catch(l){}g(!1)}}),(0,h.jsx)("div",{style:{marginTop:8},children:(0,h.jsx)(p,{variant:"ghost",onClick:()=>g(!1),style:{marginRight:8},children:"Cancel"})})]}):(0,h.jsxs)(h.Fragment,{children:[u&&(0,h.jsxs)(p,{type:"button",onClick:()=>{window.location.hash="#/journal",setTimeout(()=>{window.dispatchEvent(new Event("hashchange"))},10)},"aria-label":"Open trade for ".concat(i.symbol),children:["Open trade for ",i.symbol]}),(0,h.jsxs)("div",{className:B,children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Market:"})," ",null!==(t=f(i.market))&&void 0!==t?t:"-"]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Created:"})," ",i.createdAt?new Date(i.createdAt).toLocaleString():"-"]}),i.updatedAt&&(0,h.jsxs)("div",{children:[(0,h.jsx)("strong",{children:"Updated:"})," ",new Date(i.updatedAt).toLocaleString()]})]}),(0,h.jsxs)("div",{className:V,children:[(0,h.jsx)("div",{children:(0,h.jsx)("strong",{children:"Setups:"})}),(0,h.jsx)("ul",{className:z,children:(null!==(n=i.setups)&&void 0!==n?n:[]).map((e,t)=>(0,h.jsx)("li",{className:"fib-level"===e.key?H:void 0,children:"fib-level"===e.key?"Fib ".concat(e.value):e.key},t))})]}),(0,h.jsx)("div",{className:D,onClick:()=>{g(!0),v("notes"),setTimeout(()=>v(void 0),200)},role:"button","aria-label":"Edit notes",style:{cursor:"pointer"},children:i.notes}),(0,h.jsx)("div",{className:L,children:Object.values(i.timeframes).map(e=>(0,h.jsxs)("div",{className:"".concat(O," ").concat(s?W:""),children:[(0,h.jsxs)("div",{className:j,children:[(0,h.jsx)("strong",{children:e.timeframe.toUpperCase()}),e.tradingViewLink?(0,h.jsx)("a",{href:e.tradingViewLink,target:"_blank",rel:"noreferrer",className:F,"aria-label":"Open TradingView link",title:"Open in TradingView",children:(0,h.jsx)("svg",{className:M,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:(0,h.jsx)("path",{d:"M21 3H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h6v2H7v2h10v-2h-2v-2h6c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM21 17H3V5h18v12zM9 21h6v-2H9v2z",fill:"currentColor"})})}):null]}),e.note?(0,h.jsx)("p",{className:U,onClick:()=>{g(!0),v("tf:".concat(e.timeframe,":note")),setTimeout(()=>v(void 0),200)},role:"button","aria-label":"Edit ".concat(e.timeframe," note"),style:{cursor:"pointer"},children:e.note}):null]},e.timeframe))})]})]})}const Se=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Te={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,a=s?e[i+1]:0,o=i+2<e.length,l=o?e[i+2]:0,c=t>>2,u=(3&t)<<4|a>>4;let d=(15&a)<<2|l>>6,h=63&l;o||(h=64,s||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Se(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const a=i<e.length?n[e.charAt(i)]:64;++i;const o=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==a||null==o)throw new Ie;const l=t<<2|s>>4;if(r.push(l),64!==a){const e=s<<4&240|a>>2;if(r.push(e),64!==o){const e=a<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Ie extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ke=function(e){return function(e){const t=Se(e);return Te.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Ce=function(e){try{return Te.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function Ae(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const Ne=()=>{try{return Ae().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/traders-mirror",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_FIREBASE:"true",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"842512285290",REACT_APP_BUILD_TAG:"",REACT_APP_BUILD_SHA:"fe8e1f7d7be3d94ffab07172b15fcd8341eda200",REACT_APP_BUILD_TIME:"2026-01-24T21:29:52Z",REACT_APP_FIREBASE_STORAGE_BUCKET:"c3s-monkey-trader.appspot.com",REACT_APP_FIREBASE_AUTH_DOMAIN:"c3s-monkey-trader.firebaseapp.com",REACT_APP_BUILD_BRANCH:"main",REACT_APP_FIRESTORE_FORCE_LONG_POLLING:"true",REACT_APP_FIREBASE_PROJECT_ID:"c3s-monkey-trader",REACT_APP_FIREBASE_APP_ID:"1:842512285290:web:c87e2c00233deaa601413",REACT_APP_FIREBASE_API_KEY:"AIzaSyAgwG2YEqpz-kf7wPKqfNKihKcBnfskzbc"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&Ce(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},xe=e=>{var t;return null===(t=Ne())||void 0===t||null===(t=t.emulatorHosts)||void 0===t?void 0:t[e]},Re=()=>{var e;return null===(e=Ne())||void 0===e?void 0:e.config},Pe=e=>{var t;return null===(t=Ne())||void 0===t?void 0:t["_".concat(e)]};class De{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function Le(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}async function Oe(e){return(await fetch(e,{credentials:"include"})).ok}const je={};let Fe=!1;function Me(e,t){if("undefined"===typeof window||"undefined"===typeof document||!Le(window.location.host)||je[e]===t||je[e]||Fe)return;function n(e){return"__firebase__banner__".concat(e)}je[e]=t;const r="__firebase__banner",i=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(je))je[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{Fe=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function a(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),a=document.getElementById(t)||document.createElement("span"),o=n("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,o);const n=s();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,a,l,n),document.body.appendChild(t)}i?(a.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',a.innerText="Preview backend running in this workspace."),a.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a()}function Ue(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Be(){var e;const t=null===(e=Ne())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function Ve(){return!Be()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ze(){try{return"object"===typeof indexedDB}catch(e){return!1}}class He extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,He.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,We.prototype.create)}}class We{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(qe,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new He(n,s,t)}}const qe=/\{\$([^}]+)}/g;function Ge(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(Ke(n)&&Ke(s)){if(!Ge(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Ke(e){return null!==e&&"object"===typeof e}function Je(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Qe(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function Ye(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class Xe{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=Ze),void 0===r.error&&(r.error=Ze),void 0===r.complete&&(r.complete=Ze);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ze(){}function $e(e){return e&&e._delegate?e._delegate:e}class et{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const tt="[DEFAULT]";class nt{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new De;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:tt})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===tt?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt;return this.component?this.component.multipleInstances?e:tt:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class rt{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new nt(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const it=[];var st;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(st||(st={}));const at={debug:st.DEBUG,verbose:st.VERBOSE,info:st.INFO,warn:st.WARN,error:st.ERROR,silent:st.SILENT},ot=st.INFO,lt={[st.DEBUG]:"log",[st.VERBOSE]:"log",[st.INFO]:"info",[st.WARN]:"warn",[st.ERROR]:"error"},ct=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=lt[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];console[r]("[".concat(n,"]  ").concat(e.name,":"),...s)};class ut{constructor(e){this.name=e,this._logLevel=ot,this._logHandler=ct,this._userLogHandler=null,it.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in st))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?at[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,st.DEBUG,...t),this._logHandler(this,st.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,st.VERBOSE,...t),this._logHandler(this,st.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,st.INFO,...t),this._logHandler(this,st.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,st.WARN,...t),this._logHandler(this,st.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,st.ERROR,...t),this._logHandler(this,st.ERROR,...t)}}let dt,ht;const ft=new WeakMap,pt=new WeakMap,mt=new WeakMap,gt=new WeakMap,yt=new WeakMap;let vt={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return pt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||mt.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return wt(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function _t(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(ht||(ht=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Et(this),n),wt(ft.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return wt(e.apply(Et(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(Et(this),t,...r);return mt.set(s,t.sort?t.sort():[t]),wt(s)}}function bt(e){return"function"===typeof e?_t(e):(e instanceof IDBTransaction&&function(e){if(pt.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});pt.set(e,t)}(e),t=e,(dt||(dt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,vt):e);var t}function wt(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(wt(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&ft.set(t,e)}).catch(()=>{}),yt.set(t,e),t}(e);if(gt.has(e))return gt.get(e);const t=bt(e);return t!==e&&(gt.set(e,t),yt.set(t,e)),t}const Et=e=>yt.get(e);const St=["get","getKey","getAll","getAllKeys","count"],Tt=["put","add","delete","clear"],It=new Map;function kt(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(It.get(t))return It.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Tt.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!St.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return r&&(s=s.index(o.shift())),(await Promise.all([s[n](...o),i&&t.done]))[0]};return It.set(t,s),s}vt=(e=>c(c({},e),{},{get:(t,n,r)=>kt(t,n)||e.get(t,n,r),has:(t,n)=>!!kt(t,n)||e.has(t,n)}))(vt);class Ct{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const At="@firebase/app",Nt="0.14.6",xt=new ut("@firebase/app"),Rt="@firebase/app-compat",Pt="@firebase/analytics-compat",Dt="@firebase/analytics",Lt="@firebase/app-check-compat",Ot="@firebase/app-check",jt="@firebase/auth",Ft="@firebase/auth-compat",Mt="@firebase/database",Ut="@firebase/data-connect",Bt="@firebase/database-compat",Vt="@firebase/functions",zt="@firebase/functions-compat",Ht="@firebase/installations",Wt="@firebase/installations-compat",qt="@firebase/messaging",Gt="@firebase/messaging-compat",Kt="@firebase/performance",Jt="@firebase/performance-compat",Qt="@firebase/remote-config",Yt="@firebase/remote-config-compat",Xt="@firebase/storage",Zt="@firebase/storage-compat",$t="@firebase/firestore",en="@firebase/ai",tn="@firebase/firestore-compat",nn="firebase",rn="[DEFAULT]",sn={[At]:"fire-core",[Rt]:"fire-core-compat",[Dt]:"fire-analytics",[Pt]:"fire-analytics-compat",[Ot]:"fire-app-check",[Lt]:"fire-app-check-compat",[jt]:"fire-auth",[Ft]:"fire-auth-compat",[Mt]:"fire-rtdb",[Ut]:"fire-data-connect",[Bt]:"fire-rtdb-compat",[Vt]:"fire-fn",[zt]:"fire-fn-compat",[Ht]:"fire-iid",[Wt]:"fire-iid-compat",[qt]:"fire-fcm",[Gt]:"fire-fcm-compat",[Kt]:"fire-perf",[Jt]:"fire-perf-compat",[Qt]:"fire-rc",[Yt]:"fire-rc-compat",[Xt]:"fire-gcs",[Zt]:"fire-gcs-compat",[$t]:"fire-fst",[tn]:"fire-fst-compat",[en]:"fire-vertex","fire-js":"fire-js",[nn]:"fire-js-all"},an=new Map,on=new Map,ln=new Map;function cn(e,t){try{e.container.addComponent(t)}catch(n){xt.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function un(e){const t=e.name;if(ln.has(t))return xt.debug("There were multiple attempts to register component ".concat(t,".")),!1;ln.set(t,e);for(const n of an.values())cn(n,e);for(const n of on.values())cn(n,e);return!0}function dn(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function hn(e){return null!==e&&void 0!==e&&void 0!==e.settings}const fn=new We("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class pn{constructor(e,t,n){this._isDeleted=!1,this._options=c({},e),this._config=c({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new et("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw fn.create("app-deleted",{appName:this._name})}}const mn="12.6.0";function gn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=c({name:rn,automaticDataCollectionEnabled:!0},t),i=r.name;if("string"!==typeof i||!i)throw fn.create("bad-app-name",{appName:String(i)});if(n||(n=Re()),!n)throw fn.create("no-options");const s=an.get(i);if(s){if(Ge(n,s.options)&&Ge(r,s.config))return s;throw fn.create("duplicate-app",{appName:i})}const a=new rt(i);for(const l of ln.values())a.addComponent(l);const o=new pn(n,r,a);return an.set(i,o),o}function yn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rn;const t=an.get(e);if(!t&&e===rn&&Re())return gn();if(!t)throw fn.create("no-app",{appName:e});return t}function vn(e,t,n){var r;let i=null!==(r=sn[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return s&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),s&&a&&e.push("and"),a&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void xt.warn(e.join(" "))}un(new et("".concat(i,"-version"),()=>({library:i,version:t}),"VERSION"))}const _n="firebase-heartbeat-store";let bn=null;function wn(){return bn||(bn=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(e,t),o=wt(a);return r&&a.addEventListener("upgradeneeded",e=>{r(wt(a.result),e.oldVersion,e.newVersion,wt(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(_n)}catch(n){console.warn(n)}}}).catch(e=>{throw fn.create("idb-open",{originalErrorMessage:e.message})})),bn}async function En(e,t){try{const n=(await wn()).transaction(_n,"readwrite"),r=n.objectStore(_n);await r.put(t,Sn(e)),await n.done}catch(n){if(n instanceof He)xt.warn(n.message);else{const e=fn.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});xt.warn(e.message)}}}function Sn(e){return"".concat(e.name,"!").concat(e.options.appId)}class Tn{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new kn(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{var e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=In();var t;if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){xt.warn(n)}}async getHeartbeatsHeader(){try{var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=In(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),Cn(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Cn(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=ke(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return xt.warn(t),""}}}function In(){return(new Date).toISOString().substring(0,10)}class kn{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!ze()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await wn()).transaction(_n),n=await t.objectStore(_n).get(Sn(e));return await t.done,n}catch(t){if(t instanceof He)xt.warn(t.message);else{const e=fn.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});xt.warn(e.message)}}}(this.app);return null!==e&&void 0!==e&&e.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return En(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return En(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Cn(e){return ke(JSON.stringify({version:2,heartbeats:e})).length}var An;An="",un(new et("platform-logger",e=>new Ct(e),"PRIVATE")),un(new et("heartbeat",e=>new Tn(e),"PRIVATE")),vn(At,Nt,An),vn(At,Nt,"esm2020"),vn("fire-js","");vn("firebase","12.7.0","app");const Nn=["providerId"],xn=["uid","auth","stsTokenManager"],Rn=["providerId","signInMethod"];function Pn(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Dn=Pn,Ln=new We("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),On=new ut("@firebase/auth");function jn(e){if(On.logLevel<=st.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];On.error("Auth (".concat(mn,"): ").concat(e),...n)}}function Fn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw zn(e,...n)}function Mn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return zn(e,...n)}function Un(e,t,n){const r=c(c({},Dn()),{},{[t]:n});return new We("auth","Firebase",r).create(t,{appName:e.name})}function Bn(e){return Un(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Vn(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&Fn(e,"argument-error"),Un(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function zn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return Ln.create(e,...n)}function Hn(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw zn(t,...r)}}function Wn(e){const t="INTERNAL ASSERTION FAILED: "+e;throw jn(t),new Error(t)}function qn(e,t){e||Wn(t)}function Gn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Kn(){return"http:"===Jn()||"https:"===Jn()}function Jn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Qn(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Kn()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Yn{constructor(e,t){this.shortDelay=e,this.longDelay=t,qn(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ue())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return Qn()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Xn(e,t){qn(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class Zn{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Wn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Wn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Wn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const $n={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},er=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],tr=new Yn(3e4,6e4);function nr(e,t){return e.tenantId&&!t.tenantId?c(c({},t),{},{tenantId:e.tenantId}):t}async function rr(e,t,n,r){return ir(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const a=Je(c({key:e.config.apiKey},s)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l=c({method:t,headers:o},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&Le(e.emulatorConfig.host)&&(l.credentials="include"),Zn.fetch()(await ar(e,e.config.apiHost,n,a),l)})}async function ir(e,t,n){e._canInitEmulator=!1;const r=c(c({},$n),t);try{const t=new lr(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw cr(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw cr(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw cr(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw cr(e,"user-disabled",s);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw Un(e,o,a);Fn(e,o)}}catch(i){if(i instanceof He)throw i;Fn(e,"network-request-failed",{message:String(i)})}}async function sr(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await rr(e,t,n,r,i);return"mfaPendingCredential"in s&&Fn(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function ar(e,t,n,r){const i="".concat(t).concat(n,"?").concat(r),s=e,a=s.config.emulator?Xn(e.config,i):"".concat(e.config.apiScheme,"://").concat(i);if(er.includes(n)&&(await s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())){return s._getPersistence()._getFinalTarget(a).toString()}return a}function or(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class lr{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(Mn(this.auth,"network-request-failed")),tr.get())})}}function cr(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Mn(e,t,r);return i.customData._tokenResponse=n,i}function ur(e){return void 0!==e&&void 0!==e.enterprise}class dr{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return or(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function hr(e,t){return rr(e,"GET","/v2/recaptchaConfig",nr(e,t))}async function fr(e,t){return rr(e,"POST","/v1/accounts:lookup",t)}function pr(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function mr(e){return 1e3*Number(e)}function gr(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return jn("JWT malformed, contained fewer than 3 sections"),null;try{const e=Ce(n);return e?JSON.parse(e):(jn("Failed to decode base64 JWT payload"),null)}catch(i){return jn("Caught error parsing JWT payload as JSON",null===i||void 0===i?void 0:i.toString()),null}}function yr(e){const t=gr(e);return Hn(t,"internal-error"),Hn("undefined"!==typeof t.exp,"internal-error"),Hn("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function vr(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof He&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class _r{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{var t;this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class br{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=pr(this.lastLoginAt),this.creationTime=pr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function wr(e){var t;const n=e.auth,r=await e.getIdToken(),i=await vr(e,fr(n,{idToken:r}));Hn(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const a=null!==(t=s.providerUserInfo)&&void 0!==t&&t.length?Er(s.providerUserInfo):[],o=(l=e.providerData,c=a,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&s.passwordHash)&&!(null!==o&&void 0!==o&&o.length),h=!!u&&d,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new br(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function Er(e){return e.map(e=>{let{providerId:t}=e,n=u(e,Nn);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class Sr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Hn(e.idToken,"internal-error"),Hn("undefined"!==typeof e.idToken,"internal-error"),Hn("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):yr(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Hn(0!==e.length,"internal-error");const t=yr(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Hn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await ir(e,{},async()=>{const n=Je({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=await ar(e,r,"/v1/token","key=".concat(i)),a=await e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const o={method:"POST",headers:a,body:n};return e.emulatorConfig&&Le(e.emulatorConfig.host)&&(o.credentials="include"),Zn.fetch()(s,o)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Sr;return n&&(Hn("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Hn("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Hn("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Sr,this.toJSON())}_performRefresh(){return Wn("not implemented")}}function Tr(e,t){Hn("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Ir{constructor(e){let{uid:t,auth:n,stsTokenManager:r}=e,i=u(e,xn);this.providerId="firebase",this.proactiveRefresh=new _r(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new br(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await vr(this,this.stsTokenManager.getToken(this.auth,e));return Hn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=$e(e),r=await n.getIdToken(t),i=gr(r);Hn(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,a=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:pr(mr(i.auth_time)),issuedAtTime:pr(mr(i.iat)),expirationTime:pr(mr(i.exp)),signInProvider:a||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=$e(e);await wr(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Hn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>c({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ir(c(c({},this),{},{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Hn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await wr(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(hn(this.auth.app))return Promise.reject(Bn(this.auth));const e=await this.getIdToken();return await vr(this,async function(e,t){return rr(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return c(c({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>c({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{},{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,a,o,l,u;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,f=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,m=null!==(a=t.tenantId)&&void 0!==a?a:void 0,g=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,y=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:_,emailVerified:b,isAnonymous:w,providerData:E,stsTokenManager:S}=t;Hn(_&&S,e,"internal-error");const T=Sr.fromJSON(this.name,S);Hn("string"===typeof _,e,"internal-error"),Tr(d,e.name),Tr(h,e.name),Hn("boolean"===typeof b,e,"internal-error"),Hn("boolean"===typeof w,e,"internal-error"),Tr(f,e.name),Tr(p,e.name),Tr(m,e.name),Tr(g,e.name),Tr(y,e.name),Tr(v,e.name);const I=new Ir({uid:_,auth:e,email:h,emailVerified:b,displayName:d,isAnonymous:w,photoURL:p,phoneNumber:f,tenantId:m,stsTokenManager:T,createdAt:y,lastLoginAt:v});return E&&Array.isArray(E)&&(I.providerData=E.map(e=>c({},e))),g&&(I._redirectEventId=g),I}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new Sr;r.updateFromServerResponse(t);const i=new Ir({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await wr(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Hn(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?Er(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null!==i&&void 0!==i&&i.length),a=new Sr;a.updateFromIdToken(n);const o=new Ir({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new br(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null!==i&&void 0!==i&&i.length)};return Object.assign(o,l),o}}const kr=new Map;function Cr(e){qn(e instanceof Function,"Expected a class definition");let t=kr.get(e);return t?(qn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,kr.set(e,t),t)}class Ar{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ar.type="NONE";const Nr=Ar;function xr(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class Rr{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=xr(this.userKey,r.apiKey,i),this.fullPersistenceKey=xr("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await fr(this.auth,{idToken:e}).catch(()=>{});return t?Ir._fromGetAccountInfoResponse(this.auth,t,e):null}return Ir._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Rr(Cr(Nr),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||Cr(Nr);const s=xr(n,e.config.apiKey,e.name);let a=null;for(const c of t)try{const t=await c._get(s);if(t){let n;if("string"===typeof t){const r=await fr(e,{idToken:t}).catch(()=>{});if(!r)break;n=await Ir._fromGetAccountInfoResponse(e,r,t)}else n=Ir._fromJSON(e,t);c!==i&&(a=n),i=c;break}}catch(l){}const o=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&o.length?(i=o[0],a&&await i._set(s,a.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(t){}})),new Rr(i,e,n)):new Rr(i,e,n)}}function Pr(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(jr(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Dr(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Mr(t))return"Blackberry";if(Ur(t))return"Webos";if(Lr(t))return"Safari";if((t.includes("chrome/")||Or(t))&&!t.includes("edge/"))return"Chrome";if(Fr(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function Dr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue();return/firefox\//i.test(e)}function Lr(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Or(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue();return/crios\//i.test(e)}function jr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue();return/iemobile/i.test(e)}function Fr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue();return/android/i.test(e)}function Mr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue();return/blackberry/i.test(e)}function Ur(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue();return/webos/i.test(e)}function Br(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Vr(){return function(){const e=Ue();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function zr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue();return Br(e)||Fr(e)||Ur(e)||Mr(e)||/windows phone/i.test(e)||jr(e)}function Hr(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Pr(Ue());break;case"Worker":t="".concat(Pr(Ue()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(mn,"/").concat(r)}class Wr{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(i){r(i)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class qr{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(n=null===(r=e.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==n?n:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,a;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(i=o.containsUppercaseLetter)||void 0===i||i),o.isValid&&(o.isValid=null===(s=o.containsNumericCharacter)||void 0===s||s),o.isValid&&(o.isValid=null===(a=o.containsNonAlphanumericCharacter)||void 0===a||a),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Gr{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Jr(this),this.idTokenSubscription=new Jr(this),this.beforeStateQueue=new Wr(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ln,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Cr(t)),this._initializationPromise=this.queue(async()=>{var n,r,i;if(!this._deleted&&(this.persistenceManager=await Rr.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null!==(r=this._popupRedirectResolver)&&void 0!==r&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(s){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await fr(this,{idToken:e}),n=await Ir._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(hn(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){var i,s;await this.getOrInitRedirectPersistenceManager();const t=null===(i=this.redirectUser)||void 0===i?void 0:i._redirectEventId,a=null===(s=n)||void 0===s?void 0:s._redirectEventId,o=await this.tryRedirectSignIn(e);t&&t!==a||null===o||void 0===o||!o.user||(n=o.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Hn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await wr(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(hn(this.app))return Promise.reject(Bn(this));const t=e?$e(e):null;return t&&Hn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Hn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return hn(this.app)?Promise.reject(Bn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return hn(this.app)?Promise.reject(Bn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Cr(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return rr(e,"GET","/v2/passwordPolicy",nr(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new qr(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new We("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return rr(e,"POST","/v2/accounts:revokeToken",nr(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Cr(e)||this._popupRedirectResolver;Hn(t,this,"argument-error"),this.redirectPersistenceManager=await Rr.create(this,[Cr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Hn(a,this,"internal-error"),a.then(()=>{s||i(this.currentUser)}),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Hn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Hr(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(hn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return null!==t&&void 0!==t&&t.error&&function(e){if(On.logLevel<=st.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];On.warn("Auth (".concat(mn,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function Kr(e){return $e(e)}class Jr{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new Xe(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return Hn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Qr={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Yr(e){return Qr.loadJS(e)}function Xr(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class Zr{constructor(){this.enterprise=new $r}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class $r{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const ei="NO_RECAPTCHA";class ti{constructor(e){this.type="recaptcha-enterprise",this.auth=Kr(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;ur(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(ei)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Zr).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{hr(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new dr(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&ur(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Qr.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Yr(t).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function ni(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=new ti(e);let a;if(i)a=ei;else try{a=await s.verify(n)}catch(l){a=await s.verify(n,!0)}const o=c({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in o){const e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return r?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function ri(e,t,n,r,i){if("EMAIL_PASSWORD_PROVIDER"===i){var s;if(null!==(s=e._getRecaptchaConfig())&&void 0!==s&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await ni(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch(async i=>{if(i.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const i=await ni(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)})}if("PHONE_PROVIDER"===i){var a;if(null!==(a=e._getRecaptchaConfig())&&void 0!==a&&a.isProviderEnabled("PHONE_PROVIDER")){const i=await ni(e,t,n);return r(e,i).catch(async i=>{var s;if("AUDIT"===(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.getProviderEnforcementState("PHONE_PROVIDER"))&&(i.code==="auth/".concat("missing-recaptcha-token")||i.code==="auth/".concat("invalid-app-credential"))){console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(n," flow."));const i=await ni(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)})}{const i=await ni(e,t,n,!1,!0);return r(e,i)}}return Promise.reject(i+" provider is not supported.")}async function ii(e){const t=Kr(e),n=await hr(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new dr(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new ti(t).verify()}}function si(e,t,n){const r=Kr(e);Hn(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!(null===n||void 0===n||!n.disableWarnings),s=ai(t),{host:a,port:o}=function(e){const t=ai(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:oi(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:oi(t)}}}(t),l=null===o?"":":".concat(o),c={url:"".concat(s,"//").concat(a).concat(l,"/")},u=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return Hn(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void Hn(Ge(c,r.config.emulator)&&Ge(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,Le(a)?(Oe("".concat(s,"//").concat(a).concat(l)),Me("Auth",!0)):i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function ai(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function oi(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class li{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Wn("not implemented")}_getIdTokenResponse(e){return Wn("not implemented")}_linkToIdToken(e,t){return Wn("not implemented")}_getReauthenticationResolver(e){return Wn("not implemented")}}async function ci(e,t){return rr(e,"POST","/v1/accounts:signUp",t)}async function ui(e,t){return sr(e,"POST","/v1/accounts:signInWithPassword",nr(e,t))}class di extends li{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new di(e,t,"password")}static _fromEmailAndCode(e,t){return new di(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if(null!==t&&void 0!==t&&t.email&&null!==t&&void 0!==t&&t.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return ri(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",ui,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return sr(e,"POST","/v1/accounts:signInWithEmailLink",nr(e,t))}(e,{email:this._email,oobCode:this._password});default:Fn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return ri(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ci,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return sr(e,"POST","/v1/accounts:signInWithEmailLink",nr(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Fn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function hi(e,t){return sr(e,"POST","/v1/accounts:signInWithIdp",nr(e,t))}class fi extends li{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new fi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Fn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=u(t,Rn);if(!n||!r)return null;const s=new fi(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return hi(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,hi(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,hi(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Je(t)}return e}}async function pi(e,t){return rr(e,"POST","/v1/accounts:sendVerificationCode",nr(e,t))}const mi={USER_NOT_FOUND:"user-not-found"};class gi extends li{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new gi({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new gi({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return sr(e,"POST","/v1/accounts:signInWithPhoneNumber",nr(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await sr(e,"POST","/v1/accounts:signInWithPhoneNumber",nr(e,t));if(n.temporaryProof)throw cr(e,"account-exists-with-different-credential",n);return n}(e,c({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return sr(e,"POST","/v1/accounts:signInWithPhoneNumber",nr(e,c(c({},t),{},{operation:"REAUTH"})),mi)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new gi({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class yi{constructor(e){var t,n,r,i,s,a;const o=Qe(Ye(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,c=null!==(n=o.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=o.mode)&&void 0!==r?r:null);Hn(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=o.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=o.lang)&&void 0!==s?s:null,this.tenantId=null!==(a=o.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=Qe(Ye(e)).link,n=t?Qe(Ye(t)).deep_link_id:null,r=Qe(Ye(e)).deep_link_id;return(r?Qe(Ye(r)).link:null)||r||n||t||e}(e);try{return new yi(t)}catch(n){return null}}}class vi{constructor(){this.providerId=vi.PROVIDER_ID}static credential(e,t){return di._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=yi.parseLink(t);return Hn(n,"argument-error"),di._fromEmailAndCode(e,n.code,n.tenantId)}}vi.PROVIDER_ID="password",vi.EMAIL_PASSWORD_SIGN_IN_METHOD="password",vi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class _i{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class bi extends _i{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class wi extends bi{constructor(){super("facebook.com")}static credential(e){return fi._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return wi.credential(t.oauthAccessToken)}catch(n){return null}}}wi.FACEBOOK_SIGN_IN_METHOD="facebook.com",wi.PROVIDER_ID="facebook.com";class Ei extends bi{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return fi._fromParams({providerId:Ei.PROVIDER_ID,signInMethod:Ei.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ei.credentialFromTaggedObject(e)}static credentialFromError(e){return Ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return Ei.credential(n,r)}catch(i){return null}}}Ei.GOOGLE_SIGN_IN_METHOD="google.com",Ei.PROVIDER_ID="google.com";class Si extends bi{constructor(){super("github.com")}static credential(e){return fi._fromParams({providerId:Si.PROVIDER_ID,signInMethod:Si.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Si.credentialFromTaggedObject(e)}static credentialFromError(e){return Si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Si.credential(t.oauthAccessToken)}catch(n){return null}}}Si.GITHUB_SIGN_IN_METHOD="github.com",Si.PROVIDER_ID="github.com";class Ti extends bi{constructor(){super("twitter.com")}static credential(e,t){return fi._fromParams({providerId:Ti.PROVIDER_ID,signInMethod:Ti.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ti.credentialFromTaggedObject(e)}static credentialFromError(e){return Ti.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return Ti.credential(n,r)}catch(i){return null}}}Ti.TWITTER_SIGN_IN_METHOD="twitter.com",Ti.PROVIDER_ID="twitter.com";class Ii{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await Ir._fromIdTokenResponse(e,n,r),s=ki(n);return new Ii({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=ki(n);return new Ii({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function ki(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Ci extends He{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Ci.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Ci(e,t,n,r)}}function Ai(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw Ci._fromErrorAndOperation(e,n,t,r);throw n})}async function Ni(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await vr(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Ii._forOperation(e,"link",r)}async function xi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(hn(r.app))return Promise.reject(Bn(r));const i="reauthenticate";try{const s=await vr(e,Ai(r,i,t,e),n);Hn(s.idToken,r,"internal-error");const a=gr(s.idToken);Hn(a,r,"internal-error");const{sub:o}=a;return Hn(e.uid===o,r,"user-mismatch"),Ii._forOperation(e,i,s)}catch(s){throw(null===s||void 0===s?void 0:s.code)==="auth/".concat("user-not-found")&&Fn(r,"user-mismatch"),s}}async function Ri(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(hn(e.app))return Promise.reject(Bn(e));const r="signIn",i=await Ai(e,r,t),s=await Ii._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}function Pi(e,t){return $e(e).setPersistence(t)}function Di(e,t){return rr(e,"POST","/v2/accounts/mfaEnrollment:start",nr(e,t))}new WeakMap;const Li="__sak";class Oi{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Li,"1"),this.storage.removeItem(Li),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class ji extends Oi{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=zr(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);Vr()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ji.type="LOCAL";const Fi=ji;function Mi(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),i=RegExp("".concat(r,"=([^;]+)"));return null!==(t=null===(n=document.cookie.match(i))||void 0===n?void 0:n[1])&&void 0!==t?t:null}function Ui(e){const t="http:"===window.location.protocol;return"".concat(t?"__dev_":"__HOST-","FIREBASE_").concat(e.split(":")[3])}class Bi{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL("".concat(window.location.origin,"/__cookies__"));return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=Ui(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return Mi(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=Ui(e);document.cookie="".concat(t,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=Ui(e);if(window.cookieStore){const e=e=>{const r=e.changed.find(e=>e.name===n);r&&t(r.value);e.deleted.find(e=>e.name===n)&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=Mi(n);const i=setInterval(()=>{const e=Mi(n);e!==r&&(t(e),r=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(i))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}Bi.type="COOKIE";class Vi extends Oi{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Vi.type="SESSION";const zi=Vi;class Hi{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Hi(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(null===s||void 0===s||!s.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const a=Array.from(s).map(async e=>e(t.origin,i)),o=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Wi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Hi.receivers=[];class qi{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((a,o)=>{const l=Wi("",20);r.port1.start();const c=setTimeout(()=>{o(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(t.data.response);break;default:clearTimeout(c),clearTimeout(i),o(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Gi(){return window}function Ki(){return"undefined"!==typeof Gi().WorkerGlobalScope&&"function"===typeof Gi().importScripts}const Ji="firebaseLocalStorageDb",Qi="firebaseLocalStorage",Yi="fbase_key";class Xi{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Zi(e,t){return e.transaction([Qi],t?"readwrite":"readonly").objectStore(Qi)}function $i(){const e=indexedDB.open(Ji,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Qi,{keyPath:Yi})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Qi)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Ji);return new Xi(e).toPromise()}(),t(await $i()))})})}async function es(e,t,n){const r=Zi(e,!0).put({[Yi]:t,value:n});return new Xi(r).toPromise()}function ts(e,t){const n=Zi(e,!0).delete(t);return new Xi(n).toPromise()}class ns{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await $i()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ki()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hi._getInstance(Ki()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){var e;if(null===(e=navigator)||void 0===e||!e.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new qi(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&null!==(e=n[0])&&void 0!==e&&e.fulfilled&&null!==(t=n[0])&&void 0!==t&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=navigator)||void 0===e||null===(e=e.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await $i();return await es(e,Li,"1"),await ts(e,Li),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>es(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Zi(e,!1).get(t),r=await new Xi(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ts(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Zi(e,!1).getAll();return new Xi(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}ns.type="LOCAL";const rs=ns;function is(e,t){return rr(e,"POST","/v2/accounts/mfaSignIn:start",nr(e,t))}Xr("rcb"),new Yn(3e4,6e4);const ss="recaptcha";async function as(e,t,n){if(!e._getRecaptchaConfig())try{await ii(e)}catch(i){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(i="string"===typeof t?{phoneNumber:t}:t,"session"in i){const t=i.session;if("phoneNumber"in i){Hn("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=ri(e,r,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===ei){Hn((null===n||void 0===n?void 0:n.type)===ss,e,"argument-error");return Di(e,await os(e,t,n))}return Di(e,t)},"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{var r;Hn("signin"===t.type,e,"internal-error");const s=(null===(r=i.multiFactorHint)||void 0===r?void 0:r.uid)||i.multiFactorUid;Hn(s,e,"missing-multi-factor-info");const a={mfaPendingCredential:t.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},o=ri(e,a,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===ei){Hn((null===n||void 0===n?void 0:n.type)===ss,e,"argument-error");return is(e,await os(e,t,n))}return is(e,t)},"PHONE_PROVIDER");return(await o.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=ri(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===ei){Hn((null===n||void 0===n?void 0:n.type)===ss,e,"argument-error");return pi(e,await os(e,t,n))}return pi(e,t)},"PHONE_PROVIDER");return(await r.catch(e=>Promise.reject(e))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function os(e,t,n){Hn(n.type===ss,e,"argument-error");const r=await n.verify();Hn("string"===typeof r,e,"argument-error");const i=c({},t);if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,s=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:s}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class ls{constructor(e){this.providerId=ls.PROVIDER_ID,this.auth=Kr(e)}verifyPhoneNumber(e,t){return as(this.auth,e,$e(t))}static credential(e,t){return gi._fromVerification(e,t)}static credentialFromResult(e){const t=e;return ls.credentialFromTaggedObject(t)}static credentialFromError(e){return ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?gi._fromTokenResponse(n,r):null}}function cs(e,t){return t?Cr(t):(Hn(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}ls.PROVIDER_ID="phone",ls.PHONE_SIGN_IN_METHOD="phone";class us extends li{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return hi(e,this._buildIdpRequest())}_linkToIdToken(e,t){return hi(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return hi(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ds(e){return Ri(e.auth,new us(e),e.bypassAuthState)}function hs(e){const{auth:t,user:n}=e;return Hn(n,t,"internal-error"),xi(n,new us(e),e.bypassAuthState)}async function fs(e){const{auth:t,user:n}=e;return Hn(n,t,"internal-error"),Ni(n,new us(e),e.bypassAuthState)}class ps{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:a}=e;if(s)return void this.reject(s);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ds;case"linkViaPopup":case"linkViaRedirect":return fs;case"reauthViaPopup":case"reauthViaRedirect":return hs;default:Fn(this.auth,"internal-error")}}resolve(e){qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ms=new Yn(2e3,1e4);class gs extends ps{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,gs.currentPopupAction&&gs.currentPopupAction.cancel(),gs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Hn(e,this.auth,"internal-error"),e}async onExecution(){qn(1===this.filter.length,"Popup operations only handle one event");const e=Wi();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Mn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Mn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,gs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t;null!==(t=this.authWindow)&&void 0!==t&&null!==(t=t.window)&&void 0!==t&&t.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Mn(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,ms.get())};e()}}gs.currentPopupAction=null;const ys=new Map;class vs extends ps{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=ys.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=ws(t),r=bs(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}ys.set(this.auth._key(),e)}return this.bypassAuthState||ys.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function _s(e,t){ys.set(e._key(),t)}function bs(e){return Cr(e._redirectPersistence)}function ws(e){return xr("pendingRedirect",e.config.apiKey,e.name)}async function Es(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(hn(e.app))return Promise.reject(Bn(e));const r=Kr(e),i=cs(r,t),s=new vs(r,i,n),a=await s.execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,t)),a}class Ss{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Is(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Is(e)){var n;const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Mn(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ts(e))}saveEventToCache(e){this.cachedEventUids.add(Ts(e)),this.lastProcessedEventTime=Date.now()}}function Ts(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Is(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const ks=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Cs=/^https?/;async function As(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return rr(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(Ns(r))return}catch(n){}Fn(e,"unauthorized-domain")}function Ns(e){const t=Gn(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Cs.test(n))return!1;if(ks.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const xs=new Yn(3e4,6e4);function Rs(){const e=Gi().___jsl;if(null!==e&&void 0!==e&&e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Ps(e){return new Promise((t,n)=>{var r,i;function s(){Rs(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Rs(),n(Mn(e,"network-request-failed"))},timeout:xs.get()})}if(null!==(r=Gi().gapi)&&void 0!==r&&null!==(r=r.iframes)&&void 0!==r&&r.Iframe)t(gapi.iframes.getContext());else{if(null===(i=Gi().gapi)||void 0===i||!i.load){const t=Xr("iframefcb");return Gi()[t]=()=>{gapi.load?s():n(Mn(e,"network-request-failed"))},Yr("".concat(Qr.gapiScript,"?onload=").concat(t)).catch(e=>n(e))}s()}}).catch(e=>{throw Ds=null,e})}let Ds=null;const Ls=new Yn(5e3,15e3),Os={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},js=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Fs(e){const t=e.config;Hn(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Xn(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:mn},i=js.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),"".concat(n,"?").concat(Je(r).slice(1))}async function Ms(e){const t=await function(e){return Ds=Ds||Ps(e),Ds}(e),n=Gi().gapi;return Hn(n,e,"internal-error"),t.open({where:document.body,url:Fs(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Os,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=Mn(e,"network-request-failed"),s=Gi().setTimeout(()=>{r(i)},Ls.get());function a(){Gi().clearTimeout(s),n(t)}t.ping(a).then(a,()=>{r(i)})}))}const Us={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Bs{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Vs(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l=c(c({},Us),{},{width:r.toString(),height:i.toString(),top:s,left:a}),u=Ue().toLowerCase();n&&(o=Or(u)?"_blank":n),Dr(u)&&(t=t||"http://localhost",l.scrollbars="yes");const d=Object.entries(l).reduce((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")},"");if(function(){var e;return Br(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue())&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(u)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",o),new Bs(null);const h=window.open(t||"",o,d);Hn(h,e,"popup-blocked");try{h.focus()}catch(f){}return new Bs(h)}const zs="__/auth/handler",Hs="emulator/auth/handler",Ws=encodeURIComponent("fac");async function qs(e,t,n,r,i,s){Hn(e.config.authDomain,e,"auth-domain-config-required"),Hn(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:mn,eventId:i};if(t instanceof _i){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))a[e]=t}if(t instanceof bi){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(a.scopes=e.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const l=await e._getAppCheckToken(),c=l?"#".concat(Ws,"=").concat(encodeURIComponent(l)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(zs);return Xn(t,Hs)}(e),"?").concat(Je(o).slice(1)).concat(c)}const Gs="webStorageSupport";const Ks=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zi,this._completeRedirectFn=Es,this._overrideRedirectResult=_s}async _openPopup(e,t,n,r){var i;qn(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Vs(e,await qs(e,t,n,Gn(),r),Wi())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Gi().location.href=e}(await qs(e,t,n,Gn(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(qn(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await Ms(e),n=new Ss(e);return t.register("authEvent",t=>{Hn(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Gs,{type:Gs},n=>{var r;const i=null===n||void 0===n||null===(r=n[0])||void 0===r?void 0:r[Gs];void 0!==i&&t(!!i),Fn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=As(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return zr()||Lr()||Br()}};var Js="@firebase/auth",Qs="1.12.0";class Ys{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Hn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Xs=Pe("authIdTokenMaxAge")||300;let Zs=null;function $s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yn();const t=dn(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=dn(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Ge(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;Fn(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Ks,persistence:[rs,Fi,zi]}),r=Pe("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Xs)return;const r=null===t||void 0===t?void 0:t.token;Zs!==r&&(Zs=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(e,t,n){$e(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){$e(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var i;const s=xe("auth");return s&&si(n,"http://".concat(s)),n}var ea;Qr={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Mn("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},ea="Browser",un(new et("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Hn(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:ea,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Hr(ea)},c=new Gr(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Cr);null!==t&&void 0!==t&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),un(new et("auth-internal",e=>(e=>new Ys(e))(Kr(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),vn(Js,Qs,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(ea)),vn(Js,Qs,"esm2020");var ta,na,ra="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},ia={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(e,t,n){n||(n=0);const r=Array(16);if("string"===typeof t)for(var i=0;i<16;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;i<16;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];let s,a=e.g[3];s=t+(a^n&(i^a))+r[0]+3614090360&4294967295,s=a+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[1]+3905402710&4294967295,a=t+(s<<12&4294967295|s>>>20),s=i+(n^a&(t^n))+r[2]+606105819&4294967295,s=n+(t^(i=a+(s<<17&4294967295|s>>>15))&(a^t))+r[3]+3250441966&4294967295,s=t+(a^(n=i+(s<<22&4294967295|s>>>10))&(i^a))+r[4]+4118548399&4294967295,s=a+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[5]+1200080426&4294967295,a=t+(s<<12&4294967295|s>>>20),s=i+(n^a&(t^n))+r[6]+2821735955&4294967295,s=n+(t^(i=a+(s<<17&4294967295|s>>>15))&(a^t))+r[7]+4249261313&4294967295,s=t+(a^(n=i+(s<<22&4294967295|s>>>10))&(i^a))+r[8]+1770035416&4294967295,s=a+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[9]+2336552879&4294967295,a=t+(s<<12&4294967295|s>>>20),s=i+(n^a&(t^n))+r[10]+4294925233&4294967295,s=n+(t^(i=a+(s<<17&4294967295|s>>>15))&(a^t))+r[11]+2304563134&4294967295,s=t+(a^(n=i+(s<<22&4294967295|s>>>10))&(i^a))+r[12]+1804603682&4294967295,s=a+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[13]+4254626195&4294967295,a=t+(s<<12&4294967295|s>>>20),s=i+(n^a&(t^n))+r[14]+2792965006&4294967295,s=n+(t^(i=a+(s<<17&4294967295|s>>>15))&(a^t))+r[15]+1236535329&4294967295,s=t+(i^a&((n=i+(s<<22&4294967295|s>>>10))^i))+r[1]+4129170786&4294967295,s=a+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[6]+3225465664&4294967295,a=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(a^t))+r[11]+643717713&4294967295,s=n+(a^t&((i=a+(s<<14&4294967295|s>>>18))^a))+r[0]+3921069994&4294967295,s=t+(i^a&((n=i+(s<<20&4294967295|s>>>12))^i))+r[5]+3593408605&4294967295,s=a+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[10]+38016083&4294967295,a=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(a^t))+r[15]+3634488961&4294967295,s=n+(a^t&((i=a+(s<<14&4294967295|s>>>18))^a))+r[4]+3889429448&4294967295,s=t+(i^a&((n=i+(s<<20&4294967295|s>>>12))^i))+r[9]+568446438&4294967295,s=a+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[14]+3275163606&4294967295,a=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(a^t))+r[3]+4107603335&4294967295,s=n+(a^t&((i=a+(s<<14&4294967295|s>>>18))^a))+r[8]+1163531501&4294967295,s=t+(i^a&((n=i+(s<<20&4294967295|s>>>12))^i))+r[13]+2850285829&4294967295,s=a+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[2]+4243563512&4294967295,a=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(a^t))+r[7]+1735328473&4294967295,s=n+(a^t&((i=a+(s<<14&4294967295|s>>>18))^a))+r[12]+2368359562&4294967295,s=t+((n=i+(s<<20&4294967295|s>>>12))^i^a)+r[5]+4294588738&4294967295,s=a+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[8]+2272392833&4294967295,a=t+(s<<11&4294967295|s>>>21),s=i+(a^t^n)+r[11]+1839030562&4294967295,s=n+((i=a+(s<<16&4294967295|s>>>16))^a^t)+r[14]+4259657740&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^a)+r[1]+2763975236&4294967295,s=a+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[4]+1272893353&4294967295,a=t+(s<<11&4294967295|s>>>21),s=i+(a^t^n)+r[7]+4139469664&4294967295,s=n+((i=a+(s<<16&4294967295|s>>>16))^a^t)+r[10]+3200236656&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^a)+r[13]+681279174&4294967295,s=a+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[0]+3936430074&4294967295,a=t+(s<<11&4294967295|s>>>21),s=i+(a^t^n)+r[3]+3572445317&4294967295,s=n+((i=a+(s<<16&4294967295|s>>>16))^a^t)+r[6]+76029189&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^a)+r[9]+3654602809&4294967295,s=a+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[12]+3873151461&4294967295,a=t+(s<<11&4294967295|s>>>21),s=i+(a^t^n)+r[15]+530742520&4294967295,s=n+((i=a+(s<<16&4294967295|s>>>16))^a^t)+r[2]+3299628645&4294967295,s=t+(i^((n=i+(s<<23&4294967295|s>>>9))|~a))+r[0]+4096336452&4294967295,s=a+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[7]+1126891415&4294967295,a=t+(s<<10&4294967295|s>>>22),s=i+(t^(a|~n))+r[14]+2878612391&4294967295,s=n+(a^((i=a+(s<<15&4294967295|s>>>17))|~t))+r[5]+4237533241&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~a))+r[12]+1700485571&4294967295,s=a+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[3]+2399980690&4294967295,a=t+(s<<10&4294967295|s>>>22),s=i+(t^(a|~n))+r[10]+4293915773&4294967295,s=n+(a^((i=a+(s<<15&4294967295|s>>>17))|~t))+r[1]+2240044497&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~a))+r[8]+1873313359&4294967295,s=a+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[15]+4264355552&4294967295,a=t+(s<<10&4294967295|s>>>22),s=i+(t^(a|~n))+r[6]+2734768916&4294967295,s=n+(a^((i=a+(s<<15&4294967295|s>>>17))|~t))+r[13]+1309151649&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~a))+r[4]+4149444226&4294967295,s=a+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[11]+3174756917&4294967295,a=t+(s<<10&4294967295|s>>>22),s=i+(t^(a|~n))+r[2]+718787259&4294967295,s=n+(a^((i=a+(s<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+a&4294967295}function r(e,t){this.h=t;const n=[];let r=!0;for(let i=e.length-1;i>=0;i--){const s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.v=function(e,t){void 0===t&&(t=e.length);const r=t-this.blockSize,i=this.C;let s=this.h,a=0;for(;a<t;){if(0==s)for(;a<=r;)n(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(i[s++]=e.charCodeAt(a++),s==this.blockSize){n(this,i),s=0;break}}else for(;a<t;)if(i[s++]=e[a++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var n=e.length-8;n<e.length;++n)e[n]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};var i={};function s(e){return-128<=e&&e<128?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],e<0?-1:0)}):new r([0|e],e<0?-1:0)}function a(e){if(isNaN(e)||!isFinite(e))return o;if(e<0)return h(a(-e));const t=[];let n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new r(t,0)}var o=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){const t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new r(n,~e.h).add(l)}function f(e,t){return e.add(h(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(o,o);if(d(e))return t=g(h(e),t),new m(h(t.g),h(t.h));if(d(t))return t=g(e,h(t)),new m(h(t.g),t.h);if(e.g.length>30){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;r.l(e)<=0;)n=y(n),r=y(r);var i=v(n,1),s=v(r,1);for(r=v(r,2),n=v(n,2);!u(r);){var c=s.add(r);c.l(e)<=0&&(i=i.add(n),s=c),r=v(r,1),n=v(n,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=o;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=(r=Math.ceil(Math.log(n)/Math.LN2))<=48?1:Math.pow(2,r-48),c=(s=a(n)).j(t);d(c)||c.l(e)>0;)c=(s=a(n-=r)).j(t);u(s)&&(s=l),i=i.add(s),e=f(e,c)}return new m(i,e)}function y(e){const t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new r(n,e.h)}function v(e,t){const n=t>>5;t%=32;const i=e.g.length-n,s=[];for(let r=0;r<i;r++)s[r]=t>0?e.i(r+n)>>>t|e.i(r+n+1)<<32-t:e.i(r+n);return new r(s,e.h)}(e=r.prototype).m=function(){if(d(this))return-h(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){const r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(d(this))return"-"+h(this).toString(e);const t=a(Math.pow(e,6));var n=this;let r="";for(;;){const i=g(n,t).g;let s=(((n=f(n,i.j(t))).g.length>0?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return s+r;for(;s.length<6;)s="0"+s;r=s+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){const t=Math.max(this.g.length,e.g.length),n=[];let i=0;for(let r=0;r<=t;r++){let t=i+(65535&this.i(r))+(65535&e.i(r)),s=(t>>>16)+(this.i(r)>>>16)+(e.i(r)>>>16);i=s>>>16,t&=65535,s&=65535,n[r]=s<<16|t}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(this.l(c)<0&&e.l(c)<0)return a(this.m()*e.m());const t=this.g.length+e.g.length,n=[];for(var i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(let t=0;t<e.g.length;t++){const r=this.i(i)>>>16,s=65535&this.i(i),a=e.i(t)>>>16,o=65535&e.i(t);n[2*i+2*t]+=s*o,p(n,2*i+2*t),n[2*i+2*t+1]+=r*o,p(n,2*i+2*t+1),n[2*i+2*t+1]+=s*a,p(n,2*i+2*t+1),n[2*i+2*t+2]+=r*a,p(n,2*i+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new r(n,0)},e.B=function(e){return g(this,e).h},e.and=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new r(n,this.h&e.h)},e.or=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new r(n,this.h|e.h)},e.xor=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.A,t.prototype.reset=t.prototype.u,t.prototype.update=t.prototype.v,na=ia.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.B,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=a,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if((n=n||10)<2||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');const r=a(Math.pow(n,8));let i=o;for(let o=0;o<t.length;o+=8){var s=Math.min(8,t.length-o);const e=parseInt(t.substring(o,o+s),n);s<8?(s=a(Math.pow(n,s)),i=i.j(s).add(a(e))):(i=i.j(r),i=i.add(a(e)))}return i},ta=ia.Integer=r}).apply("undefined"!==typeof ra?ra:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var sa,aa,oa,la,ca,ua,da,ha,fa="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},pa={};(function(){var e,t=Object.defineProperty;var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof fa&&fa];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function r(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var a=e[s];if(!(a in i))break e;i=i[a]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}r("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push([t,e[t]]);return n}});var i=i||{},s=this||self;function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){return(l=o).apply(null,arguments)}function c(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}var d="undefined"!==typeof AsyncContext&&"function"===typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function h(e){const t=e.length;if(t>0){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];var n=typeof t;if("array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length){n=e.length||0;const r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){s.setTimeout(()=>{throw e},0)}function m(){var e=b;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var g=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new y,e=>e.reset());class y{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let v,_=!1,b=new class{constructor(){this.h=this.g=null}add(e,t){const n=g.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},w=()=>{const e=Promise.resolve(void 0);v=()=>{e.then(E)}};function E(){for(var e;e=m();){try{e.h.call(e.g)}catch(n){p(n)}var t=g;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}_=!1}function S(){this.u=this.u,this.C=this.C}function T(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}S.prototype.u=!1,S.prototype.dispose=function(){this.u||(this.u=!0,this.N())},S.prototype[Symbol.dispose]=function(){this.dispose()},S.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},T.prototype.h=function(){this.defaultPrevented=!0};var I=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};s.addEventListener("test",e,t),s.removeEventListener("test",e,t)}catch(n){}return e}();function k(e){return/^[\s\xa0]*$/.test(e)}function C(e,t){T.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}u(C,T),C.prototype.init=function(e,t){const n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&C.Z.h.call(this)},C.prototype.h=function(){C.Z.h.call(this);const e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var A="closure_listenable_"+(1e6*Math.random()|0),N=0;function x(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++N,this.da=this.fa=!1}function R(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function P(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function D(e){const t={};for(const n in e)t[n]=e[n];return t}const L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<L.length;t++)n=L[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function j(e){this.src=e,this.g={},this.h=0}function F(e,t){const n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=s>=0)&&Array.prototype.splice.call(i,s,1),r&&(R(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function M(e,t,n,r){for(let i=0;i<e.length;++i){const s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}j.prototype.add=function(e,t,n,r,i){const s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);const a=M(e,t,r,i);return a>-1?(t=e[a],n||(t.fa=!1)):((t=new x(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var U="closure_lm_"+(1e6*Math.random()|0),B={};function V(e,t,n,r,i){if(r&&r.once)return H(e,t,n,r,i);if(Array.isArray(t)){for(let s=0;s<t.length;s++)V(e,t[s],n,r,i);return null}return n=Y(n),e&&e[A]?e.J(t,n,a(r)?!!r.capture:!!r,i):z(e,t,n,!1,r,i)}function z(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");const o=a(i)?!!i.capture:!!i;let l=J(e);if(l||(e[U]=l=new j(e)),(n=l.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=K;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)I||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(G(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function H(e,t,n,r,i){if(Array.isArray(t)){for(let s=0;s<t.length;s++)H(e,t[s],n,r,i);return null}return n=Y(n),e&&e[A]?e.K(t,n,a(r)?!!r.capture:!!r,i):z(e,t,n,!0,r,i)}function W(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)W(e,t[s],n,r,i);else r=a(r)?!!r.capture:!!r,n=Y(n),e&&e[A]?(e=e.i,(s=String(t).toString())in e.g&&((n=M(t=e.g[s],n,r,i))>-1&&(R(t[n]),Array.prototype.splice.call(t,n,1),0==t.length&&(delete e.g[s],e.h--)))):e&&(e=J(e))&&(t=e.g[t.toString()],e=-1,t&&(e=M(t,n,r,i)),(n=e>-1?t[e]:null)&&q(n))}function q(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[A])F(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(G(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=J(t))?(F(n,e),0==n.h&&(n.src=null,t[U]=null)):R(e)}}}function G(e){return e in B?B[e]:B[e]="on"+e}function K(e,t){if(e.da)e=!0;else{t=new C(t,this);const n=e.listener,r=e.ha||e.src;e.fa&&q(e),e=n.call(r,t)}return e}function J(e){return(e=e[U])instanceof j?e:null}var Q="__closure_events_fn_"+(1e9*Math.random()>>>0);function Y(e){return"function"===typeof e?e:(e[Q]||(e[Q]=function(t){return e.handleEvent(t)}),e[Q])}function X(){S.call(this),this.i=new j(this),this.M=this,this.G=null}function Z(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new T(t,e);else if(t instanceof T)t.target=t.target||e;else{var i=t;O(t=new T(r,e),i)}let s,a;if(i=!0,n)for(a=n.length-1;a>=0;a--)s=t.g=n[a],i=$(s,r,!0,t)&&i;if(s=t.g=e,i=$(s,r,!0,t)&&i,i=$(s,r,!1,t)&&i,n)for(a=0;a<n.length;a++)s=t.g=n[a],i=$(s,r,!1,t)&&i}function $(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let i=!0;for(let s=0;s<t.length;++s){const a=t[s];if(a&&!a.da&&a.capture==n){const t=a.listener,n=a.ha||a.src;a.fa&&F(e.i,a),i=!1!==t.call(n,r)&&i}}return i&&!r.defaultPrevented}function ee(e){e.g=function(e,t){if("function"!==typeof e){if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=l(e.handleEvent,e)}return Number(t)>2147483647?-1:s.setTimeout(e,t||0)}(()=>{e.g=null,e.i&&(e.i=!1,ee(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}u(X,S),X.prototype[A]=!0,X.prototype.removeEventListener=function(e,t,n,r){W(this,e,t,n,r)},X.prototype.N=function(){if(X.Z.N.call(this),this.i){var e=this.i;for(const t in e.g){const n=e.g[t];for(let e=0;e<n.length;e++)R(n[e]);delete e.g[t],e.h--}}this.G=null},X.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},X.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class te extends S{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ee(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ne(e){S.call(this),this.h=e,this.g={}}u(ne,S);var re=[];function ie(e){P(e.g,function(e,t){this.g.hasOwnProperty(t)&&q(e)},e),e.g={}}ne.prototype.N=function(){ne.Z.N.call(this),ie(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var se=s.JSON.stringify,ae=s.JSON.parse,oe=class{stringify(e){return s.JSON.stringify(e,void 0)}parse(e){return s.JSON.parse(e,void 0)}};function le(){}function ce(){}var ue={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function de(){T.call(this,"d")}function he(){T.call(this,"c")}u(de,T),u(he,T);var fe={},pe=null;function me(){return pe=pe||new X}function ge(e){T.call(this,fe.Ia,e)}function ye(e){const t=me();Z(t,new ge(t))}function ve(e,t){T.call(this,fe.STAT_EVENT,e),this.stat=t}function _e(e){const t=me();Z(t,new ve(t,e))}function be(e,t){T.call(this,fe.Ja,e),this.size=t}function we(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){e()},t)}function Ee(){this.g=!0}function Se(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{const s=JSON.parse(t);if(s)for(e=0;e<s.length;e++)if(Array.isArray(s[e])){var n=s[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var i=r[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(let e=1;e<r.length;e++)r[e]=""}}}return se(s)}catch(s){return t}}(e,n)+(r?" "+r:"")})}fe.Ia="serverreachability",u(ge,T),fe.STAT_EVENT="statevent",u(ve,T),fe.Ja="timingevent",u(be,T),Ee.prototype.ua=function(){this.g=!1},Ee.prototype.info=function(){};var Te,Ie={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ke={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function Ce(){}function Ae(e){return encodeURIComponent(String(e))}function Ne(e){var t=1;e=e.split(":");const n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function xe(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new ne(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Re}function Re(){this.i=null,this.g="",this.h=!1}u(Ce,le),Ce.prototype.g=function(){return new XMLHttpRequest},Te=new Ce;var Pe={},De={};function Le(e,t,n){e.M=1,e.A=st(et(t)),e.u=n,e.R=!0,Oe(e,null)}function Oe(e,t){e.F=Date.now(),Me(e),e.B=et(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),_t(n.i,"t",r),e.C=0,n=e.j.L,e.h=new Re,e.g=an(e.j,n?t:null,!e.u),e.P>0&&(e.O=new te(l(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var i="readystatechange";Array.isArray(i)||(i&&(re[0]=i.toString()),i=re);for(let s=0;s<i.length;s++){const e=V(n,i[s],r||t.handleEvent,!1,t.h||t);if(!e)break;t.g[e.key]=e}t=e.J?D(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),ye(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s){var a="",o=s.split("&");for(let e=0;e<o.length;e++){var l=o[e].split("=");if(l.length>1){const e=l[0];l=l[1];const t=e.split("_");a=t.length>=2&&"type"==t[1]?a+(e+"=")+l+"&":a+(e+"=redacted&")}}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+a})}(e.i,e.v,e.B,e.l,e.S,e.u)}function je(e){return!!e.g&&("GET"==e.v&&2!=e.M&&e.j.Aa)}function Fe(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?De:(n=Number(t.substring(n,r)),isNaN(n)?Pe:(r+=1)+n>t.length?De:(t=t.slice(r,r+n),e.C=r+n,t))}function Me(e){e.T=Date.now()+e.H,Ue(e,e.H)}function Ue(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=we(l(e.aa,e),t)}function Be(e){e.D&&(s.clearTimeout(e.D),e.D=null)}function Ve(e){0==e.j.I||e.K||en(e.j,e)}function ze(e){Be(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,ie(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function He(e,t){try{var n=e.j;if(0!=n.I&&(n.g==e||Je(n.h,e)))if(!e.L&&Je(n.h,e)&&3==n.I){try{var r=n.Ba.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.v){if(n.g){if(!(n.g.F+3e3<e.F))break e;$t(n),Ht(n)}Yt(n),_e(18)}}else n.xa=i[1],0<n.xa-n.K&&i[2]<37500&&n.F&&0==n.A&&!n.C&&(n.C=we(l(n.Va,n),6e3));Ke(n.h)<=1&&n.ta&&(n.ta=void 0)}else nn(n,11)}else if((e.L||n.g==e)&&$t(n),!k(t))for(i=n.Ba.g.parse(t),t=0;t<i.length;t++){let l=i[t];const u=l[0];if(!(u<=n.K))if(n.K=u,l=l[1],2==n.I)if("c"==l[0]){n.M=l[1],n.ba=l[2];const t=l[3];null!=t&&(n.ka=t,n.j.info("VER="+n.ka));const i=l[4];null!=i&&(n.za=i,n.j.info("SVER="+n.za));const u=l[5];null!=u&&"number"===typeof u&&u>0&&(r=1.5*u,n.O=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Qe(s,s.h),s.h=null))}if(r.G){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.wa=e,it(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info("Handshake RTT: "+n.T+"ms"));var a=e;if((r=n).na=sn(r,r.L?r.ba:null,r.W),a.L){Ye(r.h,a);var o=a,c=r.O;c&&(o.H=c),o.D&&(Be(o),Me(o)),r.g=a}else Qt(r);n.i.length>0&&qt(n)}else"stop"!=l[0]&&"close"!=l[0]||nn(n,7);else 3==n.I&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?nn(n,7):zt(n):"noop"!=l[0]&&n.l&&n.l.qa(l),n.A=0)}ye()}catch(u){}}xe.prototype.ba=function(e){e=e.target;const t=this.O;t&&3==Mt(e)?t.j():this.Y(e)},xe.prototype.Y=function(e){try{if(e==this.g)e:{const l=Mt(this.g),c=this.g.ya();this.g.ca();if(!(l<3)&&(3!=l||this.g&&(this.h.h||this.g.la()||Ut(this.g)))){this.K||4!=l||7==c||ye(),Be(this);var t=this.g.ca();this.X=t;var n=function(e){if(!je(e))return e.g.la();const t=Ut(e.g);if(""===t)return"";let n="";const r=t.length,i=4==Mt(e.g);if(!e.h.i){if("undefined"===typeof TextDecoder)return ze(e),Ve(e),"";e.h.i=new s.TextDecoder}for(let s=0;s<r;s++)e.h.h=!0,n+=e.h.i.decode(t[s],{stream:!(i&&s==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}(this);if(this.o=200==t,function(e,t,n,r,i,s,a){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+a})}(this.i,this.v,this.B,this.l,this.S,l,t),this.o){if(this.U&&!this.L){t:{if(this.g){var r,i=this.g;if((r=i.g?i.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(r)){var a=r;break t}}a=null}if(!(e=a)){this.o=!1,this.m=3,_e(12),ze(this),Ve(this);break e}Se(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,He(this,e)}if(this.R){let t;for(e=!0;!this.K&&this.C<n.length;){if(t=Fe(this,n),t==De){4==l&&(this.m=4,_e(14),e=!1),Se(this.i,this.l,null,"[Incomplete Response]");break}if(t==Pe){this.m=4,_e(15),Se(this.i,this.l,n,"[Invalid Chunk]"),e=!1;break}Se(this.i,this.l,t,null),He(this,t)}if(je(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=l||0!=n.length||this.h.h||(this.m=1,_e(16),e=!1),this.o=this.o&&e,e){if(n.length>0&&!this.W){this.W=!0;var o=this.j;o.g==this&&o.aa&&!o.P&&(o.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xt(o),o.P=!0,_e(11))}}else Se(this.i,this.l,n,"[Invalid Chunked Response]"),ze(this),Ve(this)}else Se(this.i,this.l,n,null),He(this,n);4==l&&ze(this),this.o&&!this.K&&(4==l?en(this.j,this):(this.o=!1,Me(this)))}else(function(e){const t={};e=(e.g&&Mt(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(k(e[r]))continue;var n=Ne(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==t&&n.indexOf("Unknown SID")>0?(this.m=3,_e(12)):(this.m=0,_e(13)),ze(this),Ve(this)}}}catch(Ja){}},xe.prototype.cancel=function(){this.K=!0,ze(this)},xe.prototype.aa=function(){this.D=null;const e=Date.now();e-this.T>=0?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.B),2!=this.M&&(ye(),_e(17)),ze(this),this.m=2,Ve(this)):Ue(this,this.T-e)};var We=class{constructor(e,t){this.g=e,this.map=t}};function qe(e){this.l=e||10,s.PerformanceNavigationTiming?e=(e=s.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ge(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ke(e){return e.h?1:e.g?e.g.size:0}function Je(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Qe(e,t){e.g?e.g.add(t):e.h=t}function Ye(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Xe(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.G);return t}return h(e.i)}qe.prototype.cancel=function(){if(this.i=Xe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Ze=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function $e(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof $e?(this.l=e.l,tt(this,e.j),this.o=e.o,this.g=e.g,nt(this,e.u),this.h=e.h,rt(this,bt(e.i)),this.m=e.m):e&&(t=String(e).match(Ze))?(this.l=!1,tt(this,t[1]||"",!0),this.o=at(t[2]||""),this.g=at(t[3]||"",!0),nt(this,t[4]),this.h=at(t[5]||"",!0),rt(this,t[6]||"",!0),this.m=at(t[7]||"")):(this.l=!1,this.i=new pt(null,this.l))}function et(e){return new $e(e)}function tt(e,t,n){e.j=n?at(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function nt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function rt(e,t,n){t instanceof pt?(e.i=t,function(e,t){t&&!e.j&&(mt(e),e.i=null,e.g.forEach(function(e,t){const n=t.toLowerCase();t!=n&&(gt(this,t),_t(this,n,e))},e)),e.j=t}(e.i,e.l)):(n||(t=ot(t,ht)),e.i=new pt(t,e.l))}function it(e,t,n){e.i.set(t,n)}function st(e){return it(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function at(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ot(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,lt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function lt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}$e.prototype.toString=function(){const e=[];var t=this.j;t&&e.push(ot(t,ct,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ot(t,ct,!0),"@"),e.push(Ae(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.u)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ot(n,"/"==n.charAt(0)?dt:ut,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ot(n,ft)),e.join("")},$e.prototype.resolve=function(e){const t=et(this);let n=!!e.j;n?tt(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=null!=e.u;var r=e.h;if(n)nt(t,e.u);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=t.h.lastIndexOf("/");-1!=i&&(r=t.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");const e=[];for(let t=0;t<i.length;){const n=i[t++];"."==n?r&&t==i.length&&e.push(""):".."==n?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),r&&t==i.length&&e.push("")):(e.push(n),r=!0)}r=e.join("/")}else r=i}return n?t.h=r:n=""!==e.i.toString(),n?rt(t,bt(e.i)):n=!!e.m,n&&(t.m=e.m),t};var ct=/[#\/\?@]/g,ut=/[#\?:]/g,dt=/[#\?]/g,ht=/[#\?@]/g,ft=/#/g;function pt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function mt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let n=0;n<e.length;n++){const r=e[n].indexOf("=");let i,s=null;r>=0?(i=e[n].substring(0,r),s=e[n].substring(r+1)):i=e[n],t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function gt(e,t){mt(e),t=wt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function yt(e,t){return mt(e),t=wt(e,t),e.g.has(t)}function vt(e,t){mt(e);let n=[];if("string"===typeof t)yt(e,t)&&(n=n.concat(e.g.get(wt(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}function _t(e,t,n){gt(e,t),n.length>0&&(e.i=null,e.g.set(wt(e,t),h(n)),e.h+=n.length)}function bt(e){const t=new pt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function wt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Et(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function St(){this.g=new oe}function Tt(e){this.i=e.Sb||null,this.h=e.ab||!1}function It(e,t){X.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function kt(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function Ct(e){e.readyState=4,e.l=null,e.j=null,e.B=null,At(e)}function At(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Nt(e){let t="";return P(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function xt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Nt(n),"string"===typeof e?null!=n&&Ae(n):it(e,t,n))}function Rt(e){X.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(e=pt.prototype).add=function(e,t){mt(this),this.i=null,e=wt(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){mt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.set=function(e,t){return mt(this),this.i=null,yt(this,e=wt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&(e=vt(this,e)).length>0?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];const i=Ae(n);n=vt(this,n);for(let t=0;t<n.length;t++){let r=i;""!==n[t]&&(r+="="+Ae(n[t])),e.push(r)}}return this.i=e.join("&")},u(Tt,le),Tt.prototype.g=function(){return new It(this.i,this.h)},u(It,X),(e=It.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,At(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||s).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,Ct(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,At(this)),this.g&&(this.readyState=3,At(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if("undefined"!==typeof s.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;kt(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ct(this):At(this),3==this.readyState&&kt(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,Ct(this))},e.Na=function(e){this.g&&(this.response=e,Ct(this))},e.ga=function(){this.g&&Ct(this)},e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(It.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),u(Rt,X);var Pt=/^https?$/i,Dt=["POST","PUT"];function Lt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,Ot(e),Ft(e)}function Ot(e){e.A||(e.A=!0,Z(e,"complete"),Z(e,"error"))}function jt(e){if(e.h&&"undefined"!=typeof i)if(e.v&&4==Mt(e))setTimeout(e.Ca.bind(e),0);else if(Z(e,"readystatechange"),4==Mt(e)){e.h=!1;try{const i=e.ca();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===i){let t=String(e.D).match(Ze)[1]||null;!t&&s.self&&s.self.location&&(t=s.self.location.protocol.slice(0,-1)),r=!Pt.test(t?t.toLowerCase():"")}n=r}if(n)Z(e,"complete"),Z(e,"success");else{e.o=6;try{var a=Mt(e)>2?e.g.statusText:""}catch(o){a=""}e.l=a+" ["+e.ca()+"]",Ot(e)}}finally{Ft(e)}}}function Ft(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);const r=e.g;e.g=null,t||Z(e,"ready");try{r.onreadystatechange=null}catch(n){}}}function Mt(e){return e.g?e.g.readyState:0}function Ut(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Bt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Vt(e){this.za=0,this.i=[],this.j=new Ee,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Bt("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Bt("baseRetryDelayMs",5e3,e),this.Za=Bt("retryDelaySeedMs",1e4,e),this.Ta=Bt("forwardChannelMaxRetries",2,e),this.va=Bt("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new qe(e&&e.concurrentRequestLimit),this.Ba=new St,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function zt(e){if(Wt(e),3==e.I){var t=e.V++,n=et(e.J);if(it(n,"SID",e.M),it(n,"RID",t),it(n,"TYPE","terminate"),Kt(e,n),(t=new xe(e,e.j,t)).M=2,t.A=st(et(n)),n=!1,s.navigator&&s.navigator.sendBeacon)try{n=s.navigator.sendBeacon(t.A.toString(),"")}catch(r){}!n&&s.Image&&((new Image).src=t.A,n=!0),n||(t.g=an(t.j,null),t.g.ea(t.A)),t.F=Date.now(),Me(t)}rn(e)}function Ht(e){e.g&&(Xt(e),e.g.cancel(),e.g=null)}function Wt(e){Ht(e),e.v&&(s.clearTimeout(e.v),e.v=null),$t(e),e.h.cancel(),e.m&&("number"===typeof e.m&&s.clearTimeout(e.m),e.m=null)}function qt(e){if(!Ge(e.h)&&!e.m){e.m=!0;var t=e.Ea;v||w(),_||(v(),_=!0),b.add(t,e),e.D=0}}function Gt(e,t){var n;n=t?t.l:e.V++;const r=et(e.J);it(r,"SID",e.M),it(r,"RID",n),it(r,"AID",e.K),Kt(e,r),e.u&&e.o&&xt(r,e.u,e.o),n=new xe(e,e.j,n,e.D+1),null===e.u&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=Jt(e,n,1e3),n.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),Qe(e.h,n),Le(n,r,t)}function Kt(e,t){e.H&&P(e.H,function(e,n){it(t,n,e)}),e.l&&P({},function(e,n){it(t,n,e)})}function Jt(e,t,n){n=Math.min(e.i.length,n);const r=e.l?l(e.l.Ka,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?n>0?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let l=!0;for(let c=0;c<n;c++){var s=i[c].g;const n=i[c].map;if((s-=t)<0)t=Math.max(0,i[c].g-100),l=!1;else try{s="req"+s+"_"||0;try{var o=n instanceof Map?n:Object.entries(n);for(const[t,n]of o){let r=n;a(n)&&(r=se(n)),e.push(s+t+"="+encodeURIComponent(r))}}catch(ga){throw e.push(s+"type="+encodeURIComponent("_badmap")),ga}}catch(ga){r&&r(n)}}if(l){o=e.join("&");break e}}o=void 0}return e=e.i.splice(0,n),t.G=e,o}function Qt(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;v||w(),_||(v(),_=!0),b.add(t,e),e.A=0}}function Yt(e){return!(e.g||e.v||e.A>=3)&&(e.Y++,e.v=we(l(e.Da,e),tn(e,e.A)),e.A++,!0)}function Xt(e){null!=e.B&&(s.clearTimeout(e.B),e.B=null)}function Zt(e){e.g=new xe(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=et(e.na);it(t,"RID","rpc"),it(t,"SID",e.M),it(t,"AID",e.K),it(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&it(t,"TO",e.ia),it(t,"TYPE","xmlhttp"),Kt(e,t),e.u&&e.o&&xt(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=st(et(t)),n.u=null,n.R=!0,Oe(n,e)}function $t(e){null!=e.C&&(s.clearTimeout(e.C),e.C=null)}function en(e,t){var n=null;if(e.g==t){$t(e),Xt(e),e.g=null;var r=2}else{if(!Je(e.h,t))return;n=t.G,Ye(e.h,t),r=1}if(0!=e.I)if(t.o)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.F;var i=e.D;Z(r=me(),new be(r,n)),qt(e)}else Qt(e);else if(3==(i=t.m)||0==i&&t.X>0||!(1==r&&function(e,t){return!(Ke(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=t.G.concat(e.i),!0):!(1==e.I||2==e.I||e.D>=(e.Sa?0:e.Ta))&&(e.m=we(l(e.Ea,e,t),tn(e,e.D)),e.D++,!0))}(e,t)||2==r&&Yt(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),i){case 1:nn(e,5);break;case 4:nn(e,10);break;case 3:nn(e,6);break;default:nn(e,2)}}function tn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function nn(e,t){if(e.j.info("Error code "+t),2==t){var n=l(e.bb,e),r=e.Ua;const t=!r;r=new $e(r||"//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||tt(r,"https"),st(r),t?function(e,t){const n=new Ee;if(s.Image){const r=new Image;r.onload=c(Et,n,"TestLoadImage: loaded",!0,t,r),r.onerror=c(Et,n,"TestLoadImage: error",!1,t,r),r.onabort=c(Et,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=c(Et,n,"TestLoadImage: timeout",!1,t,r),s.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ee;const n=new AbortController,r=setTimeout(()=>{n.abort(),Et(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Et(0,0,!0,t):Et(0,0,!1,t)}).catch(()=>{clearTimeout(r),Et(0,0,!1,t)})}(r.toString(),n)}else _e(2);e.I=0,e.l&&e.l.pa(t),rn(e),Wt(e)}function rn(e){if(e.I=0,e.ja=[],e.l){const t=Xe(e.h);0==t.length&&0==e.i.length||(f(e.ja,t),f(e.ja,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.oa()}}function sn(e,t,n){var r=n instanceof $e?et(n):new $e(n);if(""!=r.g)t&&(r.g=t+"."+r.g),nt(r,r.u);else{var i=s.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;const e=new $e(null);r&&tt(e,r),t&&(e.g=t),i&&nt(e,i),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&it(r,n,t),it(r,"VER",e.ka),Kt(e,r),r}function an(e,t,n){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Aa&&!e.ma?new Rt(new Tt({ab:n})):new Rt(e.ma)).Fa(e.L),t}function on(){}function ln(){}function cn(e,t){X.call(this),this.g=new Vt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!k(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!k(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new hn(this)}function un(e){de.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function dn(){he.call(this),this.status=1}function hn(e){this.g=e}(e=Rt.prototype).Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Te.g(),this.g.onreadystatechange=d(l(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(a){return void Lt(this,a)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=s.FormData&&e instanceof s.FormData,!(Array.prototype.indexOf.call(Dt,t,void 0)>=0)||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(e),this.v=!1}catch(a){Lt(this,a)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,Z(this,"complete"),Z(this,"abort"),Ft(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ft(this,!0)),Rt.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?jt(this):this.Xa())},e.Xa=function(){jt(this)},e.isActive=function(){return!!this.g},e.ca=function(){try{return Mt(this)>2?this.g.status:-1}catch(e){return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),ae(t)}},e.ya=function(){return this.o},e.Ha=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Vt.prototype).ka=8,e.I=1,e.connect=function(e,t,n,r){_e(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=sn(this,null,this.W),qt(this)},e.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const i=new xe(this,this.j,e);let s=this.o;if(this.U&&(s?(s=D(s),O(s,this.U)):s=this.U),null!==this.u||this.R||(i.J=s,s=null),this.S)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if((t+=r)>4096){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Jt(this,i,t),it(n=et(this.J),"RID",e),it(n,"CVER",22),this.G&&it(n,"X-HTTP-Session-Id",this.G),Kt(this,n),s&&(this.R?t="headers="+Ae(Nt(s))+"&"+t:this.u&&xt(n,this.u,s)),Qe(this.h,i),this.Ra&&it(n,"TYPE","init"),this.S?(it(n,"$req",t),it(n,"SID","null"),i.U=!0,Le(i,n,null)):Le(i,n,t),this.I=2}}else 3==this.I&&(e?Gt(this,e):0==this.i.length||Ge(this.h)||Gt(this))},e.Da=function(){if(this.v=null,Zt(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=we(l(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,_e(10),Ht(this),Zt(this))},e.Va=function(){null!=this.C&&(this.C=null,Ht(this),Yt(this),_e(19))},e.bb=function(e){e?(this.j.info("Successfully pinged google.com"),_e(2)):(this.j.info("Failed to ping google.com"),_e(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=on.prototype).ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){},ln.prototype.g=function(e,t){return new cn(e,t)},u(cn,X),cn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){zt(this.g)},cn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=se(e),e=n);t.i.push(new We(t.Ya++,e)),3==t.I&&qt(t)},cn.prototype.N=function(){this.g.l=null,delete this.j,zt(this.g),delete this.g,cn.Z.N.call(this)},u(un,de),u(dn,he),u(hn,on),hn.prototype.ra=function(){Z(this.g,"a")},hn.prototype.qa=function(e){Z(this.g,new un(e))},hn.prototype.pa=function(e){Z(this.g,new dn)},hn.prototype.oa=function(){Z(this.g,"b")},ln.prototype.createWebChannel=ln.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,ha=pa.createWebChannelTransport=function(){return new ln},da=pa.getStatEventTarget=function(){return me()},ua=pa.Event=fe,ca=pa.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,la=pa.ErrorCode=Ie,ke.COMPLETE="complete",oa=pa.EventType=ke,ce.EventType=ue,ue.OPEN="a",ue.CLOSE="b",ue.ERROR="c",ue.MESSAGE="d",X.prototype.listen=X.prototype.J,aa=pa.WebChannel=ce,pa.FetchXmlHttpFactory=Tt,Rt.prototype.listenOnce=Rt.prototype.K,Rt.prototype.getLastError=Rt.prototype.Ha,Rt.prototype.getLastErrorCode=Rt.prototype.ya,Rt.prototype.getStatus=Rt.prototype.ca,Rt.prototype.getResponseJson=Rt.prototype.La,Rt.prototype.getResponseText=Rt.prototype.la,Rt.prototype.send=Rt.prototype.ea,Rt.prototype.setWithCredentials=Rt.prototype.Fa,sa=pa.XhrIo=Rt}).apply("undefined"!==typeof fa?fa:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const ma="@firebase/firestore",ga="4.9.3";class ya{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ya.UNAUTHENTICATED=new ya(null),ya.GOOGLE_CREDENTIALS=new ya("google-credentials-uid"),ya.FIRST_PARTY=new ya("first-party-uid"),ya.MOCK_USER=new ya("mock-user");let va="12.7.0";const _a=new ut("@firebase/firestore");function ba(){return _a.logLevel}function wa(e){if(_a.logLevel<=st.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ta);_a.debug("Firestore (".concat(va,"): ").concat(e),...i)}}function Ea(e){if(_a.logLevel<=st.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ta);_a.error("Firestore (".concat(va,"): ").concat(e),...i)}}function Sa(e){if(_a.logLevel<=st.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ta);_a.warn("Firestore (".concat(va,"): ").concat(e),...i)}}function Ta(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Ia(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,ka(e,r,n)}function ka(e,t,n){let r="FIRESTORE (".concat(va,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw Ea(r),new Error(r)}function Ca(e,t,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,e||ka(t,i,r)}function Aa(e,t){return e}const Na={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class xa extends He{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class Ra{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Pa{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class Da{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ya.UNAUTHENTICATED))}shutdown(){}}class La{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Oa{constructor(e){this.t=e,this.currentUser=ya.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ca(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Ra;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ra,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},a=e=>{wa("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(wa("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ra)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(wa("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Ca("string"==typeof t.accessToken,31837,{l:t}),new Pa(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ca(null===e||"string"==typeof e,2055,{h:e}),new ya(e)}}class ja{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=ya.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Fa{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new ja(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(ya.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ma{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ua{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,hn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ca(void 0===this.o,3512);const n=e=>{null!=e.error&&wa("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.m;return this.m=e.token,wa("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{wa("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):wa("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Ma(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(Ca("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new Ma(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Ba(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Va{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Ba(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function za(e,t){return e<t?-1:e>t?1:0}function Ha(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),i=t.charAt(r);if(n!==i)return Ga(n)===Ga(i)?za(n,i):Ga(n)?1:-1}return za(e.length,t.length)}const Wa=55296,qa=57343;function Ga(e){const t=e.charCodeAt(0);return t>=Wa&&t<=qa}function Ka(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const Ja="__name__";class Qa{constructor(e,t,n){void 0===t?t=0:t>e.length&&Ia(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&Ia(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Qa.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Qa?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=Qa.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return za(e.length,t.length)}static compareSegments(e,t){const n=Qa.isNumericId(e),r=Qa.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Qa.extractNumericId(e).compare(Qa.extractNumericId(t)):Ha(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ta.fromString(e.substring(4,e.length-2))}}class Ya extends Qa{construct(e,t,n){return new Ya(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new xa(Na.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter(e=>e.length>0))}return new Ya(e)}static emptyPath(){return new Ya([])}}const Xa=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Za extends Qa{construct(e,t,n){return new Za(e,t,n)}static isValidIdentifier(e){return Xa.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Za.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Ja}static keyField(){return new Za([Ja])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new xa(Na.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new xa(Na.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new xa(Na.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new xa(Na.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Za(t)}static emptyPath(){return new Za([])}}class $a{constructor(e){this.path=e}static fromPath(e){return new $a(Ya.fromString(e))}static fromName(e){return new $a(Ya.fromString(e).popFirst(5))}static empty(){return new $a(Ya.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ya.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ya.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $a(new Ya(e.slice()))}}function eo(e,t,n){if(!n)throw new xa(Na.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function to(e){if(!$a.isDocumentKey(e))throw new xa(Na.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function no(e){if($a.isDocumentKey(e))throw new xa(Na.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function ro(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function io(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":Ia(12329,{type:typeof e})}function so(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new xa(Na.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=io(e);throw new xa(Na.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function ao(e,t){const n={typeString:e};return t&&(n.value=t),n}function oo(e,t){if(!ro(e))throw new xa(Na.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n="JSON missing required field: '".concat(r,"'");break}const a=e[r];if(i&&typeof a!==i){n="JSON field '".concat(r,"' must be a ").concat(i,".");break}if(void 0!==s&&a!==s.value){n="Expected '".concat(r,"' field to equal '").concat(s.value,"'");break}}if(n)throw new xa(Na.INVALID_ARGUMENT,n);return!0}const lo=-62135596800,co=1e6;class uo{static now(){return uo.fromMillis(Date.now())}static fromDate(e){return uo.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*co);return new uo(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new xa(Na.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new xa(Na.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<lo)throw new xa(Na.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new xa(Na.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/co}_compareTo(e){return this.seconds===e.seconds?za(this.nanoseconds,e.nanoseconds):za(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:uo._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(oo(e,uo._jsonSchema))return new uo(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-lo;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}uo._jsonSchemaVersion="firestore/timestamp/1.0",uo._jsonSchema={type:ao("string",uo._jsonSchemaVersion),seconds:ao("number"),nanoseconds:ao("number")};class ho{static fromTimestamp(e){return new ho(e)}static min(){return new ho(new uo(0,0))}static max(){return new ho(new uo(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const fo=-1;class po{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}po.UNKNOWN_ID=-1;function mo(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=ho.fromTimestamp(1e9===r?new uo(n+1,0):new uo(n,r));return new yo(i,$a.empty(),t)}function go(e){return new yo(e.readTime,e.key,fo)}class yo{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new yo(ho.min(),$a.empty(),fo)}static max(){return new yo(ho.max(),$a.empty(),fo)}}function vo(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=$a.comparator(e.documentKey,t.documentKey),0!==n?n:za(e.largestBatchId,t.largestBatchId))}const _o="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class bo{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function wo(e){if(e.code!==Na.FAILED_PRECONDITION||e.message!==_o)throw e;wa("LocalStore","Unexpectedly lost primary lease")}class Eo{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ia(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Eo((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Eo?t:Eo.resolve(t)}catch(e){return Eo.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Eo.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Eo.reject(t)}static resolve(e){return new Eo((t,n)=>{t(e)})}static reject(e){return new Eo((t,n)=>{n(e)})}static waitFor(e){return new Eo((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=Eo.resolve(!1);for(const n of e)t=t.next(e=>e?Eo.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Eo((n,r)=>{const i=e.length,s=new Array(i);let a=0;for(let o=0;o<i;o++){const l=o;t(e[l]).next(e=>{s[l]=e,++a,a===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new Eo((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function So(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function To(e){return"IndexedDbTransactionError"===e.name}class Io{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Io.ce=-1;const ko=-1;function Co(e){return null==e}function Ao(e){return 0===e&&1/e==-1/0}function No(e){return"number"==typeof e&&Number.isInteger(e)&&!Ao(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const xo="\x01";function Ro(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Do(t)),t=Po(e.get(n),t);return Do(t)}function Po(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case xo:n+="\x01\x11";break;default:n+=t}}return n}function Do(e){return e+xo+"\x01"}const Lo="remoteDocuments",Oo="owner",jo="mutationQueues",Fo="mutations";const Mo="documentMutations",Uo="remoteDocumentsV14",Bo="remoteDocumentGlobal",Vo="targets",zo="targetDocuments",Ho="targetGlobal",Wo="collectionParents",qo="clientMetadata",Go="bundles",Ko="namedQueries",Jo="indexConfiguration",Qo="indexState",Yo="indexEntries",Xo="documentOverlays",Zo="globals",$o=[jo,Fo,Mo,Lo,Vo,Oo,Ho,zo,qo,Bo,Wo,Go,Ko],el=[jo,Fo,Mo,Uo,Vo,Oo,Ho,zo,qo,Bo,Wo,Go,Ko,Xo],tl=el,nl=[...tl,Jo,Qo,Yo];function rl(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function il(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function sl(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class al{constructor(e,t){this.comparator=e,this.root=t||ll.EMPTY}insert(e,t){return new al(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ll.BLACK,null,null))}remove(e){return new al(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ll.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ol(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ol(this.root,e,this.comparator,!1)}getReverseIterator(){return new ol(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ol(this.root,e,this.comparator,!0)}}class ol{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ll{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:ll.RED,this.left=null!=r?r:ll.EMPTY,this.right=null!=i?i:ll.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new ll(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ll.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return ll.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ll.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ll.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ia(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ia(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ia(27949);return e+(this.isRed()?0:1)}}ll.EMPTY=null,ll.RED=!0,ll.BLACK=!1,ll.EMPTY=new class{constructor(){this.size=0}get key(){throw Ia(57766)}get value(){throw Ia(16141)}get color(){throw Ia(16727)}get left(){throw Ia(29726)}get right(){throw Ia(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new ll(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class cl{constructor(e){this.comparator=e,this.data=new al(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ul(this.data.getIterator())}getIteratorFrom(e){return new ul(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof cl))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new cl(this.comparator);return t.data=e,t}}class ul{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class dl{constructor(e){this.fields=e,e.sort(Za.comparator)}static empty(){return new dl([])}unionWith(e){let t=new cl(Za.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new dl(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ka(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class hl extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class fl{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new hl("Invalid base64 string: "+e):e}}(e);return new fl(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new fl(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return za(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}fl.EMPTY_BYTE_STRING=new fl("");const pl=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ml(e){if(Ca(!!e,39018),"string"==typeof e){let t=0;const n=pl.exec(e);if(Ca(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:gl(e.seconds),nanos:gl(e.nanos)}}function gl(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function yl(e){return"string"==typeof e?fl.fromBase64String(e):fl.fromUint8Array(e)}const vl="server_timestamp",_l="__type__",bl="__previous_value__",wl="__local_write_time__";function El(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[_l])||void 0===t?void 0:t.stringValue)===vl}function Sl(e){const t=e.mapValue.fields[bl];return El(t)?Sl(t):t}function Tl(e){const t=ml(e.mapValue.fields[wl].timestampValue);return new uo(t.seconds,t.nanos)}class Il{constructor(e,t,n,r,i,s,a,o,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}const kl="(default)";class Cl{constructor(e,t){this.projectId=e,this.database=t||kl}static empty(){return new Cl("","")}get isDefaultDatabase(){return this.database===kl}isEqual(e){return e instanceof Cl&&e.projectId===this.projectId&&e.database===this.database}}const Al="__type__",Nl="__max__",xl={mapValue:{fields:{__type__:{stringValue:Nl}}}},Rl="__vector__",Pl="value";function Dl(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?El(e)?4:Yl(e)?9007199254740991:Jl(e)?10:11:Ia(28295,{value:e})}function Ll(e,t){if(e===t)return!0;const n=Dl(e);if(n!==Dl(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Tl(e).isEqual(Tl(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=ml(e.timestampValue),r=ml(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return yl(e.bytesValue).isEqual(yl(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return gl(e.geoPointValue.latitude)===gl(t.geoPointValue.latitude)&&gl(e.geoPointValue.longitude)===gl(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return gl(e.integerValue)===gl(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=gl(e.doubleValue),r=gl(t.doubleValue);return n===r?Ao(n)===Ao(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Ka(e.arrayValue.values||[],t.arrayValue.values||[],Ll);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(rl(n)!==rl(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ll(n[i],r[i])))return!1;return!0}(e,t);default:return Ia(52216,{left:e})}}function Ol(e,t){return void 0!==(e.values||[]).find(e=>Ll(e,t))}function jl(e,t){if(e===t)return 0;const n=Dl(e),r=Dl(t);if(n!==r)return za(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return za(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=gl(e.integerValue||e.doubleValue),r=gl(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Fl(e.timestampValue,t.timestampValue);case 4:return Fl(Tl(e),Tl(t));case 5:return Ha(e.stringValue,t.stringValue);case 6:return function(e,t){const n=yl(e),r=yl(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=za(n[i],r[i]);if(0!==e)return e}return za(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=za(gl(e.latitude),gl(t.latitude));return 0!==n?n:za(gl(e.longitude),gl(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Ml(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const a=e.fields||{},o=t.fields||{},l=null===(n=a[Pl])||void 0===n?void 0:n.arrayValue,c=null===(r=o[Pl])||void 0===r?void 0:r.arrayValue,u=za((null===l||void 0===l||null===(i=l.values)||void 0===i?void 0:i.length)||0,(null===c||void 0===c||null===(s=c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:Ml(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===xl.mapValue&&t===xl.mapValue)return 0;if(e===xl.mapValue)return 1;if(t===xl.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let a=0;a<r.length&&a<s.length;++a){const e=Ha(r[a],s[a]);if(0!==e)return e;const t=jl(n[r[a]],i[s[a]]);if(0!==t)return t}return za(r.length,s.length)}(e.mapValue,t.mapValue);default:throw Ia(23264,{he:n})}}function Fl(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return za(e,t);const n=ml(e),r=ml(t),i=za(n.seconds,r.seconds);return 0!==i?i:za(n.nanos,r.nanos)}function Ml(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=jl(n[i],r[i]);if(e)return e}return za(n.length,r.length)}function Ul(e){return Bl(e)}function Bl(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=ml(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return yl(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return $a.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Bl(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(Bl(e.fields[i]));return n+"}"}(e.mapValue):Ia(61005,{value:e})}function Vl(e){switch(Dl(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Sl(e);return t?16+Vl(t):16;case 5:return 2*e.stringValue.length;case 6:return yl(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+Vl(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return il(e.fields,(e,n)=>{t+=e.length+Vl(n)}),t}(e.mapValue);default:throw Ia(13486,{value:e})}}function zl(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Hl(e){return!!e&&"integerValue"in e}function Wl(e){return!!e&&"arrayValue"in e}function ql(e){return!!e&&"nullValue"in e}function Gl(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Kl(e){return!!e&&"mapValue"in e}function Jl(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[Al])||void 0===t?void 0:t.stringValue)===Rl}function Ql(e){if(e.geoPointValue)return{geoPointValue:c({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:c({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return il(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Ql(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Ql(e.arrayValue.values[n]);return t}return c({},e)}function Yl(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Nl}class Xl{constructor(e){this.value=e}static empty(){return new Xl({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Kl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ql(t)}setAll(e){let t=Za.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Ql(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Kl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ll(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Kl(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){il(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Xl(Ql(this.value))}}function Zl(e){const t=[];return il(e.fields,(e,n)=>{const r=new Za([e]);if(Kl(n)){const e=Zl(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new dl(t)}class $l{constructor(e,t,n,r,i,s,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new $l(e,0,ho.min(),ho.min(),ho.min(),Xl.empty(),0)}static newFoundDocument(e,t,n,r){return new $l(e,1,t,ho.min(),n,r,0)}static newNoDocument(e,t){return new $l(e,2,t,ho.min(),ho.min(),Xl.empty(),0)}static newUnknownDocument(e,t){return new $l(e,3,t,ho.min(),ho.min(),Xl.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ho.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xl.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xl.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ho.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof $l&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $l(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class ec{constructor(e,t){this.position=e,this.inclusive=t}}function tc(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],a=e.position[i];if(r=s.field.isKeyField()?$a.comparator($a.fromName(a.referenceValue),n.key):jl(a,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function nc(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Ll(e.position[n],t.position[n]))return!1;return!0}class rc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function ic(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class sc{}class ac extends sc{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new pc(e,t,n):"array-contains"===t?new vc(e,n):"in"===t?new _c(e,n):"not-in"===t?new bc(e,n):"array-contains-any"===t?new wc(e,n):new ac(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new mc(e,n):new gc(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(jl(t,this.value)):null!==t&&Dl(this.value)===Dl(t)&&this.matchesComparison(jl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Ia(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class oc extends sc{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new oc(e,t)}matches(e){return lc(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function lc(e){return"and"===e.op}function cc(e){return uc(e)&&lc(e)}function uc(e){for(const t of e.filters)if(t instanceof oc)return!1;return!0}function dc(e){if(e instanceof ac)return e.field.canonicalString()+e.op.toString()+Ul(e.value);if(cc(e))return e.filters.map(e=>dc(e)).join(",");{const t=e.filters.map(e=>dc(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function hc(e,t){return e instanceof ac?function(e,t){return t instanceof ac&&e.op===t.op&&e.field.isEqual(t.field)&&Ll(e.value,t.value)}(e,t):e instanceof oc?function(e,t){return t instanceof oc&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&hc(n,t.filters[r]),!0)}(e,t):void Ia(19439)}function fc(e){return e instanceof ac?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Ul(e.value))}(e):e instanceof oc?function(e){return e.op.toString()+" {"+e.getFilters().map(fc).join(" ,")+"}"}(e):"Filter"}class pc extends ac{constructor(e,t,n){super(e,t,n),this.key=$a.fromName(n.referenceValue)}matches(e){const t=$a.comparator(e.key,this.key);return this.matchesComparison(t)}}class mc extends ac{constructor(e,t){super(e,"in",t),this.keys=yc("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class gc extends ac{constructor(e,t){super(e,"not-in",t),this.keys=yc("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function yc(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>$a.fromName(e.referenceValue))}class vc extends ac{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Wl(t)&&Ol(t.arrayValue,this.value)}}class _c extends ac{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Ol(this.value.arrayValue,t)}}class bc extends ac{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ol(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Ol(this.value.arrayValue,t)}}class wc extends ac{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Wl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Ol(this.value.arrayValue,e))}}class Ec{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=a,this.Te=null}}function Sc(e){return new Ec(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Tc(e){const t=Aa(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>dc(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Co(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Ul(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Ul(e)).join(",")),t.Te=e}return t.Te}function Ic(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!ic(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!hc(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!nc(e.startAt,t.startAt)&&nc(e.endAt,t.endAt)}function kc(e){return $a.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Cc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Ac(e,t,n,r,i,s,a,o){return new Cc(e,t,n,r,i,s,a,o)}function Nc(e){return new Cc(e)}function xc(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Rc(e){return null!==e.collectionGroup}function Pc(e){const t=Aa(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const i of t.explicitOrderBy)t.Ie.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new cl(Za.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new rc(r,n))}),e.has(Za.keyField().canonicalString())||t.Ie.push(new rc(Za.keyField(),n))}return t.Ie}function Dc(e){const t=Aa(e);return t.Ee||(t.Ee=Lc(t,Pc(e))),t.Ee}function Lc(e,t){if("F"===e.limitType)return Sc(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new rc(e.field,t)});const n=e.endAt?new ec(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new ec(e.startAt.position,e.startAt.inclusive):null;return Sc(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Oc(e,t){const n=e.filters.concat([t]);return new Cc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function jc(e,t,n){return new Cc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Fc(e,t){return Ic(Dc(e),Dc(t))&&e.limitType===t.limitType}function Mc(e){return"".concat(Tc(Dc(e)),"|lt:").concat(e.limitType)}function Uc(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>fc(e)).join(", "),"]")),Co(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Ul(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Ul(e)).join(",")),"Target(".concat(t,")")}(Dc(e)),"; limitType=").concat(e.limitType,")")}function Bc(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):$a.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Pc(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=tc(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Pc(e),t))&&!(e.endAt&&!function(e,t,n){const r=tc(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Pc(e),t))}(e,t)}function Vc(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function zc(e){return(t,n)=>{let r=!1;for(const i of Pc(e)){const e=Hc(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Hc(e,t,n){const r=e.field.isKeyField()?$a.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?jl(r,i):Ia(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Ia(19790,{direction:e.dir})}}class Wc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){il(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return sl(this.inner)}size(){return this.innerSize}}const qc=new al($a.comparator);function Gc(){return qc}const Kc=new al($a.comparator);function Jc(){let e=Kc;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function Qc(e){let t=Kc;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Yc(){return Zc()}function Xc(){return Zc()}function Zc(){return new Wc(e=>e.toString(),(e,t)=>e.isEqual(t))}const $c=new al($a.comparator),eu=new cl($a.comparator);function tu(){let e=eu;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const nu=new cl(za);function ru(){return nu}function iu(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ao(t)?"-0":t}}function su(e){return{integerValue:""+e}}function au(e,t){return No(t)?su(t):iu(e,t)}class ou{constructor(){this._=void 0}}function lu(e,t,n){return e instanceof du?function(e,t){const n={fields:{[_l]:{stringValue:vl},[wl]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&El(t)&&(t=Sl(t)),t&&(n.fields[bl]=t),{mapValue:n}}(n,t):e instanceof hu?fu(e,t):e instanceof pu?mu(e,t):function(e,t){const n=uu(e,t),r=yu(n)+yu(e.Ae);return Hl(n)&&Hl(e.Ae)?su(r):iu(e.serializer,r)}(e,t)}function cu(e,t,n){return e instanceof hu?fu(e,t):e instanceof pu?mu(e,t):n}function uu(e,t){return e instanceof gu?function(e){return Hl(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class du extends ou{}class hu extends ou{constructor(e){super(),this.elements=e}}function fu(e,t){const n=vu(t);for(const r of e.elements)n.some(e=>Ll(e,r))||n.push(r);return{arrayValue:{values:n}}}class pu extends ou{constructor(e){super(),this.elements=e}}function mu(e,t){let n=vu(t);for(const r of e.elements)n=n.filter(e=>!Ll(e,r));return{arrayValue:{values:n}}}class gu extends ou{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function yu(e){return gl(e.integerValue||e.doubleValue)}function vu(e){return Wl(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class _u{constructor(e,t){this.version=e,this.transformResults=t}}class bu{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new bu}static exists(e){return new bu(void 0,e)}static updateTime(e){return new bu(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wu(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Eu{}function Su(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Du(e.key,bu.none()):new Au(e.key,e.data,bu.none());{const n=e.data,r=Xl.empty();let i=new cl(Za.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Nu(e.key,r,new dl(i.toArray()),bu.none())}}function Tu(e,t,n){e instanceof Au?function(e,t,n){const r=e.value.clone(),i=Ru(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Nu?function(e,t,n){if(!wu(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Ru(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(xu(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Iu(e,t,n,r){return e instanceof Au?function(e,t,n,r){if(!wu(e.precondition,t))return n;const i=e.value.clone(),s=Pu(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Nu?function(e,t,n,r){if(!wu(e.precondition,t))return n;const i=Pu(e.fieldTransforms,r,t),s=t.data;return s.setAll(xu(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return wu(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function ku(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=uu(r.transform,e||null);null!=i&&(null===n&&(n=Xl.empty()),n.set(r.field,i))}return n||null}function Cu(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Ka(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof hu&&t instanceof hu||e instanceof pu&&t instanceof pu?Ka(e.elements,t.elements,Ll):e instanceof gu&&t instanceof gu?Ll(e.Ae,t.Ae):e instanceof du&&t instanceof du}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Au extends Eu{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Nu extends Eu{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function xu(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Ru(e,t,n){const r=new Map;Ca(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let i=0;i<n.length;i++){const s=e[i],a=s.transform,o=t.data.field(s.field);r.set(s.field,cu(a,o,n[i]))}return r}function Pu(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,lu(e,s,t))}return r}class Du extends Eu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Lu extends Eu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ou{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Tu(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Iu(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Iu(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Xc();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let a=this.applyToLocalView(s,i.mutatedFields);a=t.has(r.key)?null:a;const o=Su(s,a);null!==o&&n.set(r.key,o),s.isValidDocument()||s.convertToNoDocument(ho.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),tu())}isEqual(e){return this.batchId===e.batchId&&Ka(this.mutations,e.mutations,(e,t)=>Cu(e,t))&&Ka(this.baseMutations,e.baseMutations,(e,t)=>Cu(e,t))}}class ju{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Ca(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=$c;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new ju(e,t,n,r)}}class Fu{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Mu{constructor(e,t){this.count=e,this.unchangedNames=t}}var Uu,Bu;function Vu(e){switch(e){case Na.OK:return Ia(64938);case Na.CANCELLED:case Na.UNKNOWN:case Na.DEADLINE_EXCEEDED:case Na.RESOURCE_EXHAUSTED:case Na.INTERNAL:case Na.UNAVAILABLE:case Na.UNAUTHENTICATED:return!1;case Na.INVALID_ARGUMENT:case Na.NOT_FOUND:case Na.ALREADY_EXISTS:case Na.PERMISSION_DENIED:case Na.FAILED_PRECONDITION:case Na.ABORTED:case Na.OUT_OF_RANGE:case Na.UNIMPLEMENTED:case Na.DATA_LOSS:return!0;default:return Ia(15467,{code:e})}}function zu(e){if(void 0===e)return Ea("GRPC error has no .code"),Na.UNKNOWN;switch(e){case Uu.OK:return Na.OK;case Uu.CANCELLED:return Na.CANCELLED;case Uu.UNKNOWN:return Na.UNKNOWN;case Uu.DEADLINE_EXCEEDED:return Na.DEADLINE_EXCEEDED;case Uu.RESOURCE_EXHAUSTED:return Na.RESOURCE_EXHAUSTED;case Uu.INTERNAL:return Na.INTERNAL;case Uu.UNAVAILABLE:return Na.UNAVAILABLE;case Uu.UNAUTHENTICATED:return Na.UNAUTHENTICATED;case Uu.INVALID_ARGUMENT:return Na.INVALID_ARGUMENT;case Uu.NOT_FOUND:return Na.NOT_FOUND;case Uu.ALREADY_EXISTS:return Na.ALREADY_EXISTS;case Uu.PERMISSION_DENIED:return Na.PERMISSION_DENIED;case Uu.FAILED_PRECONDITION:return Na.FAILED_PRECONDITION;case Uu.ABORTED:return Na.ABORTED;case Uu.OUT_OF_RANGE:return Na.OUT_OF_RANGE;case Uu.UNIMPLEMENTED:return Na.UNIMPLEMENTED;case Uu.DATA_LOSS:return Na.DATA_LOSS;default:return Ia(39323,{code:e})}}(Bu=Uu||(Uu={}))[Bu.OK=0]="OK",Bu[Bu.CANCELLED=1]="CANCELLED",Bu[Bu.UNKNOWN=2]="UNKNOWN",Bu[Bu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Bu[Bu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Bu[Bu.NOT_FOUND=5]="NOT_FOUND",Bu[Bu.ALREADY_EXISTS=6]="ALREADY_EXISTS",Bu[Bu.PERMISSION_DENIED=7]="PERMISSION_DENIED",Bu[Bu.UNAUTHENTICATED=16]="UNAUTHENTICATED",Bu[Bu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Bu[Bu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Bu[Bu.ABORTED=10]="ABORTED",Bu[Bu.OUT_OF_RANGE=11]="OUT_OF_RANGE",Bu[Bu.UNIMPLEMENTED=12]="UNIMPLEMENTED",Bu[Bu.INTERNAL=13]="INTERNAL",Bu[Bu.UNAVAILABLE=14]="UNAVAILABLE",Bu[Bu.DATA_LOSS=15]="DATA_LOSS";let Hu=null;function Wu(){return new TextEncoder}const qu=new ta([4294967295,4294967295],0);function Gu(e){const t=Wu().encode(e),n=new na;return n.update(t),new Uint8Array(n.digest())}function Ku(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new ta([n,r],0),new ta([i,s],0)]}class Ju{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Qu("Invalid padding: ".concat(t));if(n<0)throw new Qu("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new Qu("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new Qu("Invalid padding when bitmap length is 0: ".concat(t));this.ge=8*e.length-t,this.pe=ta.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(ta.fromNumber(n)));return 1===r.compare(qu)&&(r=new ta([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=Gu(e),[n,r]=Ku(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new Ju(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.ge)return;const t=Gu(e),[n,r]=Ku(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Qu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Yu{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Xu.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Yu(ho.min(),r,new al(za),Gc(),tu())}}class Xu{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Xu(n,t,tu(),tu(),tu())}}class Zu{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class $u{constructor(e,t){this.targetId=e,this.Ce=t}}class ed{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fl.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class td{constructor(){this.ve=0,this.Fe=id(),this.Me=fl.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=tu(),t=tu(),n=tu();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Ia(38017,{changeType:i})}}),new Xu(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=id()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ca(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class nd{constructor(e){this.Ge=e,this.ze=new Map,this.je=Gc(),this.Je=rd(),this.He=rd(),this.Ye=new al(za)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Ia(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const s=r.target;if(kc(s))if(0===n){const e=new $a(s.path);this.et(t,e,$l.newNoDocument(e,ho.min()))}else Ca(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){var i;const n=this.ut(e),s=n?this.ct(n,e,r):1;if(0!==s){this.it(t);const e=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}null===(i=Hu)||void 0===i||i.lt(function(e,t,n,r,i){var s,a,o,l,c;const u={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(u.bloomFilter={applied:0===i,hashCount:null!==(s=null===d||void 0===d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(a=null===d||void 0===d||null===(o=d.bits)||void 0===o||null===(o=o.bitmap)||void 0===o?void 0:o.length)&&void 0!==a?a:0,padding:null!==(l=null===d||void 0===d||null===(c=d.bits)||void 0===c?void 0:c.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null===r||void 0===r?void 0:r.mightContain(e))&&void 0!==t&&t}}),u}(r,e.Ce,this.Ge.ht(),n,s))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,a;try{s=yl(n).toUint8Array()}catch(e){if(e instanceof hl)return Sa("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{a=new Ju(s,r,i)}catch(e){return Sa(e instanceof Qu?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===a.ge?null:a}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.Ge.ht(),s="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(s)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const i=this.ot(r);if(i){if(n.current&&kc(i.target)){const t=new $a(i.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,$l.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=tu();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new Yu(e,t,this.Ye,this.je,n);return this.je=Gc(),this.Je=rd(),this.He=rd(),this.Ye=new al(za),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new td,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new cl(za),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new cl(za),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||wa("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new td),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function rd(){return new al($a.comparator)}function id(){return new al($a.comparator)}const sd={asc:"ASCENDING",desc:"DESCENDING"},ad={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},od={and:"AND",or:"OR"};class ld{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function cd(e,t){return e.useProto3Json||Co(t)?t:{value:t}}function ud(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function dd(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function hd(e,t){return ud(e,t.toTimestamp())}function fd(e){return Ca(!!e,49232),ho.fromTimestamp(function(e){const t=ml(e);return new uo(t.seconds,t.nanos)}(e))}function pd(e,t){return md(e,t).canonicalString()}function md(e,t){const n=function(e){return new Ya(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function gd(e){const t=Ya.fromString(e);return Ca(jd(t),10190,{key:t.toString()}),t}function yd(e,t){return pd(e.databaseId,t.path)}function vd(e,t){const n=gd(t);if(n.get(1)!==e.databaseId.projectId)throw new xa(Na.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new xa(Na.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new $a(Ed(n))}function _d(e,t){return pd(e.databaseId,t)}function bd(e){const t=gd(e);return 4===t.length?Ya.emptyPath():Ed(t)}function wd(e){return new Ya(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Ed(e){return Ca(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function Sd(e,t,n){return{name:yd(e,t),fields:n.value.mapValue.fields}}function Td(e,t){let n;if(t instanceof Au)n={update:Sd(e,t.key,t.value)};else if(t instanceof Du)n={delete:yd(e,t.key)};else if(t instanceof Nu)n={update:Sd(e,t.key,t.data),updateMask:Od(t.fieldMask)};else{if(!(t instanceof Lu))return Ia(16599,{Vt:t.type});n={verify:yd(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof du)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof hu)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof pu)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof gu)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw Ia(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:hd(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Ia(27497)}(e,t.precondition)),n}function Id(e,t){return{documents:[_d(e,t.path)]}}function kd(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=_d(e,i);const s=function(e){if(0!==e.length)return Ld(oc.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const a=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:Pd(e.field),direction:Nd(e.dir)}}(e))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const o=cd(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:i}}function Cd(e){let t=bd(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Ca(1===r,65062);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Ad(e);return t instanceof oc&&cc(t)?t.getFilters():[t]}(n.where));let a=[];n.orderBy&&(a=function(e){return e.map(e=>function(e){return new rc(Dd(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,Co(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new ec(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new ec(n,t)}(n.endAt)),Ac(t,i,a,s,o,"F",l,c)}function Ad(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Dd(e.unaryFilter.field);return ac.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Dd(e.unaryFilter.field);return ac.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Dd(e.unaryFilter.field);return ac.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Dd(e.unaryFilter.field);return ac.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ia(61313);default:return Ia(60726)}}(e):void 0!==e.fieldFilter?function(e){return ac.create(Dd(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ia(58110);default:return Ia(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return oc.create(e.compositeFilter.filters.map(e=>Ad(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Ia(1026)}}(e.compositeFilter.op))}(e):Ia(30097,{filter:e})}function Nd(e){return sd[e]}function xd(e){return ad[e]}function Rd(e){return od[e]}function Pd(e){return{fieldPath:e.canonicalString()}}function Dd(e){return Za.fromServerFormat(e.fieldPath)}function Ld(e){return e instanceof ac?function(e){if("=="===e.op){if(Gl(e.value))return{unaryFilter:{field:Pd(e.field),op:"IS_NAN"}};if(ql(e.value))return{unaryFilter:{field:Pd(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Gl(e.value))return{unaryFilter:{field:Pd(e.field),op:"IS_NOT_NAN"}};if(ql(e.value))return{unaryFilter:{field:Pd(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Pd(e.field),op:xd(e.op),value:e.value}}}(e):e instanceof oc?function(e){const t=e.getFilters().map(e=>Ld(e));return 1===t.length?t[0]:{compositeFilter:{op:Rd(e.op),filters:t}}}(e):Ia(54877,{filter:e})}function Od(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function jd(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Fd{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ho.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ho.min(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:fl.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new Fd(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Fd(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Md{constructor(e){this.yt=e}}function Ud(e){const t=Cd({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?jc(t,t.limit,"L"):t}class Bd{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(gl(e.integerValue));else if("doubleValue"in e){const n=gl(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),Ao(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=ml(n)),t.xt("".concat(n.seconds||"")),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(yl(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?Yl(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Jl(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Ia(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){var n;const r=e.fields||{};this.Ft(t,53);const i=Pl,s=(null===(n=r[i].arrayValue)||void 0===n||null===(n=n.values)||void 0===n?void 0:n.length)||0;this.Ft(t,15),t.Mt(gl(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),$a.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Bd.Kt=new Bd;class Vd{constructor(){this.Cn=new zd}addToCollectionParentIndex(e,t){return this.Cn.add(t),Eo.resolve()}getCollectionParents(e,t){return Eo.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Eo.resolve()}deleteFieldIndex(e,t){return Eo.resolve()}deleteAllFieldIndexes(e){return Eo.resolve()}createTargetIndexes(e,t){return Eo.resolve()}getDocumentsMatchingTarget(e,t){return Eo.resolve(null)}getIndexType(e,t){return Eo.resolve(0)}getFieldIndexes(e,t){return Eo.resolve([])}getNextCollectionGroupToUpdate(e){return Eo.resolve(null)}getMinOffset(e,t){return Eo.resolve(yo.min())}getMinOffsetFromCollectionGroup(e,t){return Eo.resolve(yo.min())}updateCollectionGroup(e,t,n){return Eo.resolve()}updateIndexEntries(e,t){return Eo.resolve()}}class zd{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new cl(Ya.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new cl(Ya.comparator)).toArray()}}new Uint8Array(0);const Hd={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Wd=41943040;class qd{static withCacheSize(e){return new qd(e,qd.DEFAULT_COLLECTION_PERCENTILE,qd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}qd.DEFAULT_COLLECTION_PERCENTILE=10,qd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qd.DEFAULT=new qd(Wd,qd.DEFAULT_COLLECTION_PERCENTILE,qd.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qd.DISABLED=new qd(-1,0,0);class Gd{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Gd(0)}static cr(){return new Gd(-1)}}const Kd="LruGarbageCollector",Jd=1048576;function Qd(e,t){let[n,r]=e,[i,s]=t;const a=za(n,i);return 0===a?za(r,s):a}class Yd{constructor(e){this.Ir=e,this.buffer=new cl(Qd),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Qd(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Xd{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){wa(Kd,"Garbage collection scheduled in ".concat(e,"ms")),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){To(e)?wa(Kd,"Ignoring IndexedDB error during garbage collection: ",e):await wo(e)}await this.Vr(3e5)})}}class Zd{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Eo.resolve(Io.ce);const n=new Yd(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(wa("LruGarbageCollector","Garbage collection skipped; disabled"),Eo.resolve(Hd)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(wa("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),Hd):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,s,a,o,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(wa("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,a=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,o=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),ba()<=st.DEBUG&&wa("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(s-c,"ms\n\tDetermined least recently used ").concat(r," in ")+(a-s)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(o-a)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(l-o)+"ms\n"+"Total Duration: ".concat(l-c,"ms")),Eo.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}function $d(e,t){return new Zd(e,t)}class eh{constructor(){this.changes=new Wc(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,$l.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Eo.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class th{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class nh{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Iu(n.mutation,e,dl.empty(),uo.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,tu()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tu();const r=Yc();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=Jc();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Yc();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,tu()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=Gc();const s=Zc(),a=Zc();return t.forEach((e,t)=>{const a=n.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof Nu)?i=i.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),Iu(a.mutation,t,a.mutation.getFieldMask(),uo.now())):s.set(t.key,dl.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return a.set(e,new th(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),a))}recalculateAndSaveOverlays(e,t){const n=Zc();let r=new al((e,t)=>e-t),i=tu();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let a=n.get(e)||dl.empty();a=i.applyToLocalView(s,a),n.set(e,a);const o=(r.get(i.batchId)||tu()).add(e);r=r.insert(i.batchId,o)})}).next(()=>{const s=[],a=r.getReverseIterator();for(;a.hasNext();){const r=a.getNext(),o=r.key,l=r.value,c=Xc();l.forEach(e=>{if(!i.has(e)){const r=Su(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,c))}return Eo.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return $a.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Rc(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Eo.resolve(Yc());let a=fo,o=i;return s.next(t=>Eo.forEach(t,(t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),i.get(t)?Eo.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,o,t,tu())).next(e=>({batchId:a,changes:Qc(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $a(t)).next(e=>{let t=Jc();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=Jc();return this.indexManager.getCollectionParents(e,i).next(a=>Eo.forEach(a,a=>{const o=function(e,t){return new Cc(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,$l.newInvalidDocument(r)))});let n=Jc();return e.forEach((e,r)=>{const s=i.get(e);void 0!==s&&Iu(s.mutation,r,dl.empty(),uo.now()),Bc(t,r)&&(n=n.insert(e,r))}),n})}}class rh{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Eo.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:fd(e.createTime)}}(t)),Eo.resolve()}getNamedQuery(e,t){return Eo.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:Ud(e.bundledQuery),readTime:fd(e.readTime)}}(t)),Eo.resolve()}}class ih{constructor(){this.overlays=new al($a.comparator),this.qr=new Map}getOverlay(e,t){return Eo.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Yc();return Eo.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),Eo.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),Eo.resolve()}getOverlaysForCollection(e,t,n){const r=Yc(),i=t.length+1,s=new $a(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Eo.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new al((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Yc(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=Yc(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=r)););return Eo.resolve(a)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Fu(t,n));let i=this.qr.get(t);void 0===i&&(i=tu(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}class sh{constructor(){this.sessionToken=fl.EMPTY_BYTE_STRING}getSessionToken(e){return Eo.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Eo.resolve()}}class ah{constructor(){this.Qr=new cl(oh.$r),this.Ur=new cl(oh.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new oh(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new oh(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new $a(new Ya([])),n=new oh(t,e),r=new oh(t,e+1),i=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),i.push(e.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new $a(new Ya([])),n=new oh(t,e),r=new oh(t,e+1);let i=tu();return this.Ur.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new oh(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class oh{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return $a.comparator(e.key,t.key)||za(e.Yr,t.Yr)}static Kr(e,t){return za(e.Yr,t.Yr)||$a.comparator(e.key,t.key)}}class lh{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new cl(oh.$r)}checkEmpty(e){return Eo.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Ou(i,t,n,r);this.mutationQueue.push(s);for(const a of r)this.Zr=this.Zr.add(new oh(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Eo.resolve(s)}lookupMutationBatch(e,t){return Eo.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),i=r<0?0:r;return Eo.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Eo.resolve(0===this.mutationQueue.length?ko:this.tr-1)}getAllMutationBatches(e){return Eo.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new oh(t,0),r=new oh(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);i.push(t)}),Eo.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new cl(za);return t.forEach(e=>{const t=new oh(e,0),r=new oh(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),Eo.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;$a.isDocumentKey(i)||(i=i.child(""));const s=new oh(new $a(i),0);let a=new cl(za);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.Yr)),!0)},s),Eo.resolve(this.ti(a))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){Ca(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return Eo.forEach(t.mutations,r=>{const i=new oh(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new oh(t,0),r=this.Zr.firstAfterOrEqual(n);return Eo.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Eo.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ch{constructor(e){this.ri=e,this.docs=new al($a.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Eo.resolve(n?n.document.mutableCopy():$l.newInvalidDocument(t))}getEntries(e,t){let n=Gc();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():$l.newInvalidDocument(e))}),Eo.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Gc();const s=t.path,a=new $a(s.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||vo(go(a),n)<=0||(r.has(a.key)||Bc(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return Eo.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Ia(9500)}ii(e,t){return Eo.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new uh(this)}getSize(e){return Eo.resolve(this.size)}}class uh extends eh{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),Eo.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class dh{constructor(e){this.persistence=e,this.si=new Wc(e=>Tc(e),Ic),this.lastRemoteSnapshotVersion=ho.min(),this.highestTargetId=0,this.oi=0,this._i=new ah,this.targetCount=0,this.ai=Gd.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),Eo.resolve()}getLastRemoteSnapshotVersion(e){return Eo.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Eo.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Eo.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),Eo.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Gd(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Eo.resolve()}updateTargetData(e,t){return this.Pr(t),Eo.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Eo.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.si.forEach((s,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.si.delete(s),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),Eo.waitFor(i).next(()=>r)}getTargetCount(e){return Eo.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return Eo.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),Eo.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),Eo.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Eo.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return Eo.resolve(n)}containsKey(e,t){return Eo.resolve(this._i.containsKey(t))}}class hh{constructor(e,t){this.ui={},this.overlays={},this.ci=new Io(0),this.li=!1,this.li=!0,this.hi=new sh,this.referenceDelegate=e(this),this.Pi=new dh(this),this.indexManager=new Vd,this.remoteDocumentCache=function(e){return new ch(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new Md(t),this.Ii=new rh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ih,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new lh(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){wa("MemoryPersistence","Starting transaction:",e);const r=new fh(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return Eo.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class fh extends bo{constructor(e){super(),this.currentSequenceNumber=e}}class ph{constructor(e){this.persistence=e,this.Ri=new ah,this.Vi=null}static mi(e){return new ph(e)}get fi(){if(this.Vi)return this.Vi;throw Ia(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),Eo.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),Eo.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Eo.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Eo.forEach(this.fi,n=>{const r=$a.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,ho.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Eo.or([()=>Eo.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class mh{constructor(e,t){this.persistence=e,this.pi=new Wc(e=>Ro(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=$d(this,t)}static mi(e,t){return new mh(e,t)}Ei(){}di(e){return Eo.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return Eo.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?Eo.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,i.removeEntry(r,ho.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Eo.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Eo.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Eo.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Eo.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Vl(e.data.value)),t}br(e,t,n){return Eo.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return Eo.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class gh{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=tu(),r=tu();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new gh(e,t.fromCache,n,r)}}class yh{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class vh{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=Ve()?8:So(Ue())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ys(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ws(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new yh;return this.Ss(e,t,n).next(r=>{if(i.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>i.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(ba()<=st.DEBUG&&wa("QueryEngine","SDK will not create cache indexes for query:",Uc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Eo.resolve()):(ba()<=st.DEBUG&&wa("QueryEngine","Query:",Uc(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(ba()<=st.DEBUG&&wa("QueryEngine","The SDK decides to create cache indexes for query:",Uc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Dc(t))):Eo.resolve())}ys(e,t){if(xc(t))return Eo.resolve(null);let n=Dc(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=jc(t,null,"F"),n=Dc(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=tu(...r);return this.ps.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.Ds(t,r);return this.Cs(t,s,i,n.readTime)?this.ys(e,jc(t,null,"F")):this.vs(e,s,t,n)}))})))}ws(e,t,n,r){return xc(t)||r.isEqual(ho.min())?Eo.resolve(null):this.ps.getDocuments(e,n).next(i=>{const s=this.Ds(t,i);return this.Cs(t,s,n,r)?Eo.resolve(null):(ba()<=st.DEBUG&&wa("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Uc(t)),this.vs(e,s,t,mo(r,fo)).next(e=>e))})}Ds(e,t){let n=new cl(zc(e));return t.forEach((t,r)=>{Bc(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return ba()<=st.DEBUG&&wa("QueryEngine","Using full collection scan to execute query:",Uc(t)),this.ps.getDocumentsMatchingQuery(e,t,yo.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const _h="LocalStore";class bh{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new al(za),this.xs=new Wc(e=>Tc(e),Ic),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nh(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function wh(e,t,n,r){return new bh(e,t,n,r)}async function Eh(e,t){const n=Aa(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let a=tu();for(const e of r){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return n.localDocuments.getDocuments(e,a).next(e=>({Ls:e,removedBatchIds:i,addedBatchIds:s}))})})}function Sh(e){const t=Aa(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function Th(e,t,n){let r=tu(),i=tu();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=Gc();return n.forEach((n,s)=>{const a=e.get(n);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(ho.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):wa(_h,"Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),{ks:r,qs:i}})}function Ih(e,t){const n=Aa(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=ko),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function kh(e,t){const n=Aa(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(i=>i?(r=i,Eo.resolve(r)):n.Pi.allocateTargetId(e).next(i=>(r=new Fd(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}async function Ch(e,t,n){const r=Aa(e),i=r.Ms.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!To(e))throw e;wa(_h,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.Ms=r.Ms.remove(t),r.xs.delete(i.target)}function Ah(e,t,n){const r=Aa(e);let i=ho.min(),s=tu();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=Aa(e),i=r.xs.get(n);return void 0!==i?Eo.resolve(r.Ms.get(i)):r.Pi.getTargetData(t,n)}(r,e,Dc(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?i:ho.min(),n?s:tu())).next(e=>(Nh(r,Vc(t),e),{documents:e,Qs:s})))}function Nh(e,t,n){let r=e.Os.get(t)||ho.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}class xh{constructor(){this.activeTargetIds=ru()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Rh{constructor(){this.Mo=new xh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new xh,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Ph{Oo(e){}shutdown(){}}const Dh="ConnectivityMonitor";class Lh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){wa(Dh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){wa(Dh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Oh=null;function jh(){return null===Oh?Oh=268435456+Math.round(2147483648*Math.random()):Oh++,"0x"+Oh.toString(16)}const Fh="RestConnection",Mh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Uh{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko="projects/".concat(n,"/databases/").concat(r),this.Wo=this.databaseId.database===kl?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Go(e,t,n,r,i){const s=jh(),a=this.zo(e,t.toUriEncodedString());wa(Fh,"Sending RPC '".concat(e,"' ").concat(s,":"),a,n);const o={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(o,r,i);const{host:l}=new URL(a),c=Le(l);return this.Jo(e,a,o,n,c).then(t=>(wa(Fh,"Received RPC '".concat(e,"' ").concat(s,": "),t),t),t=>{throw Sa(Fh,"RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",a,"request:",n),t})}Ho(e,t,n,r,i,s){return this.Go(e,t,n,r,i)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+va,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=Mh[e];return"".concat(this.Uo,"/v1/").concat(t,":").concat(n)}terminate(){}}class Bh{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Vh="WebChannelConnection";class zh extends Uh{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){const s=jh();return new Promise((i,a)=>{const o=new sa;o.setWithCredentials(!0),o.listenOnce(oa.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case la.NO_ERROR:const n=o.getResponseJson();wa(Vh,"XHR for RPC '".concat(e,"' ").concat(s," received:"),JSON.stringify(n)),i(n);break;case la.TIMEOUT:wa(Vh,"RPC '".concat(e,"' ").concat(s," timed out")),a(new xa(Na.DEADLINE_EXCEEDED,"Request time out"));break;case la.HTTP_ERROR:const r=o.getStatus();if(wa(Vh,"RPC '".concat(e,"' ").concat(s," failed with status:"),r,"response text:",o.getResponseText()),r>0){var t;let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const n=null===(t=e)||void 0===t?void 0:t.error;if(n&&n.status&&n.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Na).indexOf(t)>=0?t:Na.UNKNOWN}(n.status);a(new xa(e,n.message))}else a(new xa(Na.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new xa(Na.UNAVAILABLE,"Connection failed."));break;default:Ia(9055,{l_:e,streamId:s,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{wa(Vh,"RPC '".concat(e,"' ").concat(s," completed."))}});const l=JSON.stringify(r);wa(Vh,"RPC '".concat(e,"' ").concat(s," sending request:"),r),o.send(t,"POST",l,n,15)})}T_(e,t,n){const r=jh(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=ha(),a=da(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.jo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=i.join("");wa(Vh,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),o);const u=s.createWebChannel(c,o);this.I_(u);let d=!1,h=!1;const f=new Bh({Yo:t=>{h?wa(Vh,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(d||(wa(Vh,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),d=!0),wa(Vh,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},Zo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,aa.EventType.OPEN,()=>{h||(wa(Vh,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),f.o_())}),p(u,aa.EventType.CLOSE,()=>{h||(h=!0,wa(Vh,"RPC '".concat(e,"' stream ").concat(r," transport closed")),f.a_(),this.E_(u))}),p(u,aa.EventType.ERROR,t=>{h||(h=!0,Sa(Vh,"RPC '".concat(e,"' stream ").concat(r," transport errored. Name:"),t.name,"Message:",t.message),f.a_(new xa(Na.UNAVAILABLE,"The operation could not be completed")))}),p(u,aa.EventType.MESSAGE,t=>{if(!h){var n;const i=t.data[0];Ca(!!i,16349);const s=i,a=(null===s||void 0===s?void 0:s.error)||(null===(n=s[0])||void 0===n?void 0:n.error);if(a){wa(Vh,"RPC '".concat(e,"' stream ").concat(r," received error:"),a);const t=a.status;let n=function(e){const t=Uu[e];if(void 0!==t)return zu(t)}(t),i=a.message;void 0===n&&(n=Na.INTERNAL,i="Unknown error status: "+t+" with message "+a.message),h=!0,f.a_(new xa(n,i)),u.close()}else wa(Vh,"RPC '".concat(e,"' stream ").concat(r," received:"),i),f.u_(i)}}),p(a,ua.STAT_EVENT,t=>{t.stat===ca.PROXY?wa(Vh,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===ca.NOPROXY&&wa(Vh,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{f.__()},0),f}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Hh(){return"undefined"!=typeof document?document:null}function Wh(e){return new ld(e,!0)}class qh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&wa("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.V_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Gh="PersistentStream";class Kh{constructor(e,t,n,r,i,s,a,o){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new qh(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===Na.RESOURCE_EXHAUSTED?(Ea(t.toString()),Ea("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Na.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.D_===t&&this.G_(n,r)},t=>{e(()=>{const e=new xa(Na.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return wa(Gh,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(wa(Gh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Jh extends Kh{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Ia(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(Ca(void 0===t||"string"==typeof t,58123),fl.fromBase64String(t||"")):(Ca(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),fl.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(e){const t=void 0===e.code?Na.UNKNOWN:zu(e.code);return new xa(t,e.message||"")}(a);n=new ed(r,i,s,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=vd(e,r.document.name),s=fd(r.document.updateTime),a=r.document.createTime?fd(r.document.createTime):ho.min(),o=new Xl({mapValue:{fields:r.document.fields}}),l=$l.newFoundDocument(i,s,a,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Zu(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=vd(e,r.document),s=r.readTime?fd(r.readTime):ho.min(),a=$l.newNoDocument(i,s),o=r.removedTargetIds||[];n=new Zu([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=vd(e,r.document),s=r.removedTargetIds||[];n=new Zu([],s,i,null)}else{if(!("filter"in t))return Ia(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new Mu(r,i),a=e.targetId;n=new $u(a,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return ho.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?ho.min():t.readTime?fd(t.readTime):ho.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=wd(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=kc(r)?{documents:Id(e,r)}:{query:kd(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=dd(e,t.resumeToken);const r=cd(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(ho.min())>0){n.readTime=ud(e,t.snapshotVersion.toTimestamp());const r=cd(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ia(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=wd(this.serializer),t.removeTarget=e,this.q_(t)}}class Qh extends Kh{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ca(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ca(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){Ca(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(Ca(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?fd(e.updateTime):fd(t);return n.isEqual(ho.min())&&(n=fd(t)),new _u(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=fd(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=wd(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Td(this.serializer,e))};this.q_(t)}}class Yh{}class Xh extends Yh{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new xa(Na.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,a]=i;return this.connection.Go(e,md(t,n),r,s,a)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===Na.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new xa(Na.UNKNOWN,e.toString())})}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[a,o]=s;return this.connection.Ho(e,md(t,n),r,a,o,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===Na.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new xa(Na.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Zh{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.aa?(Ea(t),this.aa=!1):wa("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const $h="RemoteStore";class ef{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{uf(this)&&(wa($h,"Restarting streams for network reachability change."),await async function(e){const t=Aa(e);t.Ea.add(4),await nf(t),t.Ra.set("Unknown"),t.Ea.delete(4),await tf(t)}(this))})}),this.Ra=new Zh(n,r)}}async function tf(e){if(uf(e))for(const t of e.da)await t(!0)}async function nf(e){for(const t of e.da)await t(!1)}function rf(e,t){const n=Aa(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),cf(n)?lf(n):Nf(n).O_()&&af(n,t))}function sf(e,t){const n=Aa(e),r=Nf(n);n.Ia.delete(t),r.O_()&&of(n,t),0===n.Ia.size&&(r.O_()?r.L_():uf(n)&&n.Ra.set("Unknown"))}function af(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ho.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Nf(e).Y_(t)}function of(e,t){e.Va.Ue(t),Nf(e).Z_(t)}function lf(e){e.Va=new nd({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Nf(e).start(),e.Ra.ua()}function cf(e){return uf(e)&&!Nf(e).x_()&&e.Ia.size>0}function uf(e){return 0===Aa(e).Ea.size}function df(e){e.Va=void 0}async function hf(e){e.Ra.set("Online")}async function ff(e){e.Ia.forEach((t,n)=>{af(e,t)})}async function pf(e,t){df(e),cf(e)?(e.Ra.ha(t),lf(e)):e.Ra.set("Unknown")}async function mf(e,t,n){if(e.Ra.set("Online"),t instanceof ed&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){wa($h,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await gf(e,n)}else if(t instanceof Zu?e.Va.Ze(t):t instanceof $u?e.Va.st(t):e.Va.tt(t),!n.isEqual(ho.min()))try{const t=await Sh(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Ia.get(r);i&&e.Ia.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(fl.EMPTY_BYTE_STRING,r.snapshotVersion)),of(e,t);const i=new Fd(r.target,t,n,r.sequenceNumber);af(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){wa($h,"Failed to raise snapshot:",t),await gf(e,t)}}async function gf(e,t,n){if(!To(t))throw t;e.Ea.add(1),await nf(e),e.Ra.set("Offline"),n||(n=()=>Sh(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{wa($h,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await tf(e)})}function yf(e,t){return t().catch(n=>gf(e,n,t))}async function vf(e){const t=Aa(e),n=xf(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:ko;for(;_f(t);)try{const e=await Ih(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,bf(t,e)}catch(e){await gf(t,e)}wf(t)&&Ef(t)}function _f(e){return uf(e)&&e.Ta.length<10}function bf(e,t){e.Ta.push(t);const n=xf(e);n.O_()&&n.X_&&n.ea(t.mutations)}function wf(e){return uf(e)&&!xf(e).x_()&&e.Ta.length>0}function Ef(e){xf(e).start()}async function Sf(e){xf(e).ra()}async function Tf(e){const t=xf(e);for(const n of e.Ta)t.ea(n.mutations)}async function If(e,t,n){const r=e.Ta.shift(),i=ju.from(r,t,n);await yf(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await vf(e)}async function kf(e,t){t&&xf(e).X_&&await async function(e,t){if(function(e){return Vu(e)&&e!==Na.ABORTED}(t.code)){const n=e.Ta.shift();xf(e).B_(),await yf(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await vf(e)}}(e,t),wf(e)&&Ef(e)}async function Cf(e,t){const n=Aa(e);n.asyncQueue.verifyOperationInProgress(),wa($h,"RemoteStore received new credentials");const r=uf(n);n.Ea.add(3),await nf(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await tf(n)}async function Af(e,t){const n=Aa(e);t?(n.Ea.delete(2),await tf(n)):t||(n.Ea.add(2),await nf(n),n.Ra.set("Unknown"))}function Nf(e){return e.ma||(e.ma=function(e,t,n){const r=Aa(e);return r.sa(),new Jh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:hf.bind(null,e),t_:ff.bind(null,e),r_:pf.bind(null,e),H_:mf.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),cf(e)?lf(e):e.Ra.set("Unknown")):(await e.ma.stop(),df(e))})),e.ma}function xf(e){return e.fa||(e.fa=function(e,t,n){const r=Aa(e);return r.sa(),new Qh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Sf.bind(null,e),r_:kf.bind(null,e),ta:Tf.bind(null,e),na:If.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await vf(e)):(await e.fa.stop(),e.Ta.length>0&&(wa($h,"Stopping write stream with ".concat(e.Ta.length," pending writes")),e.Ta=[]))})),e.fa}class Rf{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Ra,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,a=new Rf(e,t,s,r,i);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new xa(Na.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pf(e,t){if(Ea("AsyncQueue","".concat(t,": ").concat(e)),To(e))return new xa(Na.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Df{static emptySet(e){return new Df(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||$a.comparator(t.key,n.key):(e,t)=>$a.comparator(e.key,t.key),this.keyedMap=Jc(),this.sortedSet=new al(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Df))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Df;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Lf{constructor(){this.ga=new al($a.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ia(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class Of{constructor(e,t,n,r,i,s,a,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new Of(e,t,Df.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Fc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class jf{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Ff{constructor(){this.queries=Mf(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=Aa(e),r=n.queries;n.queries=Mf(),r.forEach((e,n)=>{for(const r of n.Sa)r.onError(t)})}(this,new xa(Na.ABORTED,"Firestore shutting down"))}}function Mf(){return new Wc(e=>Mc(e),Fc)}async function Uf(e,t){const n=Aa(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.ba()&&t.Da()&&(r=2):(s=new jf,r=t.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=Pf(e,"Initialization of query '".concat(Uc(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,s),s.Sa.push(t),t.va(n.onlineState),s.wa&&t.Fa(s.wa)&&Hf(n)}async function Bf(e,t){const n=Aa(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.Sa.indexOf(t);e>=0&&(s.Sa.splice(e,1),0===s.Sa.length?i=t.Da()?0:1:!s.ba()&&t.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Vf(e,t){const n=Aa(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(i)&&(r=!0);t.wa=i}}r&&Hf(n)}function zf(e,t,n){const r=Aa(e),i=r.queries.get(t);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(t)}function Hf(e){e.Ca.forEach(e=>{e.next()})}var Wf,qf;(qf=Wf||(Wf={})).Ma="default",qf.Cache="cache";class Gf{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Of(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=Of.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Wf.Cache}}class Kf{constructor(e){this.key=e}}class Jf{constructor(e){this.key=e}}class Qf{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=tu(),this.mutatedKeys=tu(),this.eu=zc(e),this.tu=new Df(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new Lf,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=Bc(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.su(c,u)||(n.track({type:2,doc:u}),f=!0,(o&&this.eu(u,o)>0||l&&this.eu(u,l)<0)&&(a=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(o||l)&&(a=!0)),f&&(u?(s=s.add(u),i=h?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{tu:s,iu:n,Cs:a,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ia(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=null!==r&&void 0!==r&&r;const a=t&&!r?this._u():[],o=0===this.Xa.size&&this.current&&!r?1:0,l=o!==this.Za;return this.Za=o,0!==s.length||l?{snapshot:new Of(this.query,e.tu,i,s,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Lf,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=tu(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new Jf(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new Kf(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=tu();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Of.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const Yf="SyncEngine";class Xf{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Zf{constructor(e){this.key=e,this.hu=!1}}class $f{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Wc(e=>Mc(e),Fc),this.Iu=new Map,this.Eu=new Set,this.du=new al($a.comparator),this.Au=new Map,this.Ru=new ah,this.Vu={},this.mu=new Map,this.fu=Gd.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function ep(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=wp(e);let i;const s=r.Tu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await np(r,t,n,!0),i}async function tp(e,t){const n=wp(e);await np(n,t,!0,!1)}async function np(e,t,n,r){const i=await kh(e.localStore,Dc(t)),s=i.targetId,a=e.sharedClientState.addLocalQueryTarget(s,n);let o;return r&&(o=await rp(e,t,s,"current"===a,i.resumeToken)),e.isPrimaryClient&&n&&rf(e.remoteStore,i),o}async function rp(e,t,n,r,i){e.pu=(t,n,r)=>async function(e,t,n,r){let i=t.view.ru(n);i.Cs&&(i=await Ah(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ru(n,i)}));const s=r&&r.targetChanges.get(t.targetId),a=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s,a);return mp(e,t.targetId,o.au),o.snapshot}(e,t,n,r);const s=await Ah(e.localStore,t,!0),a=new Qf(t,s.Qs),o=a.ru(s.documents),l=Xu.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=a.applyChanges(o,e.isPrimaryClient,l);mp(e,n,c.au);const u=new Xf(t,n,a);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),c.snapshot}async function ip(e,t,n){const r=Aa(e),i=r.Tu.get(t),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(e=>!Fc(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ch(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&sf(r.remoteStore,i.targetId),fp(r,i.targetId)}).catch(wo)):(fp(r,i.targetId),await Ch(r.localStore,i.targetId,!0))}async function sp(e,t){const n=Aa(e),r=n.Tu.get(t),i=n.Iu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),sf(n.remoteStore,r.targetId))}async function ap(e,t){const n=Aa(e);try{const e=await function(e,t){const n=Aa(e),r=t.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];t.targetChanges.forEach((s,o)=>{const l=i.get(o);if(!l)return;a.push(n.Pi.removeMatchingKeys(e,s.removedDocuments,o).next(()=>n.Pi.addMatchingKeys(e,s.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(fl.EMPTY_BYTE_STRING,ho.min()).withLastLimboFreeSnapshotVersion(ho.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,s)&&a.push(n.Pi.updateTargetData(e,c))});let o=Gc(),l=tu();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),a.push(Th(e,s,t.documentUpdates).next(e=>{o=e.ks,l=e.qs})),!r.isEqual(ho.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));a.push(t)}return Eo.waitFor(a).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(n.Ms=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&(Ca(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?Ca(r.hu,14607):e.removedDocuments.size>0&&(Ca(r.hu,42227),r.hu=!1))}),await vp(n,e,t)}catch(e){await wo(e)}}function op(e,t,n){const r=Aa(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const i=r.view.va(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=Aa(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.Sa)i.va(t)&&(r=!0)}),r&&Hf(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function lp(e,t,n){const r=Aa(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Au.get(t),s=i&&i.key;if(s){let e=new al($a.comparator);e=e.insert(s,$l.newNoDocument(s,ho.min()));const n=tu().add(s),i=new Yu(ho.min(),new Map,new al(za),e,n);await ap(r,i),r.du=r.du.remove(s),r.Au.delete(t),yp(r)}else await Ch(r.localStore,t,!1).then(()=>fp(r,t,n)).catch(wo)}async function cp(e,t){const n=Aa(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Aa(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let a=Eo.resolve();return s.forEach(e=>{a=a.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);Ca(null!==s,48541),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=tu();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);hp(n,r,null),dp(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await vp(n,e)}catch(e){await wo(e)}}async function up(e,t,n){const r=Aa(e);try{const e=await function(e,t){const n=Aa(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(Ca(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);hp(r,t,n),dp(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await vp(r,e)}catch(n){await wo(n)}}function dp(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function hp(e,t,n){const r=Aa(e);let i=r.Vu[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Vu[r.currentUser.toKey()]=i}}function fp(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||pp(e,t)})}function pp(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(sf(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),yp(e))}function mp(e,t,n){for(const r of n)r instanceof Kf?(e.Ru.addReference(r.key,t),gp(e,r)):r instanceof Jf?(wa(Yf,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||pp(e,r.key)):Ia(19791,{wu:r})}function gp(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(wa(Yf,"New document in limbo: "+n),e.Eu.add(r),yp(e))}function yp(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new $a(Ya.fromString(t)),r=e.fu.next();e.Au.set(r,new Zf(n)),e.du=e.du.insert(n,r),rf(e.remoteStore,new Fd(Dc(Nc(n.path)),r,"TargetPurposeLimboResolution",Io.ce))}}async function vp(e,t,n){const r=Aa(e),i=[],s=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((e,o)=>{a.push(r.pu(o,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){var t;const i=e?!e.fromCache:null===n||void 0===n||null===(t=n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,i?"current":"not-current")}if(e){i.push(e);const t=gh.As(o.targetId,e);s.push(t)}}))}),await Promise.all(a),r.Pu.H_(i),await async function(e,t){const n=Aa(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Eo.forEach(t,t=>Eo.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Eo.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!To(e))throw e;wa(_h,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,i)}}}(r.localStore,s))}async function _p(e,t){const n=Aa(e);if(!n.currentUser.isEqual(t)){wa(Yf,"User change. New user:",t.toKey());const e=await Eh(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new xa(Na.CANCELLED,t))})}),e.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await vp(n,e.Ls)}}function bp(e,t){const n=Aa(e),r=n.Au.get(t);if(r&&r.hu)return tu().add(r.key);{let e=tu();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function wp(e){const t=Aa(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=ap.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=bp.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=lp.bind(null,t),t.Pu.H_=Vf.bind(null,t.eventManager),t.Pu.yu=zf.bind(null,t.eventManager),t}function Ep(e){const t=Aa(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=cp.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=up.bind(null,t),t}class Sp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Wh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return wh(this.persistence,new vh,e.initialUser,this.serializer)}Cu(e){return new hh(ph.mi,this.serializer)}Du(e){return new Rh}async terminate(){var e,t;null!==(e=this.gcScheduler)&&void 0!==e&&e.stop(),null!==(t=this.indexBackfillerScheduler)&&void 0!==t&&t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Sp.provider={build:()=>new Sp};class Tp extends Sp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ca(this.persistence.referenceDelegate instanceof mh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Xd(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?qd.withCacheSize(this.cacheSizeBytes):qd.DEFAULT;return new hh(e=>mh.mi(e,t),this.serializer)}}class Ip{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>op(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=_p.bind(null,this.syncEngine),await Af(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Ff}createDatastore(e){const t=Wh(e.databaseInfo.databaseId),n=function(e){return new zh(e)}(e.databaseInfo);return function(e,t,n,r){return new Xh(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new ef(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>op(this.syncEngine,e,0),Lh.v()?new Lh:new Ph)}createSyncEngine(e,t){return function(e,t,n,r,i,s,a){const o=new $f(e,t,n,r,i,s);return a&&(o.gu=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Aa(e);wa($h,"RemoteStore shutting down."),t.Ea.add(5),await nf(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),null!==(e=this.datastore)&&void 0!==e&&e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Ip.provider={build:()=>new Ip};class kp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ea("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const Cp="FirestoreClient";class Ap{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=ya.UNAUTHENTICATED,this.clientId=Va.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{wa(Cp,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(wa(Cp,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ra;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Pf(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Np(e,t){e.asyncQueue.verifyOperationInProgress(),wa(Cp,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Eh(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function xp(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Rp(e);wa(Cp,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Cf(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Cf(t.remoteStore,n)),e._onlineComponents=t}async function Rp(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){wa(Cp,"Using user provided OfflineComponentProvider");try{await Np(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Na.FAILED_PRECONDITION||e.code===Na.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Sa("Error using user provided cache. Falling back to memory cache: "+n),await Np(e,new Sp)}}else wa(Cp,"Using default OfflineComponentProvider"),await Np(e,new Tp(void 0));return e._offlineComponents}async function Pp(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(wa(Cp,"Using user provided OnlineComponentProvider"),await xp(e,e._uninitializedComponentsProvider._online)):(wa(Cp,"Using default OnlineComponentProvider"),await xp(e,new Ip))),e._onlineComponents}function Dp(e){return Pp(e).then(e=>e.syncEngine)}async function Lp(e){const t=await Pp(e),n=t.eventManager;return n.onListen=ep.bind(null,t.syncEngine),n.onUnlisten=ip.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=tp.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=sp.bind(null,t.syncEngine),n}function Op(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Ra;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new kp({next:o=>{s.Nu(),t.enqueueAndForget(()=>Bf(e,a));const l=o.docs.has(n);!l&&o.fromCache?i.reject(new xa(Na.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&r&&"server"===r.source?i.reject(new xa(Na.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:e=>i.reject(e)}),a=new Gf(Nc(n.path),s,{includeMetadataChanges:!0,qa:!0});return Uf(e,a)}(await Lp(e),e.asyncQueue,t,n,r)),r.promise}function jp(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Ra;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new kp({next:n=>{s.Nu(),t.enqueueAndForget(()=>Bf(e,a)),n.fromCache&&"server"===r.source?i.reject(new xa(Na.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),a=new Gf(n,s,{includeMetadataChanges:!0,qa:!0});return Uf(e,a)}(await Lp(e),e.asyncQueue,t,n,r)),r.promise}function Fp(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Mp=new Map,Up="firestore.googleapis.com",Bp=!0;class Vp{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new xa(Na.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Up,this.ssl=Bp}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:Bp;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Wd;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<Jd)throw new xa(Na.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new xa(Na.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Fp(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new xa(Na.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new xa(Na.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new xa(Na.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class zp{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Vp({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new xa(Na.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new xa(Na.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Vp(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Da;switch(e.type){case"firstParty":return new Fa(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new xa(Na.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Mp.get(e);t&&(wa("ComponentProvider","Removing Datastore"),Mp.delete(e),t.terminate())}(this),Promise.resolve()}}function Hp(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=so(e,zp);const i=Le(t),s=e._getSettings(),a=c(c({},s),{},{emulatorOptions:e._getEmulatorOptions()}),o="".concat(t,":").concat(n);i&&(Oe("https://".concat(o)),Me("Firestore",!0)),s.host!==Up&&s.host!==o&&Sa("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=c(c({},s),{},{host:o,ssl:i,emulatorOptions:r});if(!Ge(l,a)&&(e._setSettings(l),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=ya.MOCK_USER;else{var u;t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=c({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[ke(JSON.stringify({alg:"none",type:"JWT"})),ke(JSON.stringify(s)),""].join(".")}(r.mockUserToken,null===(u=e._app)||void 0===u?void 0:u.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new xa(Na.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new ya(i)}e._authCredentials=new La(new Pa(t,n))}}class Wp{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Wp(this.firestore,e,this._query)}}class qp{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Gp(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new qp(this.firestore,e,this._key)}toJSON(){return{type:qp._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(oo(t,qp._jsonSchema))return new qp(e,n||null,new $a(Ya.fromString(t.referencePath)))}}qp._jsonSchemaVersion="firestore/documentReference/1.0",qp._jsonSchema={type:ao("string",qp._jsonSchemaVersion),referencePath:ao("string")};class Gp extends Wp{constructor(e,t,n){super(e,t,Nc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new qp(this.firestore,null,new $a(e))}withConverter(e){return new Gp(this.firestore,e,this._path)}}function Kp(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=$e(e),eo("collection","path",t),e instanceof zp){const n=Ya.fromString(t,...r);return no(n),new Gp(e,null,n)}{if(!(e instanceof qp||e instanceof Gp))throw new xa(Na.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ya.fromString(t,...r));return no(n),new Gp(e.firestore,null,n)}}function Jp(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=$e(e),1===arguments.length&&(t=Va.newId()),eo("doc","path",t),e instanceof zp){const n=Ya.fromString(t,...r);return to(n),new qp(e,null,new $a(n))}{if(!(e instanceof qp||e instanceof Gp))throw new xa(Na.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ya.fromString(t,...r));return to(n),new qp(e.firestore,e instanceof Gp?e.converter:null,new $a(n))}}const Qp="AsyncQueue";class Yp{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new qh(this,"async_queue_retry"),this._c=()=>{const e=Hh();e&&wa(Qp,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=Hh();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Hh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new Ra;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!To(e))throw e;wa(Qp,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,Ea("INTERNAL UNHANDLED ERROR: ",Xp(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Rf.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&Ia(47125,{Pc:Xp(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Xp(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function Zp(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class $p extends zp{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Yp,this._persistenceKey=(null===r||void 0===r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Yp(e),this._firestoreClient=void 0,await e}}}function em(e,t){const n="object"==typeof e?e:yn(),r="string"==typeof e?e:t||kl,i=dn(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=(e=>{const t=xe(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&Hp(i,...e)}return i}function tm(e){if(e._terminated)throw new xa(Na.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||nm(e),e._firestoreClient}function nm(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new Il(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Fp(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||null!==(n=i.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new Ap(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null===e||void 0===e?void 0:e._online.build();return{_offline:null===e||void 0===e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class rm{constructor(e){this._byteString=e}static fromBase64String(e){try{return new rm(fl.fromBase64String(e))}catch(e){throw new xa(Na.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new rm(fl.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:rm._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(oo(e,rm._jsonSchema))return rm.fromBase64String(e.bytes)}}rm._jsonSchemaVersion="firestore/bytes/1.0",rm._jsonSchema={type:ao("string",rm._jsonSchemaVersion),bytes:ao("string")};class im{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new xa(Na.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Za(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class sm{constructor(e){this._methodName=e}}class am{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new xa(Na.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new xa(Na.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return za(this._lat,e._lat)||za(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:am._jsonSchemaVersion}}static fromJSON(e){if(oo(e,am._jsonSchema))return new am(e.latitude,e.longitude)}}am._jsonSchemaVersion="firestore/geoPoint/1.0",am._jsonSchema={type:ao("string",am._jsonSchemaVersion),latitude:ao("number"),longitude:ao("number")};class om{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:om._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(oo(e,om._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new om(e.vectorValues);throw new xa(Na.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}om._jsonSchemaVersion="firestore/vectorValue/1.0",om._jsonSchema={type:ao("string",om._jsonSchemaVersion),vectorValues:ao("object")};const lm=/^__.*__$/;class cm{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Nu(e,this.data,this.fieldMask,t,this.fieldTransforms):new Au(e,this.data,t,this.fieldTransforms)}}function um(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ia(40011,{Ac:e})}}class dm{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new dm(c(c({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Sm(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(um(this.Ac)&&lm.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class hm{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Wh(e)}Cc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new dm({Ac:e,methodName:t,Dc:n,path:Za.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fm(e){const t=e._freezeSettings(),n=Wh(e._databaseId);return new hm(e._databaseId,!!t.ignoreUndefinedProperties,n)}function pm(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=e.Cc(s.merge||s.mergeFields?2:0,t,n,i);_m("Data must be an object, but it was:",a,r);const o=ym(r,a);let l,c;if(s.merge)l=new dl(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=bm(t,r,n);if(!a.contains(i))throw new xa(Na.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));Tm(e,i)||e.push(i)}l=new dl(e),c=a.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=a.fieldTransforms;return new cm(new Xl(o),l,c)}function mm(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return gm(n,e.Cc(r?4:3,t))}function gm(e,t){if(vm(e=$e(e)))return _m("Unsupported field value:",t,e),ym(e,t);if(e instanceof sm)return function(e,t){if(!um(t.Ac))throw t.Sc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Sc("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=gm(i,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=$e(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return au(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=uo.fromDate(e);return{timestampValue:ud(t.serializer,n)}}if(e instanceof uo){const n=new uo(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ud(t.serializer,n)}}if(e instanceof am)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof rm)return{bytesValue:dd(t.serializer,e._byteString)};if(e instanceof qp){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:pd(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof om)return function(e,t){return{mapValue:{fields:{[Al]:{stringValue:Rl},[Pl]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return iu(t.serializer,e)})}}}}}}(e,t);throw t.Sc("Unsupported field value: ".concat(io(e)))}(e,t)}function ym(e,t){const n={};return sl(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):il(e,(e,r)=>{const i=gm(r,t.mc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function vm(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof uo||e instanceof am||e instanceof rm||e instanceof qp||e instanceof sm||e instanceof om)}function _m(e,t,n){if(!vm(n)||!ro(n)){const r=io(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function bm(e,t,n){if((t=$e(t))instanceof im)return t._internalPath;if("string"==typeof t)return Em(e,t);throw Sm("Field path arguments must be of type string or ",e,!1,void 0,n)}const wm=new RegExp("[~\\*/\\[\\]]");function Em(e,t,n){if(t.search(wm)>=0)throw Sm("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new im(...t.split("."))._internalPath}catch(r){throw Sm("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Sm(e,t,n,r,i){const s=r&&!r.isEmpty(),a=void 0!==i;let o="Function ".concat(t,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=" in field ".concat(r)),a&&(l+=" in document ".concat(i)),l+=")"),new xa(Na.INVALID_ARGUMENT,o+e+l)}function Tm(e,t){return e.some(e=>e.isEqual(t))}class Im{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new qp(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new km(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Cm("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class km extends Im{data(){return super.data()}}function Cm(e,t){return"string"==typeof t?Em(e,t):t instanceof im?t._internalPath:t._delegate._internalPath}function Am(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new xa(Na.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Nm{}class xm extends Nm{}function Rm(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof Nm&&n.push(t),n=n.concat(i),function(e){const t=e.filter(e=>e instanceof Dm).length,n=e.filter(e=>e instanceof Pm).length;if(t>1||t>0&&n>0)throw new xa(Na.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)e=a._apply(e);return e}class Pm extends xm{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Pm(e,t,n)}_apply(e){const t=this._parse(e);return jm(e._query,t),new Wp(e.firestore,e.converter,Oc(e._query,t))}_parse(e){const t=fm(e.firestore),n=function(e,t,n,r,i,s,a){let o;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new xa(Na.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){Om(a,s);const t=[];for(const n of a)t.push(Lm(r,e,n));o={arrayValue:{values:t}}}else o=Lm(r,e,a)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Om(a,s),o=mm(n,t,a,"in"===s||"not-in"===s);return ac.create(i,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class Dm extends Nm{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Dm(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:oc.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)jm(n,i),n=Oc(n,i)}(e._query,t),new Wp(e.firestore,e.converter,Oc(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function Lm(e,t,n){if("string"==typeof(n=$e(n))){if(""===n)throw new xa(Na.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rc(t)&&-1!==n.indexOf("/"))throw new xa(Na.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(Ya.fromString(n));if(!$a.isDocumentKey(r))throw new xa(Na.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return zl(e,new $a(r))}if(n instanceof qp)return zl(e,n._key);throw new xa(Na.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(io(n),"."))}function Om(e,t){if(!Array.isArray(e)||0===e.length)throw new xa(Na.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function jm(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new xa(Na.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new xa(Na.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class Fm{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Dl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gl(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(yl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ia(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return il(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t;const n=null===(t=e.fields)||void 0===t||null===(t=t[Pl].arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(e=>gl(e.doubleValue));return new om(n)}convertGeoPoint(e){return new am(gl(e.latitude),gl(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Sl(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Tl(e));default:return null}}convertTimestamp(e){const t=ml(e);return new uo(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ya.fromString(e);Ca(jd(n),9688,{name:e});const r=new Cl(n.get(1),n.get(3)),i=new $a(n.popFirst(5));return r.isEqual(t)||Ea("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function Mm(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Um{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Bm extends Im{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Vm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Cm("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new xa(Na.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Bm._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}Bm._jsonSchemaVersion="firestore/documentSnapshot/1.0",Bm._jsonSchema={type:ao("string",Bm._jsonSchemaVersion),bundleSource:ao("string","DocumentSnapshot"),bundleName:ao("string"),bundle:ao("string")};class Vm extends Bm{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class zm{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Um(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Vm(this._firestore,this._userDataWriter,n.key,n,new Um(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new xa(Na.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new Vm(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Um(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new Vm(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Um(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Hm(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new xa(Na.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=zm._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Va.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Hm(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ia(61501,{type:e})}}zm._jsonSchemaVersion="firestore/querySnapshot/1.0",zm._jsonSchema={type:ao("string",zm._jsonSchemaVersion),bundleSource:ao("string","QuerySnapshot"),bundleName:ao("string"),bundle:ao("string")};class Wm extends Fm{constructor(e){super(),this.firestore=e}convertBytes(e){return new rm(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new qp(this.firestore,null,t)}}function qm(e){e=so(e,Wp);const t=so(e.firestore,$p),n=tm(t),r=new Wm(t);return Am(e._query),jp(n,e._query).then(n=>new zm(t,r,e,n))}function Gm(e,t,n){e=so(e,qp);const r=so(e.firestore,$p),i=Mm(e.converter,t,n);return Qm(r,[pm(fm(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,bu.none())])}function Km(e){return Qm(so(e.firestore,$p),[new Du(e._key,bu.none())])}function Jm(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=$e(e);let i={includeMetadataChanges:!1,source:"default"},s=0;"object"!=typeof n[s]||Zp(n[s])||(i=n[s++]);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Zp(n[s])){var o,l,c;const e=n[s];n[s]=null===(o=e.next)||void 0===o?void 0:o.bind(e),n[s+1]=null===(l=e.error)||void 0===l?void 0:l.bind(e),n[s+2]=null===(c=e.complete)||void 0===c?void 0:c.bind(e)}let u,d,h;if(e instanceof qp)d=so(e.firestore,$p),h=Nc(e._key.path),u={next:t=>{n[s]&&n[s](Ym(d,e,t))},error:n[s+1],complete:n[s+2]};else{const t=so(e,Wp);d=so(t.firestore,$p),h=t._query;const r=new Wm(d);u={next:e=>{n[s]&&n[s](new zm(d,r,t,e))},error:n[s+1],complete:n[s+2]},Am(e._query)}return function(e,t,n,r){const i=new kp(r),s=new Gf(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>Uf(await Lp(e),s)),()=>{i.Nu(),e.asyncQueue.enqueueAndForget(async()=>Bf(await Lp(e),s))}}(tm(d),h,a,u)}function Qm(e,t){return function(e,t){const n=new Ra;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=Ep(e);try{const e=await function(e,t){const n=Aa(e),r=uo.now(),i=t.reduce((e,t)=>e.add(t.key),tu());let s,a;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=Gc(),l=tu();return n.Ns.getEntries(e,i).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,o)).next(i=>{s=i;const a=[];for(const e of t){const t=ku(e,s.get(e.key).overlayedDocument);null!=t&&a.push(new Nu(e.key,t,Zl(t.value.mapValue),bu.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,a,t)}).next(t=>{a=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:a.batchId,changes:Qc(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new al(za)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await vp(r,e.changes),await vf(r.remoteStore)}catch(e){const t=Pf(e,"Failed to persist write");n.reject(t)}}(await Dp(e),t,n)),n.promise}(tm(e),t)}function Ym(e,t,n){const r=n.docs.get(t._key),i=new Wm(e);return new Bm(e,i,t._key,r,new Um(n.hasPendingWrites,n.fromCache),t.converter)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){va=e}(mn),un(new et("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),a=new $p(new Oa(e.getProvider("auth-internal")),new Ua(s,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new xa(Na.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Cl(e.options.projectId,t)}(s,r),s);return i=c({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),vn(ma,ga,e),vn(ma,ga,"esm2020")}();let Xm=null,Zm=null,$m=null;function eg(e){var t;const n={NODE_ENV:"production",PUBLIC_URL:"/traders-mirror",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_FIREBASE:"true",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"842512285290",REACT_APP_BUILD_TAG:"",REACT_APP_BUILD_SHA:"fe8e1f7d7be3d94ffab07172b15fcd8341eda200",REACT_APP_BUILD_TIME:"2026-01-24T21:29:52Z",REACT_APP_FIREBASE_STORAGE_BUCKET:"c3s-monkey-trader.appspot.com",REACT_APP_FIREBASE_AUTH_DOMAIN:"c3s-monkey-trader.firebaseapp.com",REACT_APP_BUILD_BRANCH:"main",REACT_APP_FIRESTORE_FORCE_LONG_POLLING:"true",REACT_APP_FIREBASE_PROJECT_ID:"c3s-monkey-trader",REACT_APP_FIREBASE_APP_ID:"1:842512285290:web:c87e2c00233deaa601413",REACT_APP_FIREBASE_API_KEY:"AIzaSyAgwG2YEqpz-kf7wPKqfNKihKcBnfskzbc"}["REACT_APP_FIREBASE_".concat(e)],r=null===(t={NODE_ENV:"production"})||void 0===t?void 0:t["VITE_FIREBASE_".concat(e)];return null!==n&&void 0!==n?n:r}function tg(){if(!Xm){const n=eg("API_KEY"),r=eg("AUTH_DOMAIN"),i=eg("PROJECT_ID"),s=eg("STORAGE_BUCKET"),a=eg("MESSAGING_SENDER_ID"),o=eg("APP_ID"),l=[];if(n||l.push("API_KEY"),r||l.push("AUTH_DOMAIN"),i||l.push("PROJECT_ID"),s||l.push("STORAGE_BUCKET"),a||l.push("MESSAGING_SENDER_ID"),o||l.push("APP_ID"),l.length)throw new Error("Firebase config missing env vars: ".concat(l.join(", "),". ")+"Set REACT_APP_FIREBASE_* (CRA) or VITE_FIREBASE_* (Vite) accordingly.");Xm=gn({apiKey:n,authDomain:r,projectId:i,storageBucket:s,messagingSenderId:a,appId:o}),Zm=$s(Xm);try{Pi(Zm,Fi)}catch(e){}try{const e=function(e,t){const n=eg(e);if("string"===typeof n){const e=n.trim().toLowerCase();if("true"===e)return!0;if("false"===e)return!1}return t}("FIRESTORE_FORCE_LONG_POLLING",!0);$m=function(e,t,n){n||(n=kl);const r=dn(e,"firestore");if(r.isInitialized(n)){const e=r.getImmediate({identifier:n});if(Ge(r.getOptions(n),t))return e;throw new xa(Na.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==t.cacheSizeBytes&&void 0!==t.localCache)throw new xa(Na.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(void 0!==t.cacheSizeBytes&&-1!==t.cacheSizeBytes&&t.cacheSizeBytes<Jd)throw new xa(Na.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return t.host&&Le(t.host)&&Oe(t.host),r.initialize({options:t,instanceIdentifier:n})}(Xm,{experimentalAutoDetectLongPolling:!0,experimentalForceLongPolling:e})}catch(t){$m=em(Xm)}}return{app:Xm,auth:Zm,db:$m}}function ng(){const e=eg("API_KEY"),t=eg("AUTH_DOMAIN"),n=eg("PROJECT_ID"),r=eg("STORAGE_BUCKET"),i=eg("MESSAGING_SENDER_ID"),s=eg("APP_ID"),a=[];if(e||a.push("API_KEY"),t||a.push("AUTH_DOMAIN"),n||a.push("PROJECT_ID"),r||a.push("STORAGE_BUCKET"),i||a.push("MESSAGING_SENDER_ID"),s||a.push("APP_ID"),a.length)throw new Error("Firebase config missing env vars: ".concat(a.join(", "),". ")+"Set REACT_APP_FIREBASE_* (CRA) or VITE_FIREBASE_* (Vite) accordingly.")}function rg(){var e;const{auth:t}=tg(),n=t.currentUser;return null!==(e=null===n||void 0===n?void 0:n.uid)&&void 0!==e?e:null}class ig{async save(e){const{db:t}=tg(),n=rg();if(!n)throw new Error("Not authenticated");const r=c(c({},e),{},{userId:n}),i=e=>{if(Array.isArray(e))return e.map(e=>i(e));if(e&&"object"===typeof e){const t={};for(const[n,r]of Object.entries(e)){const e=i(r);void 0!==e&&(t[n]=e)}return t}return void 0===e?void 0:e},s=i(r);console.info("[FirebaseRepo:Analysis] save",e.id,"symbol=",e.symbol),await Gm(Jp(t,"users",n,"analyses",e.id),s)}async getById(e){const{db:t}=tg(),n=rg();if(!n)return null;console.info("[FirebaseRepo:Analysis] getById",e);const r=Jp(t,"users",n,"analyses",e),i=await function(e){e=so(e,qp);const t=so(e.firestore,$p);return Op(tm(t),e._key).then(n=>Ym(t,e,n))}(r);if(!i.exists())return null;const s=i.data();if(s.userId!==n)return null;const a=c({},s);return delete a.userId,a}async listBySymbol(e){const{db:t}=tg(),n=rg();if(!n)return[];console.info("[FirebaseRepo:Analysis] listBySymbol",e);const r=Rm(Kp(t,"users",n,"analyses"),function(e,t,n){const r=t,i=Cm("where",e);return Pm._create(i,r,n)}("symbol","==",e)),i=await qm(r);return console.info("[FirebaseRepo:Analysis] listBySymbol returned",i.size),i.docs.map(e=>{const t=c({},e.data());return delete t.userId,t})}async listAll(){const{db:e}=tg(),t=rg();if(!t)return[];console.info("[FirebaseRepo:Analysis] listAll for user",t);const n=Rm(Kp(e,"users",t,"analyses")),r=await qm(n);return console.info("[FirebaseRepo:Analysis] listAll returned",r.size),r.docs.map(e=>{const t=c({},e.data());return delete t.userId,t})}async delete(e){const{db:t}=tg(),n=rg();if(!n)throw new Error("Not authenticated");console.info("[FirebaseRepo:Analysis] delete",e),await Km(Jp(t,"users",n,"analyses",e))}async clear(){const{db:e}=tg(),t=rg();if(!t)return;console.info("[FirebaseRepo:Analysis] clear for user",t);const n=Rm(Kp(e,"users",t,"analyses")),r=await qm(n);await Promise.all(r.docs.map(e=>Km(e.ref)))}}const sg="analyses_v1";class ag{async save(e){const t=await this.listAll(),n=t.findIndex(t=>t.id===e.id);n>=0?t[n]=e:t.push(e),localStorage.setItem(sg,JSON.stringify(t));try{globalThis.dispatchEvent(new CustomEvent("analyses-updated",{detail:{type:n>=0?"updated":"created",id:e.id}}))}catch(r){}}async getById(e){var t;return null!==(t=(await this.listAll()).find(t=>t.id===e))&&void 0!==t?t:null}async listBySymbol(e){return(await this.listAll()).filter(t=>t.symbol===e)}async listAll(){try{const e=localStorage.getItem(sg);if(!e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch(e){return[]}}async clear(){localStorage.removeItem(sg)}async delete(e){const t=(await this.listAll()).filter(t=>t.id!==e);localStorage.setItem(sg,JSON.stringify(t));try{globalThis.dispatchEvent(new CustomEvent("analyses-updated",{detail:{type:"deleted",id:e}}))}catch(n){}}}class og{constructor(e,t,n,r,i,s,a,o,l,c,u,d,h,f,p,m,g,y,v,_,b,w,E,S,T){this.id=void 0,this.symbol=void 0,this.entryDate=void 0,this.size=void 0,this.price=void 0,this.side=void 0,this.status=void 0,this.notes=void 0,this.market=void 0,this.sl=void 0,this.slIsBE=void 0,this.tp1=void 0,this.tp2=void 0,this.tp3=void 0,this.tp4=void 0,this.tp1IsHit=void 0,this.tp2IsHit=void 0,this.tp3IsHit=void 0,this.tp4IsHit=void 0,this.leverage=void 0,this.margin=void 0,this.analysisId=void 0,this.userId=void 0,this.entry=void 0,this.confluence=void 0,this.id=e,this.symbol=t,this.entryDate=n,this.size=r,this.price=i,this.side=s,this.status=o,this.market=a,this.notes=l,this.sl=c,this.slIsBE=u,this.tp1=d,this.tp2=h,this.tp3=f,this.tp4=p,this.tp1IsHit=m,this.tp2IsHit=g,this.tp3IsHit=y,this.tp4IsHit=v,this.leverage=_,this.margin=b,this.analysisId=w,this.userId=E,this.entry=S,this.confluence=T}}class lg{constructor(e){if(this.value=void 0,e<=0)throw new cg(e);this.value=e}}class cg extends Error{constructor(e){super("Price must be positive: ".concat(e)),this.name="PriceMustBePositiveError"}}class ug{constructor(e){if(this.value=void 0,"number"!==typeof e||e<=0)throw new dg(e);this.value=e}}class dg extends Error{constructor(e){super("Size must be positive: ".concat(e)),this.name="SizeMustBePositiveError"}}class hg{constructor(e){if(this.value=void 0,!e||isNaN(Date.parse(e)))throw new fg(e);this.value=new Date(e).toISOString()}static toInputValue(e){const t=e?new Date(e):new Date,n=e=>String(e).padStart(2,"0"),r=t.getFullYear(),i=n(t.getMonth()+1),s=n(t.getDate()),a=n(t.getHours()),o=n(t.getMinutes());return"".concat(r,"-").concat(i,"-").concat(s,"T").concat(a,":").concat(o)}static fromInputValue(e){if(!e||isNaN(Date.parse(e)))throw new fg(e);return new Date(e).toISOString()}}class fg extends Error{constructor(e){super("Entry date invalid: ".concat(e)),this.name="EntryDateInvalidError"}}class pg{constructor(e){if(this.value=void 0,!e||"string"!==typeof e)throw new mg(e);this.value=e.trim().toUpperCase()}}class mg extends Error{constructor(e){super("Trade symbol invalid: ".concat(e)),this.name="TradeSymbolInvalidError"}}class gg{constructor(e){this.value=void 0;const t=e.trim().toUpperCase();if("LONG"!==t&&"SHORT"!==t)throw new yg(e);this.value=t}}class yg extends Error{constructor(e){super("Side must be 'LONG' or 'SHORT', got '".concat(e,"'")),this.name="SideInvalidError"}}class vg{constructor(e){this.value=void 0;const t=String(null!==e&&void 0!==e?e:"").trim();if(!t)throw new _g(t);const n=t.charAt(0).toUpperCase()+t.slice(1).toLowerCase();if("All"!==n&&"Forex"!==n&&"Crypto"!==n)throw new _g(n);this.value=n}}class _g extends Error{constructor(e){super("Market invalid: ".concat(e)),this.name="MarketInvalidError"}}class bg{constructor(e){if(this.value=void 0,void 0!==e&&null!==e){if("number"!==typeof e||Number.isNaN(e)||e<=0)throw new wg(e);this.value=e}else this.value=void 0}}class wg extends Error{constructor(e){super("Leverage must be a positive number: ".concat(e)),this.name="LeverageInvalidError"}}class Eg extends Error{constructor(e){super(e),this.name="DomainError"}}class Sg extends Eg{constructor(e){super("Margin must be positive, got: ".concat(e))}}class Tg{constructor(e){if(this.value=void 0,isNaN(e))throw new Sg(e);if(e<=0)throw new Sg(e);this.value=e}}function Ig(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t="undefined"!==typeof crypto?crypto:void 0;if(t){const n=t;if("function"===typeof n.randomUUID)return e?"".concat(e,"-").concat(n.randomUUID()):n.randomUUID();if("function"===typeof n.getRandomValues){const t=new Uint8Array(8);n.getRandomValues(t);const r=Array.from(t).map(e=>e.toString(16).padStart(2,"0")).join("");return"".concat(e).concat(e?"-":"").concat(Date.now(),"-").concat(r)}}return"".concat(e).concat(e?"-":"").concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,8))}class kg{constructor(e){if(this.value=void 0,"string"!==typeof e)throw new Cg(e);const t=e.trim();if(!t)throw new Cg(e);this.value=t}static generate(){if("undefined"!==typeof crypto){const e=crypto;if("function"===typeof e.randomUUID)return e.randomUUID()}return Ig("trade")}}class Cg extends Error{constructor(e){super("TradeId invalid: ".concat(String(e))),this.name="TradeIdInvalidError"}}class Ag{constructor(e){if(this.value=void 0,"string"!==typeof e)throw new Ng(e);const t=e.trim().toUpperCase();if(!t)throw new Ng(e);this.value=t}}class Ng extends Error{constructor(e){super("AnalysisId invalid: ".concat(String(e))),this.name="AnalysisIdInvalidError"}}class xg extends Error{constructor(e){super("Invalid status: ".concat(e)),this.name="StatusInvalidError"}}class Rg{constructor(e){this.value=void 0;const t=(null!==e&&void 0!==e?e:"OPEN").toString().trim().toUpperCase();if(!Rg.ALLOWED.includes(t))throw new xg(String(e));this.value=t}static fromInputValue(e){return new Rg(e)}toInputValue(){return this.value}}Rg.ALLOWED=["OPEN","CLOSED","FILLED"];class Pg extends Error{constructor(){super("Notes must not exceed ".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3," characters")),this.name="NotesTooLongError"}}class Dg{constructor(e){this.value=void 0;const t=(null!==e&&void 0!==e?e:"").trim();if(t.length>Dg.MAX_LENGTH)throw new Pg(Dg.MAX_LENGTH);this.value=t}static fromInputValue(e){return new Dg(e)}toInputValue(){return this.value}isEmpty(){return""===this.value}}Dg.MAX_LENGTH=1e3;const Lg=["Fib 0.5","Fib 0.559","Fib 0.618","Fib 0.667","Fib 0.786"];class Og{constructor(e){if(this.value=void 0,void 0===e||null===e)throw new Error("FibLevel required");const t=String(e).trim();if(0===t.length)throw new Error("FibLevel cannot be empty");if(!Lg.includes(t))throw new Error("FibLevel invalid: ".concat(t));this.value=t}toString(){return this.value}}const jg=["Monthly","Weekly","Daily","4H","2H","1H","30min","15min"],Fg=["50% Wick","50 EMA","200 EMA","FVG","Liquidit\xe4t cluster"],Mg=["CME Close","Doppelter Vorteil","Einzelne Liq. Level"];class Ug{constructor(e,t){if(this.timeframe=void 0,this.type=void 0,!e||0===String(e).trim().length)throw new Error("Confluence.type required");const n=String(e).trim();if(![...Fg,...Mg].includes(n))throw new Error("Confluence.type invalid: ".concat(n));if(this.type=n,void 0!==t&&null!==t){const e=String(t).trim();if(0===e.length)throw new Error("Confluence.timeframe cannot be empty");if(!jg.includes(e))throw new Error("Confluence.timeframe invalid: ".concat(e));this.timeframe=e}}static fromPrimitive(e){return new Ug(e.type,e.timeframe)}toPrimitive(){return{timeframe:this.timeframe,type:this.type}}}class Bg{static create(e){var t,n;const r=null!==(t=e.entryDate)&&void 0!==t?t:(new Date).toISOString(),i=!0===e.slIsBE||"number"===typeof e.sl&&0===e.sl,s="number"===typeof e.sl&&0!==e.sl?new lg(e.sl):void 0;return new og(new kg(e.id),new pg(e.symbol),new hg(r),new ug(e.size),new lg(e.price),new gg(e.side),new vg(null!==(n=e.market)&&void 0!==n?n:"All"),e.status?new Rg(e.status):void 0,e.notes?new Dg(e.notes):void 0,s,!0===i||void 0,"number"===typeof e.tp1?new lg(e.tp1):void 0,"number"===typeof e.tp2?new lg(e.tp2):void 0,"number"===typeof e.tp3?new lg(e.tp3):void 0,"number"===typeof e.tp4?new lg(e.tp4):void 0,!0===e.tp1IsHit||void 0,!0===e.tp2IsHit||void 0,!0===e.tp3IsHit||void 0,!0===e.tp4IsHit||void 0,"number"===typeof e.leverage?new bg(e.leverage):void 0,"number"===typeof e.margin?new Tg(e.margin):void 0,e.analysisId?new Ag(e.analysisId):void 0,e.userId,e.entry?new Og(e.entry):void 0,Array.isArray(e.confluence)?e.confluence.map(e=>Ug.fromPrimitive(e)):void 0)}static toDTO(e){var t,n,r,i,s,a,o,l,c,u,d,h;return{id:e.id.value,symbol:e.symbol.value,entryDate:hg.toInputValue(e.entryDate.value),size:e.size.value,price:e.price.value,side:e.side.value,status:null!==(t=null===(n=e.status)||void 0===n?void 0:n.value)&&void 0!==t?t:"OPEN",notes:null===(r=e.notes)||void 0===r?void 0:r.value,market:e.market.value,sl:!0===e.slIsBE?0:null===(i=e.sl)||void 0===i?void 0:i.value,tp1:null===(s=e.tp1)||void 0===s?void 0:s.value,tp2:null===(a=e.tp2)||void 0===a?void 0:a.value,tp3:null===(o=e.tp3)||void 0===o?void 0:o.value,tp4:null===(l=e.tp4)||void 0===l?void 0:l.value,leverage:null===(c=e.leverage)||void 0===c?void 0:c.value,margin:null===(u=e.margin)||void 0===u?void 0:u.value,slIsBE:e.slIsBE,tp1IsHit:e.tp1IsHit,tp2IsHit:e.tp2IsHit,tp3IsHit:e.tp3IsHit,tp4IsHit:e.tp4IsHit,userId:e.userId,analysisId:null===(d=e.analysisId)||void 0===d?void 0:d.value,confluence:e.confluence?e.confluence.map(e=>e.toPrimitive()):void 0,entry:null===(h=e.entry)||void 0===h?void 0:h.value}}}const Vg=[{id:"t1",market:"Crypto",symbol:"ETHUSD",entryDate:"2025-12-21T10:12:00Z",size:.51,price:1800.5,side:"SHORT",status:"OPEN",pnl:0,notes:"Scalp-Short nach Fehlausbruch.",entry:"1802.0",sl:1815,tp1:1790,tp2:1775,tp3:1750,margin:120,leverage:10},{id:"t2",market:"Crypto",symbol:"ETHUSD",entryDate:"2025-12-21T09:50:00Z",size:.37,price:1795.3,side:"LONG",status:"OPEN",pnl:0,notes:"Rebound nach Support.",entry:"1794.0",sl:1790,tp1:1805,tp2:1820,tp3:1850,margin:90,leverage:8},{id:"t3",market:"Forex",symbol:"EURUSD",entryDate:"2025-12-20T08:30:00Z",size:1e4,price:1.1203,side:"LONG",status:"CLOSED",pnl:-12.5,notes:"Reverted on news",entry:"1.1190",sl:1.117,tp1:1.125,tp2:1.128,tp3:1.13,margin:100,leverage:10},{id:"t4",market:"Crypto",symbol:"BTCUSD",entryDate:"2025-12-22T11:00:00Z",size:.12,price:42e3,side:"LONG",status:"OPEN",pnl:150.5,notes:"Breakout trade, trailing SL.",entry:"41950",sl:41700,tp1:42500,tp2:43e3,tp3:44e3,margin:500,leverage:5},{id:"t5",market:"Crypto",symbol:"SOLUSD",entryDate:"2025-12-22T10:30:00Z",size:10,price:95.2,side:"SHORT",status:"OPEN",pnl:-20.1,notes:"Short nach Fehlausbruch.",entry:"96.0",sl:98,tp1:92,tp2:89,tp3:85,margin:200,leverage:3},{id:"t6",market:"Forex",symbol:"USDJPY",entryDate:"2025-12-22T09:45:00Z",size:5e3,price:134.55,side:"LONG",status:"OPEN",pnl:10,notes:"Range-Breakout, TP1 erreicht.",entry:"134.20",sl:133.8,tp1:134.8,tp2:135.2,tp3:136,margin:150,leverage:20},{id:"t7",market:"Crypto",symbol:"ADAUSD",entryDate:"2025-12-22T08:10:00Z",size:200,price:1.25,side:"LONG",status:"OPEN",pnl:5.5,notes:"Scalp, schnelle Bewegung erwartet.",entry:"1.24",sl:1.22,tp1:1.28,tp2:1.32,tp3:1.36,margin:50,leverage:10},{id:"t8",market:"Forex",symbol:"GBPUSD",entryDate:"2025-12-22T07:30:00Z",size:8e3,price:1.32,side:"SHORT",status:"OPEN",pnl:-8.2,notes:"News-Event, SL eng.",entry:"1.3210",sl:1.323,tp1:1.318,tp2:1.315,tp3:1.31,margin:120,leverage:15},{id:"t9",market:"Crypto",symbol:"XRPUSD",entryDate:"2025-12-22T06:50:00Z",size:500,price:.95,side:"LONG",status:"OPEN",pnl:2.1,notes:"TP1 fast erreicht.",entry:"0.94",sl:.92,tp1:.97,tp2:1,tp3:1.05,margin:30,leverage:8},{id:"t10",market:"Crypto",symbol:"DOGEUSD",entryDate:"2025-12-22T06:20:00Z",size:1e3,price:.12,side:"SHORT",status:"OPEN",pnl:-1.5,notes:"Memecoin-Short, hohes Risiko.",entry:"0.13",sl:.14,tp1:.11,tp2:.1,tp3:.09,margin:25,leverage:2},{id:"t11",market:"Forex",symbol:"AUDUSD",entryDate:"2025-12-22T05:40:00Z",size:6e3,price:.755,side:"LONG",status:"OPEN",pnl:3.3,notes:"TP2 Ziel, SL nachgezogen.",entry:"0.7540",sl:.752,tp1:.757,tp2:.76,tp3:.765,margin:80,leverage:12},{id:"t12",market:"Crypto",symbol:"MATICUSD",entryDate:"2025-12-22T05:10:00Z",size:300,price:2.1,side:"LONG",status:"OPEN",pnl:7.7,notes:"Layer2 Hype, TP1 erreicht.",entry:"2.05",sl:2,tp1:2.15,tp2:2.25,tp3:2.4,margin:60,leverage:7},{id:"t13",market:"Forex",symbol:"USDCAD",entryDate:"2025-12-22T04:30:00Z",size:4e3,price:1.27,side:"SHORT",status:"OPEN",pnl:-4,notes:"Korrektur-Short, TP1 offen.",entry:"1.2710",sl:1.273,tp1:1.268,tp2:1.265,tp3:1.26,margin:70,leverage:9},{id:"t14",market:"Crypto",symbol:"BTCUSD",entryDate:"2025-12-27T21:51:00Z",size:1,price:8e4,side:"LONG",status:"OPEN",pnl:0,notes:"Test Entry",entry:"79900",sl:78e3,tp1:81e3,tp2:82e3,tp3:83e3,tp4:84e3,margin:1e3,leverage:20}];const zg=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mt_trades_v1",t=arguments.length>1?arguments[1]:void 0;this.trades=[],this.key=void 0,this.key=e;const n=void 0===(null===t||void 0===t?void 0:t.seedDefaults)||(null===t||void 0===t?void 0:t.seedDefaults),r=(()=>{try{return window.localStorage.getItem(this.key)}catch(e){return console.warn("[LocalStorageRepo] localStorage.getItem threw, ignoring storage"),null}})();if(r)try{const e=JSON.parse(r);this.trades=e.map(e=>c({},e)),console.info("[LocalStorageRepo] loaded",this.trades.length,"trades")}catch(i){console.warn("[LocalStorageRepo] could not parse stored trades, falling back to defaults/empty"),this.trades=n?Vg.map(e=>c({},e)):[],n&&this.flush()}else n?(this.trades=Vg.map(e=>c({},e)),this.flush(),console.info("[LocalStorageRepo] initialized with defaults")):(this.trades=[],console.info("[LocalStorageRepo] initialized empty (no defaults)"))}seed(e){if(!Array.isArray(e)||0===e.length)return;const t=e.map(e=>c({},e));this.trades=[...t,...this.trades],this.flush(),console.info("[LocalStorageRepo] seeded",t.length,"trades")}flush(){try{window.localStorage.setItem(this.key,JSON.stringify(this.trades)),console.info("[LocalStorageRepo] flushed",this.trades.length,"trades to localStorage");try{globalThis.dispatchEvent(new CustomEvent("trades-updated"))}catch(e){}}catch(t){console.warn("[LocalStorageRepo] failed to persist to localStorage",t)}}isObject(e){return"object"===typeof e&&null!==e}looksLikeVOTrade(e){if(!this.isObject(e))return!1;const t=e;return"symbol"in t&&this.isObject(t.symbol)&&"value"in t.symbol}toRepoTrade(e){if(this.looksLikeVOTrade(e)){var t,n,r,i;const s=e,a=s.symbol,o=s.entryDate;return{id:String(s.id),market:null!==(t=s.market)&&void 0!==t?t:"All",symbol:String(a.value),entryDate:String(o&&"object"===typeof o&&"value"in o?o.value:null!==o&&void 0!==o?o:(new Date).toISOString()),confluence:null!==(n=s.confluence)&&void 0!==n?n:void 0,size:this.isObject(s.size)&&"value"in s.size?Number(s.size.value):Number(s.size),price:this.isObject(s.price)&&"value"in s.price?Number(s.price.value):Number(s.price),side:this.isObject(s.side)&&"value"in s.side?String(s.side.value):s.side,status:null!==(r=s.status)&&void 0!==r?r:"OPEN",pnl:Number(null!==(i=s.pnl)&&void 0!==i?i:0),notes:s.notes,entry:s.entry,sl:"number"===typeof s.sl?s.sl:void 0,slIsBE:"boolean"===typeof s.slIsBE?s.slIsBE:void 0,tp1:"number"===typeof s.tp1?s.tp1:void 0,tp2:"number"===typeof s.tp2?s.tp2:void 0,tp3:"number"===typeof s.tp3?s.tp3:void 0,tp4:"number"===typeof s.tp4?s.tp4:void 0,tp1IsHit:"boolean"===typeof s.tp1IsHit?s.tp1IsHit:void 0,tp2IsHit:"boolean"===typeof s.tp2IsHit?s.tp2IsHit:void 0,tp3IsHit:"boolean"===typeof s.tp3IsHit?s.tp3IsHit:void 0,tp4IsHit:"boolean"===typeof s.tp4IsHit?s.tp4IsHit:void 0,margin:"number"===typeof s.margin?s.margin:void 0,leverage:"number"===typeof s.leverage?s.leverage:void 0,analysisId:"string"===typeof s.analysisId?s.analysisId:void 0,userId:"string"===typeof s.userId?s.userId:void 0}}if(this.isObject(e)){var s,a,o,l,c;const t=e;return{id:String(t.id),market:null!==(s=t.market)&&void 0!==s?s:"All",symbol:String(t.symbol),entryDate:String(t.entryDate),confluence:null!==(a=t.confluence)&&void 0!==a?a:void 0,size:Number(t.size),price:Number(t.price),side:null!==(o=t.side)&&void 0!==o?o:"LONG",status:null!==(l=t.status)&&void 0!==l?l:"OPEN",pnl:Number(null!==(c=t.pnl)&&void 0!==c?c:0),notes:t.notes,entry:t.entry,sl:"number"===typeof t.sl?t.sl:void 0,slIsBE:"boolean"===typeof t.slIsBE?t.slIsBE:void 0,tp1:"number"===typeof t.tp1?t.tp1:void 0,tp2:"number"===typeof t.tp2?t.tp2:void 0,tp3:"number"===typeof t.tp3?t.tp3:void 0,tp4:"number"===typeof t.tp4?t.tp4:void 0,tp1IsHit:"boolean"===typeof t.tp1IsHit?t.tp1IsHit:void 0,tp2IsHit:"boolean"===typeof t.tp2IsHit?t.tp2IsHit:void 0,tp3IsHit:"boolean"===typeof t.tp3IsHit?t.tp3IsHit:void 0,tp4IsHit:"boolean"===typeof t.tp4IsHit?t.tp4IsHit:void 0,margin:"number"===typeof t.margin?t.margin:void 0,leverage:"number"===typeof t.leverage?t.leverage:void 0,analysisId:"string"===typeof t.analysisId?t.analysisId:void 0,userId:"string"===typeof t.userId?t.userId:void 0}}return{id:"unknown",market:"All",symbol:"UNKNOWN",entryDate:(new Date).toISOString(),size:0,price:0,side:"LONG",status:"OPEN",pnl:0}}async save(e){const t=Bg.toDTO(e),n=this.toRepoTrade(t);this.trades.push(c({},n)),console.info("[LocalStorageRepo] save",n.id),this.flush()}async getAll(){try{const e=window.localStorage.getItem(this.key);if(e){const t=JSON.parse(e);this.trades=t.map(e=>c({},e))}}catch(e){}return this.trades.map(e=>{const t={id:e.id,symbol:e.symbol,entryDate:e.entryDate,size:e.size,price:e.price,side:e.side,status:e.status,notes:e.notes,market:e.market,sl:e.sl,slIsBE:e.slIsBE,userId:e.userId,tp1:e.tp1,tp2:e.tp2,tp3:e.tp3,tp4:e.tp4,tp1IsHit:e.tp1IsHit,tp2IsHit:e.tp2IsHit,tp3IsHit:e.tp3IsHit,tp4IsHit:e.tp4IsHit,leverage:e.leverage,margin:e.margin,analysisId:e.analysisId};try{return Bg.create(t)}catch(n){return console.warn("[LocalStorageRepo] failed to convert stored trade to domain Trade",n),Bg.create({id:e.id,symbol:e.symbol,entryDate:e.entryDate,size:e.size,price:e.price,side:e.side})}})}async update(e){const t=Bg.toDTO(e),n=this.toRepoTrade(t),r=this.trades.findIndex(e=>e.id===n.id);r>=0?(this.trades[r]=c(c({},this.trades[r]),n),console.info("[LocalStorageRepo] update",n.id),this.flush()):(console.warn("[LocalStorageRepo] update: trade not found, performing save instead",n.id),await this.save(e))}async delete(e){const t=this.trades.findIndex(t=>t.id===e);t>=0&&(this.trades.splice(t,1),console.info("[LocalStorageRepo] delete",e),this.flush())}},Hg="analysis_outbox_v1",Wg="analysis_pending_deletes_v1";function qg(){try{const e=localStorage.getItem(Hg);if(!e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch(e){return[]}}function Gg(e){try{localStorage.setItem(Hg,JSON.stringify(e))}catch(t){}}function Kg(){try{const e=localStorage.getItem(Wg);if(!e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch(e){return[]}}function Jg(e){try{localStorage.setItem(Wg,JSON.stringify(e))}catch(t){}}function Qg(e){const t=Kg().filter(t=>t!==e);Jg(t)}const Yg=class{constructor(e){if(this.local=new ag,this.remote=void 0,this.bootstrapped=!1,this.remote=null===e||void 0===e?void 0:e.remote,this.remote){(async()=>{try{if(this.bootstrapped)return;this.bootstrapped=!0;const t=await this.remote.listAll();if(Array.isArray(t)&&t.length){const n=Kg();for(const r of t)try{if(n.includes(r.id))continue;await this.local.save(r)}catch(e){}}}catch(t){}})();try{queueMicrotask(()=>{try{globalThis.dispatchEvent(new CustomEvent("repo-sync-status",{detail:{feature:"analysis",status:"online"}}))}catch(e){}})}catch(t){}if("undefined"!==typeof window&&"function"===typeof window.addEventListener){window.addEventListener("online",()=>{this.flushOutbox()});try{globalThis.addEventListener("repo-sync-force",()=>{this.flushOutbox()})}catch(n){}}"undefined"!==typeof navigator&&navigator.onLine&&this.flushOutbox();try{const{db:e}=tg(),t=rg();if(t){Jm(Rm(Kp(e,"users",t,"analyses")),async e=>{try{const r=e.docs.map(e=>e.data()),i=Kg();for(const e of r){var t;const n=String(e.id);if(i.includes(n))continue;const r={id:n,symbol:String(e.symbol),createdAt:String(null!==(t=e.createdAt)&&void 0!==t?t:(new Date).toISOString()),updatedAt:"string"===typeof e.updatedAt?e.updatedAt:void 0,market:"string"!==typeof e.market||"Forex"!==e.market&&"Crypto"!==e.market?void 0:e.market,timeframes:e.timeframes,notes:"string"===typeof e.notes?e.notes:void 0};await this.local.save(r)}try{globalThis.dispatchEvent(new CustomEvent("analyses-updated",{detail:{type:"remote"}}))}catch(n){}}catch(r){}})}}catch(r){}}else try{queueMicrotask(()=>{try{globalThis.dispatchEvent(new CustomEvent("repo-sync-status",{detail:{feature:"analysis",status:"local"}}))}catch(e){}})}catch(i){}}async save(e){await this.local.save(e),this.remote&&this.trySync({op:"save",dto:e})}async getById(e){const t=await this.local.getById(e);return this.remote&&(async()=>{try{if(Kg().includes(e))return;const t=await this.remote.getById(e);t&&await this.local.save(t)}catch(t){}})(),t}async listBySymbol(e){const t=await this.local.listBySymbol(e);return this.remote&&(async()=>{try{const r=await this.remote.listBySymbol(e);if(Array.isArray(r)&&r.length){const e=Kg();for(const n of r)try{if(e.includes(n.id))continue;await this.local.save(n)}catch(t){}try{globalThis.dispatchEvent(new CustomEvent("analyses-updated",{detail:{type:"remote"}}))}catch(n){}}}catch(r){}})(),t}async listAll(){const e=await this.local.listAll();return this.remote&&(async()=>{try{const n=await this.remote.listAll();if(Array.isArray(n)&&n.length){const r=Kg();for(const t of n)try{if(r.includes(t.id))continue;await this.local.save(t)}catch(e){}try{globalThis.dispatchEvent(new CustomEvent("analyses-updated",{detail:{type:"remote"}}))}catch(t){}}}catch(n){}})(),e}async delete(e){!function(e){const t=Kg();t.includes(e)||(t.push(e),Jg(t))}(e),await this.local.delete(e);try{const r=new zg,i=await r.getAll();for(const n of i)try{if(n.analysisId&&n.analysisId.value===e){const e=Bg.toDTO(n);e.analysisId=void 0;const t=Bg.create(e);await r.update(t)}}catch(t){}try{globalThis.dispatchEvent(new CustomEvent("trades-updated"))}catch(n){}}catch(r){}this.remote?this.trySync({op:"delete",id:e}):Qg(e)}async clear(){await this.local.clear()}async trySync(e){if(this.remote)try{if("delete"===e.op){await this.remote.delete(e.id);try{Qg(e.id)}catch(t){}}else await this.remote.save(e.dto);try{globalThis.dispatchEvent(new CustomEvent("repo-sync-status",{detail:{feature:"analysis",status:"online"}}))}catch(n){}}catch(r){const t=qg();t.push(e),Gg(t);try{globalThis.dispatchEvent(new CustomEvent("repo-sync-status",{detail:{feature:"analysis",status:"queued",queuedCount:t.length}}))}catch(i){}}}async flushOutbox(){if(!this.remote)return;const e=qg();if(!e.length)return;const t=[];for(const s of e)try{if("delete"===s.op){await this.remote.delete(s.id);try{Qg(s.id)}catch(n){}}else await this.remote.save(s.dto)}catch(r){t.push(s)}Gg(t);try{globalThis.dispatchEvent(new CustomEvent("repo-sync-status",{detail:{feature:"analysis",status:t.length?"queued":"online",queuedCount:t.length||void 0}}))}catch(i){}}},Xg="FilterToolbar_toolbar__becYW",Zg="FilterToolbar_left__H52Sz",$g="FilterToolbar_title__IYtS0",ey="FilterToolbar_countBadge__0h+wB",ty="FilterToolbar_right__p8eR3",ny="FilterToolbar_statusWrap__dSN4h",ry="FilterToolbar_marketWrap__YfHfv",iy="FilterToolbar_createWrap__p6gWa";function sy(e){let{marketFilter:t,setMarketFilter:n,tradesCount:r=0,countLabel:i="trades"}=e;return(0,h.jsxs)("div",{className:m.tradesFilters,children:[(0,h.jsx)(p,{variant:"All"===t?"primary":"ghost",onClick:()=>n("All"),children:"All"}),(0,h.jsx)(p,{variant:"Forex"===t?"primary":"ghost",onClick:()=>n("Forex"),children:"Forex"}),(0,h.jsx)(p,{variant:"Crypto"===t?"primary":"ghost",onClick:()=>n("Crypto"),children:"Crypto"}),(0,h.jsxs)("div",{className:m.tradesCount,children:[r," ",i]})]})}const ay=function(e){let{title:t,count:n,countLabel:r="items",showStatusFilters:i=!1,statusFilters:s,marketFilter:a,setMarketFilter:o,hideMarketFilters:l=!1,onCreate:c,createLabel:u,disableCreate:d,compact:f=!1}=e;return(0,h.jsxs)("div",{className:Xg,"data-compact":f,children:[t?(0,h.jsxs)("div",{className:Zg,children:[(0,h.jsx)("div",{className:$g,children:t}),"number"===typeof n?(0,h.jsxs)("div",{className:ey,children:[n," ",r]}):null]}):null,(0,h.jsxs)("div",{className:ty,children:[i&&s?(0,h.jsx)("div",{className:ny,children:s}):null,l?null:(0,h.jsx)("div",{className:ry,children:(0,h.jsx)(sy,{marketFilter:a,setMarketFilter:o,tradesCount:"number"===typeof n?n:0,countLabel:r})}),c?(0,h.jsx)("div",{className:iy,children:(0,h.jsx)(p,{type:"button",variant:"secondary",onClick:c,disabled:d,children:null!==u&&void 0!==u?u:"Create"})}):null]})]})},oy="CombinedFilterMenu_container__I1Pfp",ly="CombinedFilterMenu_label__rnhHb",cy="CombinedFilterMenu_statusGroup__T-ruQ",uy="CombinedFilterMenu_marketGroup__xH9y5",dy="CombinedFilterMenu_pills__d16QD";const hy=function(e){let{marketFilter:t,setMarketFilter:n,tradeStatusFilter:r="ALL",setTradeStatusFilter:i}=e;return(0,h.jsxs)("div",{className:oy,children:[(0,h.jsxs)("div",{className:cy,children:[(0,h.jsx)("span",{className:ly,children:"Status"}),(0,h.jsx)("div",{className:dy,children:["ALL","OPEN","CLOSED","FILLED"].map(e=>(0,h.jsx)(p,{type:"button",variant:r===e?"primary":"ghost",onClick:()=>null===i||void 0===i?void 0:i(e),children:"ALL"===e?"All":e.charAt(0)+e.slice(1).toLowerCase()},e))})]}),(0,h.jsxs)("div",{className:uy,children:[(0,h.jsx)("span",{className:ly,children:"Market"}),(0,h.jsx)("div",{className:dy,children:["All","Forex","Crypto"].map(e=>(0,h.jsx)(p,{type:"button",variant:t===e?"primary":"ghost",onClick:()=>n(e),children:e},e))})]})]})},fy={select:"ActionDropdown_select__88V-H",compact:"ActionDropdown_compact__XlE0P",optionSuccess:"ActionDropdown_optionSuccess__y6iFr"};function py(e){let{options:t,placeholder:n="Action",ariaLabel:i,size:s="default"}=e;const a=(0,r.useRef)(null);if(!t.length)return null;const o={success:fy.optionSuccess},l=[fy.select,"compact"===s?fy.compact:""].filter(Boolean).join(" ");return(0,h.jsxs)("select",{ref:a,className:l,"aria-label":i,defaultValue:"",onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),onChange:e=>{e.stopPropagation();const n=e.target.value;if(!n)return;const r=t.find(e=>e.value===n);if(r){console.debug("[ActionDropdown] selected",n);try{r.onSelect()}catch(i){console.warn("ActionDropdown option handler threw",i)}setTimeout(()=>{a.current&&(a.current.value="")},0)}},children:[(0,h.jsx)("option",{value:"",children:n}),t.map(e=>{var t;return(0,h.jsx)("option",{value:e.value,className:e.variant?o[e.variant]:void 0,"data-variant":null!==(t=e.variant)&&void 0!==t?t:void 0,children:e.label},e.value)})]})}const my="IconButton_iconBtn__ZuD+0",gy="IconButton_inner__LEugt",yy=["ariaLabel","variant","color","icon","className","children"];function vy(e){let{ariaLabel:t,variant:n="ghost",color:r,icon:i,className:s="",children:a}=e,o=u(e,yy);const l=[s].filter(Boolean).join(" "),d=null!==r&&void 0!==r?r:"primary"===n?"primary":void 0,f="primary"===d?"var(--color-primary)":d,m=c(c({},o.style),f?{color:f}:{});return(0,h.jsx)(p,c(c({"aria-label":t,variant:n,className:"".concat(my," ").concat(l)},o),{},{style:m,children:(0,h.jsx)("span",{className:gy,"aria-hidden":!0,children:null!==i&&void 0!==i?i:a})}))}const _y="RepoSyncStatus_chip__zbe7Y",by="RepoSyncStatus_compact__c70SS",wy="RepoSyncStatus_chipLocal__jVfm1",Ey="RepoSyncStatus_chipOnline__Cuhy+",Sy="RepoSyncStatus_chipQueued__vjnHG",Ty="RepoSyncStatus_spinner__vSLKa",Iy="AnalysisCreatePanel_panel__fqYGR",ky="AnalysisCreatePanel_panelHeader__mMvF9",Cy="AnalysisCreatePanel_panelKicker__MH4fp",Ay="AnalysisCreatePanel_panelTitle__7-H-V",Ny="AnalysisCreatePanel_panelActions__uJguq",xy="AnalysisCreatePanel_closeBtn__u2zwD",Ry="AnalysisCreatePanel_errorBanner__wTVuy",Py="AnalysisCreatePanel_editorWrap__07RI-";function Dy(e){let{open:t,compactView:n=!1,errorMessage:r,formKey:i,onClose:s,onSubmit:a}=e;return t?(0,h.jsxs)("section",{className:Iy,"data-testid":"analysis-create-panel","data-compact":n,"aria-label":"Neue Marktanalyse anlegen",children:[(0,h.jsxs)("div",{className:ky,children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:Cy,children:"Workflow"}),(0,h.jsx)("h3",{className:Ay,children:"Analyse anlegen"})]}),(0,h.jsx)("div",{className:Ny,children:(0,h.jsx)(p,{type:"button",variant:"ghost",className:xy,onClick:s,children:"Panel schlie\xdfen"})})]}),r?(0,h.jsx)("div",{className:Ry,role:"alert",children:r}):null,(0,h.jsx)("div",{className:Py,children:(0,h.jsx)(we,{focusField:"symbol",onSave:a},i)})]}):null}class Ly extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Trade symbol is invalid"),this.name="TradeSymbolInvalidError"}}class Oy{constructor(e){if(this.value=void 0,"string"!==typeof e)throw new Ly("Symbol must be a string");const t=e.trim().toUpperCase();if(!t)throw new Ly("Symbol must not be empty");if(!/^[A-Z0-9_\-/.]+$/.test(t))throw new Ly("Symbol contains invalid characters");this.value=t}}class jy extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Entry date is invalid"),this.name="EntryDateInvalidError"}}class Fy{constructor(e){if(this.iso=void 0,e instanceof Date){if(isNaN(e.getTime()))throw new jy("Invalid Date object");return void(this.iso=e.toISOString())}if("string"!==typeof e)throw new jy("EntryDate must be a string or Date");let t=null;if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}(:\d{2})?$/.test(e)){const n=new Date(e);isNaN(n.getTime())||(t=n)}if(!t){const n=new Date(e);isNaN(n.getTime())||(t=n)}if(!t)throw new jy("Cannot parse entry date");this.iso=t.toISOString()}toInputValue(){const e=new Date(this.iso),t=e=>String(e).padStart(2,"0"),n=e.getFullYear(),r=t(e.getMonth()+1),i=t(e.getDate()),s=t(e.getHours()),a=t(e.getMinutes());return"".concat(n,"-").concat(r,"-").concat(i,"T").concat(s,":").concat(a)}static fromInputValue(e){return new Fy(e).iso}}class My extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"TradingView link is invalid"),this.name="TradingViewLinkInvalidError"}}class Uy{constructor(e){if(this.value=void 0,void 0===e||null===e||""===e)return void(this.value="");if("string"!==typeof e)throw new My("Link must be a string");const t=e.trim();try{const e=new URL(t);this.value=e.toString()}catch(n){throw new My("Invalid URL")}}}class By{constructor(e,t,n,r,i,s,a,o){if(this.id=void 0,this.symbol=void 0,this.market=void 0,this.createdAt=void 0,this.timeframes=void 0,this.notes=void 0,this.updatedAt=void 0,this.setups=void 0,!e)throw new Error("Analysis id is required");if(!t)throw new Error("Symbol is required");if(!r)throw new Error("CreatedAt is required");this.id=e,this.symbol=t,this.market=n,this.createdAt=r,this.timeframes=i,this.notes=s,this.updatedAt=a,this.setups=o}}const Vy={create:function(e){const t=e.symbol instanceof Oy?e.symbol:new Oy(e.symbol),n=e.createdAt?e.createdAt instanceof Fy?e.createdAt.iso:new Fy(e.createdAt).iso:new Fy(new Date).iso,r=e.id?new Ag(e.id):new Ag(Ig("analysis")),i=function(e){const t={};return["monthly","weekly","daily","4h","2h","1h","15min"].forEach(e=>{t[e]={timeframe:e}}),e?(Array.isArray(e)?e.forEach(e=>{const n=e.tradingViewLink?new Uy(e.tradingViewLink).value:"";t[e.timeframe]={timeframe:e.timeframe,tradingViewLink:n,note:e.note}}):Object.values(e).forEach(e=>{const n=e.tradingViewLink?new Uy(e.tradingViewLink).value:"";t[e.timeframe]={timeframe:e.timeframe,tradingViewLink:n,note:e.note}}),t):t}(e.timeframes);return new By(r,t,e.market,n,i,e.notes?new Dg(e.notes):void 0,void 0,e.setups)},toDTO:function(e){var t,n;return{id:e.id.value,symbol:e.symbol.value,market:e.market,createdAt:e.createdAt,updatedAt:e.updatedAt,timeframes:e.timeframes,notes:null===(t=e.notes)||void 0===t?void 0:t.value,setups:null!==(n=e.setups)&&void 0!==n?n:[]}}};class zy{constructor(e){this.repo=e}async createAnalysis(e){const t=Vy.create(e),n=Vy.toDTO(t);return await this.repo.save(n),n}async getAnalysis(e){return this.repo.getById(e)}async deleteAnalysis(e){await this.repo.delete(e)}async listBySymbol(e){return this.repo.listBySymbol(e)}async linkTradeToAnalysis(e,t){if(!await this.repo.getById(e))throw new Error("Analysis not found");return{analysisId:e,backlink:"app://analysis/".concat(e)}}}const Hy="#/analysis",Wy=e=>"".concat(Hy,"?id=").concat(encodeURIComponent(e)),qy=e=>{if(!e)return"All";if("string"===typeof e){const t=e.trim().toLowerCase();return"crypto"===t?"Crypto":"forex"===t?"Forex":"All"}if("object"===typeof e)try{const t=e;if("string"===typeof t.value)return qy(t.value)}catch(t){}return"All"},Gy=e=>({id:e.id,symbol:e.symbol,createdAt:e.createdAt,notes:e.notes,market:qy(e.market)}),Ky=e=>e.map(Gy),Jy=((e,t)=>{const n=null!==(t=null===(e={NODE_ENV:"production"})||void 0===e?void 0:e.VITE_USE_FIREBASE)&&void 0!==t?t:"true";return"boolean"===typeof n?n:"string"===typeof n&&"true"===n.toLowerCase()})(),Qy=(()=>{try{const e=localStorage.getItem("mt_user_settings_v1");if(!e)return;const t=JSON.parse(e);return"boolean"===typeof t.useCloudSync?t.useCloudSync:void 0}catch(e){return}})(),Yy=Jy&&!1!==Qy,Xy=(()=>{if(Yy){const e=new ig;return new Yg({remote:e})}return new Yg})(),Zy=new zy(Xy);function $y(e){let{onCreateTradeSuggestion:t,compactView:n=!1,marketFilter:i,onMarketFilterChange:s,showFilterToolbar:a=!0,onVisibleCountChange:o,onSelectionChange:l,useCard:c=!0}=e;const[u,d]=(0,r.useState)([]),[f,m]=(0,r.useState)(null!==i&&void 0!==i?i:"All"),g=null!==i&&void 0!==i?i:f,[y,v]=(0,r.useState)(null),[_,b]=(0,r.useState)(null),[w,E]=(0,r.useState)(!1),[S,k]=(0,r.useState)(null),[A,x]=(0,r.useState)([]),[R,P]=(0,r.useState)(!1),[D,L]=(0,r.useState)(null),[O,j]=(0,r.useState)(0);(0,r.useEffect)(()=>{void 0!==i&&m(i)},[i]),(0,r.useEffect)(()=>{let e=!0;const t=async()=>{try{const t=await Xy.listAll();if(!e)return;d(Ky(t))}catch(t){}};try{const e=localStorage.getItem("analysis_pending_deletes_v1");if(e){const t=JSON.parse(e);Array.isArray(t)&&x(t.filter(e=>"string"===typeof e))}}catch(r){}t();const n=window.setInterval(()=>{t()},15e3);return()=>{e=!1,clearInterval(n)}},[]),(0,r.useEffect)(()=>{const e=async e=>{try{const e=await Xy.listAll();d(Ky(e))}catch(t){}};return globalThis.addEventListener("analyses-updated",e),()=>globalThis.removeEventListener("analyses-updated",e)},[]),(0,r.useEffect)(()=>{const e=e=>{try{const t=e.detail;t&&"string"===typeof t.id&&v(t.id)}catch(t){}};return globalThis.addEventListener("open-analysis",e),()=>globalThis.removeEventListener("open-analysis",e)},[]),(0,r.useEffect)(()=>{if("undefined"===typeof window)return;const e=()=>{var e;const t=null!==(e=window.location.hash)&&void 0!==e?e:"";if(!t.startsWith(Hy))return;const n=(e=>{if(!e.startsWith(Hy))return null;const t=e.indexOf("?");if(-1===t)return null;try{const n=new URLSearchParams(e.substring(t+1)).get("id");return n&&n.length>0?n:null}catch(n){return null}})(t);v(null!==n&&void 0!==n?n:null)};e();const t=()=>e();return window.addEventListener("hashchange",t),()=>window.removeEventListener("hashchange",t)},[]);const F=r.useMemo(()=>"All"===g?u:u.filter(e=>e.market===g),[u,g]),M=F.length,U=r.useMemo(()=>{if(y)return F.find(e=>e.id===y)},[F,y]);(0,r.useEffect)(()=>{l&&l(U)},[l,U]),(0,r.useEffect)(()=>{o&&o(M)},[M,o]);const B=async(e,t)=>{v(e),t&&(b(t),setTimeout(()=>b(null),200))},V=e=>{k(e),E(!0)},z=e=>{s&&s(e),void 0===i&&m(e)},H=()=>{L(null),P(!0)},W=()=>{L(null),P(!1),j(e=>e+1)},q=!1!==a,G="All"===g?"Alle M\xe4rkte":g,K=e=>{if(!t)return;const n=null!==e&&void 0!==e?e:U;n&&t({analysisId:n.id,symbol:n.symbol,price:0,entryDate:(new Date).toISOString(),market:n.market,side:"LONG"})},J=e=>{const n=[{value:"open",label:"Detail \xf6ffnen",onSelect:()=>(e=>{if(B(e),"undefined"!==typeof window)try{const t=Wy(e);window.location.hash!==t?window.location.hash=t:window.location.hash.startsWith(Hy)||(window.location.hash=t)}catch(t){}})(e.id)}];return t&&n.push({value:"create-trade",label:"Trade anlegen",variant:"success",onSelect:()=>K(e)}),n};return(0,h.jsxs)("div",{className:n?"".concat(I.container," ").concat(I.compact):I.container,"data-compact":n,children:[q?(0,h.jsxs)("div",{className:I.headerBlock,"data-testid":"analysis-toolbar",children:[(0,h.jsxs)("div",{className:I.headerRow,children:[(0,h.jsxs)("div",{className:I.headerText,children:[(0,h.jsxs)("div",{className:I.headerLabelRow,children:[(0,h.jsx)("h2",{className:I.title,children:"Marktanalyse"}),(0,h.jsxs)("span",{className:I.countBadge,children:[M," analyses"]})]}),(0,h.jsxs)("p",{className:I.headerMeta,children:["Gefiltert: ",G]})]}),(0,h.jsxs)("div",{className:I.headerActions,children:[(0,h.jsx)(p,{type:"button",variant:"primary",className:I.createBtn,onClick:H,children:"Analyse anlegen"}),t?(0,h.jsx)(p,{type:"button",variant:"secondary",className:I.createBtn,disabled:!U,onClick:()=>K(),children:"Trade anlegen"}):null]})]}),(0,h.jsx)("div",{className:I.filtersRow,children:(0,h.jsx)(ay,{title:void 0,marketFilter:g,setMarketFilter:z,showStatusFilters:!0,statusFilters:(0,h.jsx)(hy,{marketFilter:g,setMarketFilter:z,tradeStatusFilter:void 0,setTradeStatusFilter:void 0}),hideMarketFilters:!0,count:M,countLabel:"analyses",onCreate:H,disableCreate:!1,createLabel:"Analyse anlegen"})})]}):null,(0,h.jsx)(Dy,{open:R,compactView:n,errorMessage:D,formKey:O,onClose:W,onSubmit:async e=>{L(null);try{const n={symbol:e.symbol,notes:e.notes,market:e.market,timeframes:Array.isArray(e.timeframes)?e.timeframes.map(e=>({timeframe:e.timeframe,tradingViewLink:e.tradingViewLink,note:e.note})):e.timeframes},r=await Zy.createAnalysis(n),i=await Xy.listAll();d(Ky(i)),B(r.id,"symbol"),W();try{globalThis.dispatchEvent(new CustomEvent("analyses-updated",{detail:{type:"created",id:r.id}}))}catch(t){}if("undefined"!==typeof window){const e=Wy(r.id);window.location.hash!==e&&(window.location.hash=e)}}catch(n){L("Analyse konnte nicht angelegt werden. Versuche es erneut.")}}}),(0,h.jsx)("div",{className:I.listOnlyLayout,children:c?(0,h.jsx)(C,{className:I.listCard,title:q?void 0:"Analysen",children:(0,h.jsx)(N,{items:F,compactView:n,selectedId:y,onSelect:B,renderActions:e=>{let t=!1;try{const n=localStorage.getItem("analysis_outbox_v1");if(n){const r=JSON.parse(n);if(Array.isArray(r))for(const n of r)if(n&&"delete"===n.op&&n.id===e.id){t=!0;break}}}catch(r){}return(0,h.jsxs)("div",{className:I.actionDropdownWrap,children:[(0,h.jsxs)("div",{className:I.deleteWrap,children:[(0,h.jsx)(vy,{ariaLabel:"Delete ".concat(e.symbol),title:"Delete analysis",variant:"ghost",className:I.deleteBtn,onClick:t=>{t.stopPropagation(),V(e.id)},onKeyDown:e=>{e.stopPropagation()},icon:(0,h.jsx)("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:(0,h.jsx)("path",{d:"M6 6 18 18M18 6 6 18",fill:"none",stroke:"currentColor",strokeWidth:"1.9",strokeLinecap:"round"})})}),A.includes(e.id)?t?(0,h.jsx)("div",{className:"".concat(Sy," ").concat(I.deleteStatus),"aria-hidden":!0,children:"Wartet"}):(0,h.jsx)("span",{className:"".concat(Ty," ").concat(I.deleteSpinner),"aria-hidden":!0}):null]}),(0,h.jsx)("div",{className:I.dropdownWrap,onClick:e=>e.stopPropagation(),children:(0,h.jsx)(py,{ariaLabel:"Aktionen f\xfcr ".concat(e.symbol),placeholder:"Aktion",size:n?"compact":"default",options:J(e)})})]})},renderExpandedContent:e=>y!==e.id?null:(0,h.jsx)("div",{className:I.inlineDetail,children:(0,h.jsx)(r.Suspense,{fallback:(0,h.jsx)("div",{className:I.detailLoading,children:"Loading..."}),children:(0,h.jsx)(ev,{id:e.id,startEditingField:null!==_&&void 0!==_?_:void 0,onRequestDelete:V})})})})}):(0,h.jsx)("div",{className:I.listCard,children:(0,h.jsx)(N,{items:F,compactView:n,selectedId:y,onSelect:B,renderActions:e=>{let t=!1;try{const n=localStorage.getItem("analysis_outbox_v1");if(n){const r=JSON.parse(n);if(Array.isArray(r))for(const n of r)if(n&&"delete"===n.op&&n.id===e.id){t=!0;break}}}catch(r){}return(0,h.jsxs)("div",{className:I.actionDropdownWrap,children:[(0,h.jsxs)("div",{className:I.deleteWrap,children:[(0,h.jsx)(vy,{ariaLabel:"Delete ".concat(e.symbol),title:"Delete analysis",variant:"ghost",className:I.deleteBtn,onClick:t=>{t.stopPropagation(),V(e.id)},onKeyDown:e=>{e.stopPropagation()},icon:(0,h.jsx)("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:(0,h.jsx)("path",{d:"M6 6 18 18M18 6 6 18",fill:"none",stroke:"currentColor",strokeWidth:"1.9",strokeLinecap:"round"})})}),A.includes(e.id)?t?(0,h.jsx)("div",{className:"".concat(Sy," ").concat(I.deleteStatus),"aria-hidden":!0,children:"Wartet"}):(0,h.jsx)("span",{className:"".concat(Ty," ").concat(I.deleteSpinner),"aria-hidden":!0}):null]}),(0,h.jsx)("div",{className:I.dropdownWrap,onClick:e=>e.stopPropagation(),children:(0,h.jsx)(py,{ariaLabel:"Aktionen f\xfcr ".concat(e.symbol),placeholder:"Aktion",size:n?"compact":"default",options:J(e)})})]})},renderExpandedContent:e=>y!==e.id?null:(0,h.jsx)("div",{className:I.inlineDetail,children:(0,h.jsx)(r.Suspense,{fallback:(0,h.jsx)("div",{className:I.detailLoading,children:"Loading..."}),children:(0,h.jsx)(ev,{id:e.id,startEditingField:null!==_&&void 0!==_?_:void 0,onRequestDelete:V})})})})})}),y?null:(0,h.jsx)("div",{className:I.noSelection,children:"Keine Analyse ausgew\xe4hlt"}),(0,h.jsx)(T,{open:w,title:"Delete analysis",message:"Are you sure you want to delete this analysis? This cannot be undone.",confirmLabel:"Delete",cancelLabel:"Cancel",confirmVariant:"danger",onCancel:()=>E(!1),onConfirm:async()=>{E(!1),S&&await(async e=>{try{x(t=>t.includes(e)?t:[...t,e]),await Xy.delete(e);try{globalThis.dispatchEvent(new CustomEvent("repo-sync-force"))}catch(t){}const n=await Xy.listAll();d(Ky(n)),y===e&&v(null)}catch(n){console.warn("Failed to delete analysis",n)}finally{x(t=>t.filter(t=>t!==e))}})(S),k(null)}})]})}function ev(e){let{id:t,startEditingField:n,onRequestDelete:i}=e;const[s,a]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let e=!0;const n=async()=>{try{const n=await Xy.getById(t);e&&a(n)}catch(n){}};n();const r=window.setInterval(()=>{n()},15e3);return()=>{e=!1,clearInterval(r)}},[t]),s?(0,h.jsx)(Ee,{analysis:s,compactView:!1,showSymbolTitle:!1,startEditingField:null!==n&&void 0!==n?n:void 0,onRequestDelete:i,onSave:async e=>{try{await Xy.save(e);const r=await Xy.getById(e.id);if(r){try{a(r)}catch(t){}try{globalThis.dispatchEvent(new CustomEvent("analyses-updated",{detail:{type:"local"}}))}catch(n){}}}catch(r){console.warn("Failed to save analysis",r)}}}):(0,h.jsx)("div",{children:"L\xe4dt Analyse..."})}function tv(e){const{repoRef:t,setPositions:n,analysisService:i,newTradeModalOpen:s,setNewTradeModalOpen:a,setLastStatus:o}=e,[l,u]=(0,r.useState)({symbol:"",entryDate:hg.toInputValue(),size:void 0,price:void 0,side:"LONG",status:"OPEN",market:"Crypto",notes:"",analysisId:void 0,fibLevel:void 0,confluence:[]}),[d,h]=(0,r.useState)({}),[f,p]=(0,r.useState)({}),[m,g]=(0,r.useState)(!1),[y,v]=(0,r.useState)(0),_=(0,r.useCallback)(e=>{if(void 0!==e&&null!==e){if("number"===typeof e)return e;try{const t=String(e).trim();if(0===t.length)return;const n=Number(t);return Number.isNaN(n)?void 0:n}catch(t){return}}},[]),b=(0,r.useCallback)(()=>{u({symbol:"",entryDate:hg.toInputValue(),size:void 0,price:void 0,side:"LONG",status:"OPEN",market:"Crypto",notes:"",sl:void 0,tp1:void 0,tp2:void 0,tp3:void 0,tp4:void 0,leverage:void 0,margin:void 0,analysisId:void 0,fibLevel:void 0,confluence:[]}),h({}),p({}),g(!1),v(e=>e+1)},[]),w=(0,r.useCallback)(async e=>{var r,u,d;e&&"function"===typeof e.preventDefault&&e.preventDefault(),g(!0),null===o||void 0===o||o("handleAdd start");const f=function(e){const t=[];return e.symbol&&0!==e.symbol.trim().length||t.push({field:"symbol",message:"Symbol ist erforderlich"}),e.entryDate&&0!==e.entryDate.trim().length?isNaN(Date.parse(e.entryDate))&&t.push({field:"entryDate",message:"Entry Date ist ung\xfcltig"}):t.push({field:"entryDate",message:"Entry Date ist erforderlich"}),"number"!==typeof e.price||Number.isNaN(e.price)?t.push({field:"price",message:"Entry Price ist erforderlich"}):e.price<=0&&t.push({field:"price",message:"Preis muss eine positive Zahl sein"}),("number"!==typeof e.size||Number.isNaN(e.size)||e.size<=0)&&t.push({field:"size",message:"Gr\xf6\xdfe muss positiv sein"}),(!e.side||"LONG"!==e.side&&"SHORT"!==e.side)&&t.push({field:"side",message:"Seite muss LONG oder SHORT sein"}),(!e.market||"Forex"!==e.market&&"Crypto"!==e.market)&&t.push({field:"market",message:"Bitte Markt ausw\xe4hlen"}),("number"!==typeof e.sl||Number.isNaN(e.sl))&&t.push({field:"sl",message:"Stop Loss (SL) ist erforderlich"}),("number"!==typeof e.margin||Number.isNaN(e.margin)||e.margin<=0)&&t.push({field:"margin",message:"Margin ist erforderlich"}),("number"!==typeof e.leverage||Number.isNaN(e.leverage)||e.leverage<=0)&&t.push({field:"leverage",message:"Leverage ist erforderlich"}),t}({symbol:l.symbol,entryDate:l.entryDate,size:null!==(r=_(l.size))&&void 0!==r?r:void 0,price:null!==(u=_(l.price))&&void 0!==u?u:void 0,side:l.side,market:null!==(d=l.market)&&void 0!==d?d:"",sl:l.sl,margin:l.margin,leverage:l.leverage}),m={};if(f.forEach(e=>{e&&e.field&&(m[e.field]=e.message)}),Object.keys(m).length>0)return h(m),null===o||void 0===o||o("validation failed: ".concat(Object.keys(m).join(","))),void p(e=>c(c({},e),Object.fromEntries(Object.keys(m).map(e=>[e,!0]))));const y=c(c(c({id:kg.generate(),symbol:l.symbol,entryDate:l.entryDate,size:Number(l.size),price:Number(l.price),side:l.side,notes:l.notes||void 0,market:l.market||"Crypto",sl:l.sl,tp1:l.tp1,tp2:l.tp2,tp3:l.tp3,tp4:l.tp4,margin:l.margin,leverage:l.leverage,status:l.status,pnl:0},l.analysisId?{analysisId:new Ag(l.analysisId).value}:{}),l.fibLevel?{entry:l.fibLevel}:{}),l.confluence&&l.confluence.length>0?{confluence:l.confluence}:{});try{if(t.current){null===o||void 0===o||o("persisting ".concat(y.id));const e=Bg.create(y),r=t.current;if(r&&"function"===typeof r.save&&await r.save(e),null===o||void 0===o||o("persisted ".concat(y.id)),l.analysisId&&null!==i&&void 0!==i&&i.linkTradeToAnalysis)try{const e=new Ag(l.analysisId).value,t=(await i.linkTradeToAnalysis(e,y.id)).backlink,s="".concat(y.notes?y.notes+"\n":"","Linked to analysis: ").concat(t),a=Bg.create(c(c({},y),{},{notes:s,analysisId:e}));r&&"function"===typeof r.update&&await r.update(a),n(e=>[c(c({},y),{},{notes:s}),...e])}catch(v){console.warn("failed to create analysis backlink",v)}try{if(r&&"function"===typeof r.getAll){const e=(await r.getAll()).map(e=>Bg.toDTO(e));n(e),null===o||void 0===o||o("reloaded ".concat(e.length," trades from repo"))}}catch(w){null===o||void 0===o||o("reload failed; fallback to local"),n(e=>[y,...e])}}else null===o||void 0===o||o("repo unavailable; local update"),n(e=>[y,...e]);null===o||void 0===o||o("Saved"),s&&"function"===typeof a&&a(!1),b()}catch(E){null===o||void 0===o||o("persist error"),n(e=>[y,...e])}h({}),g(!1),p({})},[l,_,t,n,b,i,s,a,o]);return{form:l,setForm:u,formErrors:d,setFormErrors:h,touched:f,setTouched:p,formSubmitted:m,setFormSubmitted:g,formKey:y,handleAdd:w,resetNewTradeForm:b}}const nv={container:"SideSelect_container__hrn9w",select:"SideSelect_select__0zTC3",selectCompact:"SideSelect_selectCompact__vMBxN",colored:"SideSelect_colored__2AdAm",coloredLong:"SideSelect_coloredLong__Yp5MI",coloredShort:"SideSelect_coloredShort__6VF1f",badge:"SideSelect_badge__AtsPx",badgeLong:"SideSelect_badgeLong__tpiZx",badgeShort:"SideSelect_badgeShort__3Nzj7",error:"SideSelect_error__4OxlT",containerFull:"SideSelect_containerFull__+X7Gc"};function rv(e){let{value:t,onChange:n,ariaLabel:r,showBadge:i=!1,compact:s=!1,onBlur:a,colored:o=!1,label:l,hasError:c=!1,ariaDescribedBy:u,className:d}=e;const f=s?"".concat(nv.select," ").concat(nv.selectCompact):nv.select,p=o?"LONG"===t?"".concat(f," ").concat(nv.colored," ").concat(nv.coloredLong):"".concat(f," ").concat(nv.colored," ").concat(nv.coloredShort):f,m="".concat(p," ").concat(c?nv.error:"").trim(),g=[nv.container,d?nv.containerFull:""].filter(Boolean).join(" "),y=(0,h.jsxs)("div",{className:g,children:[(0,h.jsxs)("select",{className:[m,d].filter(Boolean).join(" "),value:t,onChange:e=>n(e.target.value),onBlur:a,"aria-label":r,"aria-describedby":u,children:[(0,h.jsx)("option",{value:"LONG",children:"LONG"}),(0,h.jsx)("option",{value:"SHORT",children:"SHORT"})]}),i&&(0,h.jsx)("span",{className:"".concat(nv.badge," ").concat("LONG"===t?nv.badgeLong:nv.badgeShort),"aria-hidden":!0,children:t})]});return l?(0,h.jsxs)("label",{className:G.wrapper,children:[(0,h.jsx)("span",{className:G.label,children:l}),y]}):y}const iv="StatusSelect_select__oHyoN",sv="StatusSelect_selectCompact__jkYJa",av="StatusSelect_colored__mWf6h",ov="StatusSelect_coloredOpen__TFUMC",lv="StatusSelect_coloredClosed__LjXjP",cv="StatusSelect_coloredFilled__ftI8h",uv="StatusSelect_error__pJKBi";function dv(e){let{value:t,onChange:n,ariaLabel:r,compact:i=!1,colored:s=!0,onBlur:a,autoFocus:o=!1,label:l,hasError:c=!1,ariaDescribedBy:u}=e;const d=i?"".concat(iv," ").concat(sv):iv,f=s?"OPEN"===t?"".concat(d," ").concat(av," ").concat(ov):"CLOSED"===t?"".concat(d," ").concat(av," ").concat(lv):"".concat(d," ").concat(av," ").concat(cv):d,p="".concat(f," ").concat(c?uv:"").trim(),m=(0,h.jsxs)("select",{className:p,value:t,onChange:e=>{const t=e.target.value;n(t);try{e.currentTarget.blur()}catch(r){}},"aria-label":r,onBlur:a,autoFocus:o,"aria-describedby":u,children:[(0,h.jsx)("option",{value:"OPEN",children:"OPEN"}),(0,h.jsx)("option",{value:"CLOSED",children:"CLOSED"}),(0,h.jsx)("option",{value:"FILLED",children:"FILLED"})]});return l?(0,h.jsxs)("label",{className:G.wrapper,children:[(0,h.jsx)("span",{className:G.label,children:l}),m]}):m}const hv={fullWidthField:"NewTradeForm_fullWidthField__izVnH",tpColLeft:"NewTradeForm_tpColLeft__TBNnV",tpColRight:"NewTradeForm_tpColRight__VSUIg",newTradeGrid:"NewTradeForm_newTradeGrid__qPPDc",newTradeField:"NewTradeForm_newTradeField__hKB2d",tpField:"NewTradeForm_tpField__IslJV",notesFullWidthField:"NewTradeForm_notesFullWidthField__ikhMW",tpFullWidthRow:"NewTradeForm_tpFullWidthRow__aK0uY",actionsRow:"NewTradeForm_actionsRow__wxPVc",statusActionField:"NewTradeForm_statusActionField__Mb418",actions:"NewTradeForm_actions__DjEaG",fieldError:"NewTradeForm_fieldError__hGOMr"},fv={overlay:"FibLevelModal_overlay__g3Df8",modal:"FibLevelModal_modal__jknKE",chipRow:"FibLevelModal_chipRow__94Db7",chip:"FibLevelModal_chip__tyKkq",chipSelected:"FibLevelModal_chipSelected__pHnRG"},pv={tag:"TagToggle_tag__Pd6+f",active:"TagToggle_active__6SbVQ",label:"TagToggle_label__RPR8Y",disabled:"TagToggle_disabled__5wa3W"};function mv(e){let{label:t,checked:n,onChange:r,disabled:i,className:s}=e;return(0,h.jsx)("button",{type:"button",className:[pv.tag,n?pv.active:"",i?pv.disabled:"",null!==s&&void 0!==s?s:""].filter(Boolean).join(" "),"aria-pressed":n,"aria-label":t,disabled:i,tabIndex:0,onClick:()=>!i&&r(!n),children:(0,h.jsx)("span",{className:pv.label,children:t})})}const gv=Lg.slice();function yv(e){let{open:t,selectedFibLevel:n,onChange:i,onClose:s}=e;const[a,o]=r.useState(n);return r.useEffect(()=>{t&&o(n)},[t,n]),t?(0,h.jsx)("div",{className:fv.overlay,children:(0,h.jsxs)("div",{className:fv.modal,children:[(0,h.jsx)("h2",{children:"SK Entry w\xe4hlen"}),(0,h.jsx)("div",{className:fv.chipRow,children:gv.map(e=>(0,h.jsx)(mv,{label:e,checked:a===e,onChange:()=>o(e)},e))}),(0,h.jsxs)("div",{className:fv.actions,children:[(0,h.jsx)(p,{type:"button",variant:"secondary",onClick:s,children:"Schlie\xdfen"}),(0,h.jsx)(p,{type:"button",variant:"primary",onClick:()=>{i(a),s()},disabled:!a,style:{marginLeft:8},children:"Best\xe4tigen"})]})]})}):null}const vv="ConfluenceModal_overlay__r+1-U",_v="ConfluenceModal_modal__UGR+c",bv="ConfluenceWizard_card__G+9y0",wv="ConfluenceWizard_title__xkOHz",Ev="ConfluenceWizard_subtitle__osbs5",Sv="ConfluenceWizard_step__f2dkb",Tv="ConfluenceWizard_options__gRTbZ",Iv="ConfluenceWizard_optionBtn__oTUyF",kv="ConfluenceWizard_selected__EzSzo",Cv="ConfluenceWizard_summaryRow__IRkM-",Av="ConfluenceWizard_summaryList__9Bi9N",Nv="ConfluenceWizard_summaryItem__L+FZl",xv="ConfluenceWizard_summaryTypes__KhXlg",Rv="ConfluenceWizard_removeBtn__ON+T9",Pv="ConfluenceWizard_hint__MgR9U",Dv="ConfluenceWizard_switchGroup__-5u9Q",Lv="ConfluenceWizard_switchLabel__R9liP",Ov="ConfluenceWizard_switchText__bgYtb",jv="ConfluenceWizard_actions__7WifR",Fv="ConfluenceWizard_cancelBtn__Ne1D8",Mv="ConfluenceWizard_confirmBtn__E+3D7",Uv=jg.slice(),Bv=Fg.slice(),Vv=Mg.slice();function zv(e){let{onConfirm:t,onCancel:n}=e;const[i,s]=(0,r.useState)(0),[a,o]=(0,r.useState)(""),[l,u]=(0,r.useState)({}),[d,f]=(0,r.useState)({}),[m,g]=(0,r.useState)({});return(0,h.jsxs)(C,{className:bv,children:[(0,h.jsx)("h2",{className:wv,children:"Confluence Wizard"}),0===i&&(0,h.jsxs)("div",{className:Sv,children:[(0,h.jsx)("h3",{className:Ev,children:"Timeframe w\xe4hlen"}),(0,h.jsx)("div",{className:Tv,children:Uv.map(e=>(0,h.jsx)(p,{className:l[e]?"".concat(Iv," ").concat(kv):Iv,onClick:()=>(e=>{o(e);const t=l[e]||{confluence:{},extra:{}};f(t.confluence),g(t.extra),s(1)})(e),children:e},e))}),(0,h.jsx)("div",{className:Cv,children:(0,h.jsx)("div",{className:Av,children:0===Object.keys(l).length?(0,h.jsx)("span",{className:Pv,children:"Noch keine Auswahl f\xfcr Timeframes"}):Object.entries(l).map(e=>{let[t,n]=e;return(0,h.jsxs)("div",{className:Nv,children:[(0,h.jsx)("strong",{children:t}),(0,h.jsxs)("div",{className:xv,children:[Object.entries(n.confluence).filter(e=>{let[,t]=e;return t}).map(e=>{let[t]=e;return(0,h.jsx)("span",{children:t},t)}),Object.entries(n.extra).filter(e=>{let[,t]=e;return t}).map(e=>{let[t]=e;return(0,h.jsx)("span",{children:t},t)})]}),(0,h.jsx)("button",{className:Rv,onClick:()=>(e=>{u(t=>{const n=c({},t);return delete n[e],n})})(t),"aria-label":"Remove ".concat(t),children:"\u2715"})]},t)})})}),(0,h.jsxs)("div",{className:jv,children:[(0,h.jsx)(p,{className:Fv,onClick:n,children:"Abbrechen"}),(0,h.jsx)(p,{className:Mv,onClick:()=>{let e=c({},l);1===i&&a&&(e=c(c({},e),{},{[a]:{confluence:d,extra:m}})),t({selections:e})},children:"Fertig"})]})]}),1===i&&(0,h.jsxs)("div",{className:Sv,children:[(0,h.jsxs)("h3",{className:Ev,children:[a," Confluence ausw\xe4hlen"]}),(0,h.jsx)("div",{className:Dv,children:Bv.map(e=>(0,h.jsxs)("label",{className:Lv,children:[(0,h.jsx)("input",{type:"checkbox",checked:!!d[e],onChange:()=>{return t=e,void f(e=>c(c({},e),{},{[t]:!e[t]}));var t}}),(0,h.jsx)("span",{className:Ov,children:e})]},e))}),(0,h.jsx)("h4",{className:Ev,children:"Weitere Confluence"}),(0,h.jsx)("div",{className:Dv,children:Vv.map(e=>(0,h.jsxs)("label",{className:Lv,children:[(0,h.jsx)("input",{type:"checkbox",checked:!!m[e],onChange:()=>{return t=e,void g(e=>c(c({},e),{},{[t]:!e[t]}));var t}}),(0,h.jsx)("span",{className:Ov,children:e})]},e))}),(0,h.jsxs)("div",{className:jv,children:[(0,h.jsx)(p,{className:Fv,onClick:()=>{s(0)},children:"Zur\xfcck"}),(0,h.jsx)(p,{className:Mv,onClick:()=>{a&&(u(e=>c(c({},e),{},{[a]:{confluence:d,extra:m}})),o(""),f({}),g({}),s(0))},children:"Speichern"})]})]})]})}function Hv(e){let{open:t,onClose:n,onConfirm:r}=e;return t?(0,h.jsx)("div",{className:vv,role:"dialog","aria-modal":"true",children:(0,h.jsx)("div",{className:_v,children:(0,h.jsx)(zv,{onConfirm:e=>{"function"===typeof r&&r(e);try{globalThis.dispatchEvent(new CustomEvent("confluence-wizard:confirmed",{detail:e}))}catch(t){}n()},onCancel:n})})}):null}const Wv={modalBtn:"SetupSelector_modalBtn__h+wHs",selected:"SetupSelector_selected__adC8L",root:"SetupSelector_root__Xz7UO",chip:"SetupSelector_chip__WUk6F",chipSelected:"SetupSelector_chipSelected__yFMlc",chipRow:"SetupSelector_chipRow__C76d1"};function qv(e){let{selectedFibLevel:t,selectedConfluence:n,onChange:i}=e;const[s,a]=(0,r.useState)(!1),[o,l]=(0,r.useState)(!1);return(0,h.jsxs)("div",{className:Wv.root,children:[(0,h.jsxs)("div",{className:Wv.section,children:[(0,h.jsxs)("button",{type:"button",className:Wv.modalBtn,onClick:()=>a(!0),children:[(0,h.jsx)("span",{role:"img","aria-label":"SK Entry",style:{marginRight:8},children:"\ud83c\udfaf"}),t||"SK Entry w\xe4hlen"]}),(0,h.jsx)(yv,{open:s,selectedFibLevel:t,onChange:e=>{!function(e){i(e,n)}(e),a(!1)},onClose:()=>a(!1)})]}),(0,h.jsxs)("div",{className:Wv.section,children:[(0,h.jsxs)("button",{type:"button",className:Wv.modalBtn,onClick:()=>l(!0),children:[(0,h.jsx)("span",{role:"img","aria-label":"Confluence",style:{marginRight:8},children:"\u2728"}),n.length>0?"Confluence gew\xe4hlt":"Confluence ausw\xe4hlen"]}),(0,h.jsx)("div",{className:Wv.chipRow,style:{marginTop:8,justifyContent:"center"},children:0===n.length?(0,h.jsx)("span",{style:{color:"#888"},children:"Keine Confluence gew\xe4hlt"}):(0,h.jsx)("span",{style:{color:"var(--color-text)",fontWeight:500},children:n.map(e=>e.timeframe?"".concat(e.timeframe," ").concat(e.type):e.type).join(", ")})}),(0,h.jsx)(Hv,{open:o,onClose:()=>l(!1),onConfirm:e=>{const n=[];try{const t=null===e||void 0===e?void 0:e.selections;if(t)for(const[e,r]of Object.entries(t)){const t=null===r||void 0===r?void 0:r.confluence,i=null===r||void 0===r?void 0:r.extra;if(t)for(const[r,s]of Object.entries(t))s&&n.push({timeframe:e,type:r});if(i)for(const[e,r]of Object.entries(i))r&&n.push({type:e})}else{const t=null===e||void 0===e?void 0:e.timeframe,r=null===e||void 0===e?void 0:e.confluence,i=null===e||void 0===e?void 0:e.extra;if(r&&t)for(const[e,s]of Object.entries(r))s&&n.push({timeframe:t,type:e});if(i)for(const[e,s]of Object.entries(i))s&&n.push({type:e})}}catch(r){}i(t,n),l(!1)}})]})]})}function Gv(e){var t,n,r,i,s;let{form:a,formErrors:o,touched:l,formSubmitted:c,formKey:u,debugUiEnabled:d,lastStatus:f,onChangeForm:m,onBlurField:g,onSubmit:y,onReset:v,setMarketFilter:_}=e;const b=a.analysisId?(0,h.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,h.jsx)("span",{style:{fontSize:12,color:"var(--muted)"},children:"Prefilled from analysis"}),(0,h.jsx)(p,{type:"button",variant:"ghost",onClick:()=>{try{var e;window.location.hash="#/analysis?id=".concat(encodeURIComponent(null!==(e=a.analysisId)&&void 0!==e?e:"")),setTimeout(()=>{try{window.dispatchEvent(new CustomEvent("open-analysis",{detail:{id:a.analysisId}}))}catch(e){}},50)}catch(t){}},className:hv.viewAnalysisBtn,style:{padding:"6px 8px",borderRadius:6},children:"View Analysis"})]}):void 0;return(0,h.jsx)(_e,{title:"New Trade",actions:b,children:(0,h.jsxs)("div",{className:hv.newTradeWrapper,children:[d&&(f||Object.keys(o).length>0)&&(0,h.jsxs)("div",{className:hv.inlineStatus,style:{margin:"8px 0",color:"var(--muted)"},children:[f&&(0,h.jsxs)("div",{style:{marginBottom:6},children:[(0,h.jsx)("strong",{children:"Status:"})," ",f]}),Object.keys(o).length>0&&(0,h.jsxs)("div",{style:{color:"var(--accent-error)"},children:[(0,h.jsx)("strong",{children:"Form errors:"}),(0,h.jsx)("ul",{style:{margin:"6px 0 0 16px"},children:Object.entries(o).map(e=>{let[t,n]=e;return(0,h.jsxs)("li",{children:[t,": ",n]},t)})})]})]}),(0,h.jsxs)("form",{className:hv.form,onSubmit:y,children:[(0,h.jsx)("input",{id:"entryDate",type:"hidden",value:a.entryDate}),(0,h.jsx)("input",{id:"analysisId",type:"hidden",value:null!==(t=a.analysisId)&&void 0!==t?t:""}),(0,h.jsxs)("div",{className:hv.newTradeGrid,children:[(0,h.jsxs)("div",{className:hv.newTradeField,children:[(0,h.jsx)(se,{label:"Market",value:null!==(n=a.market)&&void 0!==n?n:"",onChange:e=>{m({market:e}),g("market"),e&&_(e)},compact:!0,showAll:!1,hasError:Boolean(o.market&&(l.market||c)),ariaDescribedBy:o.market&&(l.market||c)?"market-error":void 0}),o.market&&(l.market||c)&&(0,h.jsx)("div",{id:"market-error",className:hv.fieldError,children:o.market})]}),(0,h.jsxs)("div",{className:hv.newTradeField,children:[(0,h.jsx)(J,{id:"symbol",label:"Symbol",placeholder:"e.g. BTC",value:a.symbol,onChange:e=>m({symbol:e.target.value}),onBlur:()=>g("symbol"),hasError:Boolean(o.symbol&&(l.symbol||c)),"aria-describedby":o.symbol&&(l.symbol||c)?"symbol-error":void 0}),o.symbol&&(l.symbol||c)&&(0,h.jsx)("div",{id:"symbol-error",className:hv.fieldError,children:o.symbol})]}),(0,h.jsx)("div",{className:hv.newTradeField,children:(0,h.jsx)(qv,{selectedFibLevel:null!==(r=a.fibLevel)&&void 0!==r?r:null,selectedConfluence:null!==(i=a.confluence)&&void 0!==i?i:[],onChange:(e,t)=>{m({fibLevel:e,confluence:t})}})}),(0,h.jsxs)("div",{className:hv.newTradeField,children:[(0,h.jsx)(J,{id:"price",label:"Entry Price *",type:"number",value:"number"===typeof a.price?String(a.price):"",onChange:e=>m({price:""===e.target.value?void 0:Number(e.target.value)}),onBlur:()=>g("price"),hasError:Boolean(o.price&&(l.price||c)),"aria-describedby":o.price&&(l.price||c)?"price-error":void 0}),o.price&&(l.price||c)&&(0,h.jsx)("div",{id:"price-error",className:hv.fieldError,children:o.price})]}),(0,h.jsxs)("div",{className:hv.newTradeField,children:[(0,h.jsx)(J,{id:"margin",label:"Margin *",type:"number",value:"number"===typeof a.margin?String(a.margin):"",onChange:e=>m({margin:""===e.target.value?void 0:Number(e.target.value)}),onBlur:()=>g("margin"),hasError:Boolean(o.margin&&(l.margin||c)),"aria-describedby":o.margin&&(l.margin||c)?"margin-error":void 0}),o.margin&&(l.margin||c)&&(0,h.jsx)("div",{id:"margin-error",className:hv.fieldError,children:o.margin})]}),(0,h.jsxs)("div",{className:hv.newTradeField,children:[(0,h.jsx)(J,{id:"leverage",label:"Leverage *",type:"number",value:"number"===typeof a.leverage?String(a.leverage):"",onChange:e=>m({leverage:""===e.target.value?void 0:Number(e.target.value)}),onBlur:()=>g("leverage"),hasError:Boolean(o.leverage&&(l.leverage||c)),"aria-describedby":o.leverage&&(l.leverage||c)?"leverage-error":void 0}),o.leverage&&(l.leverage||c)&&(0,h.jsx)("div",{id:"leverage-error",className:hv.fieldError,children:o.leverage})]}),(0,h.jsxs)("div",{className:hv.newTradeField,children:[(0,h.jsx)(J,{id:"size",label:"Position Size *",type:"number",value:"number"===typeof a.size?String(a.size):"",onChange:e=>m({size:""===e.target.value?void 0:Number(e.target.value)}),onBlur:()=>g("size"),hasError:Boolean(o.size&&(l.size||c)),"aria-describedby":o.size&&(l.size||c)?"size-error":void 0}),o.size&&(l.size||c)&&(0,h.jsx)("div",{id:"size-error",className:hv.fieldError,children:o.size})]}),(0,h.jsxs)("div",{className:hv.newTradeField,children:[(0,h.jsx)(rv,{label:"Side",value:a.side,onChange:e=>m({side:e}),ariaLabel:"New trade side",showBadge:!1,colored:!0,onBlur:()=>g("side"),hasError:Boolean(o.side&&(l.side||c)),ariaDescribedBy:o.side&&(l.side||c)?"side-error":void 0}),o.side&&(l.side||c)&&(0,h.jsx)("div",{id:"side-error",className:hv.fieldError,children:o.side})]}),(0,h.jsxs)("div",{className:hv.newTradeField,children:[(0,h.jsx)(J,{id:"sl",label:"Stop Loss (SL) *",type:"number",value:"number"===typeof a.sl?String(a.sl):"",onChange:e=>m({sl:""===e.target.value?void 0:Number(e.target.value)}),onBlur:()=>g("sl"),hasError:Boolean(o.sl&&(l.sl||c)),"aria-describedby":o.sl&&(l.sl||c)?"sl-error":void 0}),o.sl&&(l.sl||c)&&(0,h.jsx)("div",{id:"sl-error",className:hv.fieldError,children:o.sl})]}),(0,h.jsxs)("div",{className:hv.tpFullWidthRow,children:[(0,h.jsxs)("div",{className:hv.tpField,children:[(0,h.jsx)(J,{id:"tp1",label:"TP1",type:"number",value:"number"===typeof a.tp1?String(a.tp1):"",onChange:e=>m({tp1:""===e.target.value?void 0:Number(e.target.value)}),onBlur:()=>g("tp1"),hasError:Boolean(o.tp1&&(l.tp1||c)),"aria-describedby":o.tp1&&(l.tp1||c)?"tp1-error":void 0}),o.tp1&&(l.tp1||c)&&(0,h.jsx)("div",{id:"tp1-error",className:hv.fieldError,children:o.tp1})]}),(0,h.jsxs)("div",{className:hv.tpField,children:[(0,h.jsx)(J,{id:"tp2",label:"TP2",type:"number",value:"number"===typeof a.tp2?String(a.tp2):"",onChange:e=>m({tp2:""===e.target.value?void 0:Number(e.target.value)}),onBlur:()=>g("tp2"),hasError:Boolean(o.tp2&&(l.tp2||c)),"aria-describedby":o.tp2&&(l.tp2||c)?"tp2-error":void 0}),o.tp2&&(l.tp2||c)&&(0,h.jsx)("div",{id:"tp2-error",className:hv.fieldError,children:o.tp2})]}),(0,h.jsxs)("div",{className:hv.tpField,children:[(0,h.jsx)(J,{id:"tp3",label:"TP3",type:"number",value:"number"===typeof a.tp3?String(a.tp3):"",onChange:e=>m({tp3:""===e.target.value?void 0:Number(e.target.value)}),onBlur:()=>g("tp3"),hasError:Boolean(o.tp3&&(l.tp3||c)),"aria-describedby":o.tp3&&(l.tp3||c)?"tp3-error":void 0}),o.tp3&&(l.tp3||c)&&(0,h.jsx)("div",{id:"tp3-error",className:hv.fieldError,children:o.tp3})]}),(0,h.jsxs)("div",{className:hv.tpField,children:[(0,h.jsx)(J,{id:"tp4",label:"TP4",type:"number",value:"number"===typeof a.tp4?String(a.tp4):"",onChange:e=>m({tp4:""===e.target.value?void 0:Number(e.target.value)}),onBlur:()=>g("tp4"),hasError:Boolean(o.tp4&&(l.tp4||c)),"aria-describedby":o.tp4&&(l.tp4||c)?"tp4-error":void 0}),o.tp4&&(l.tp4||c)&&(0,h.jsx)("div",{id:"tp4-error",className:hv.fieldError,children:o.tp4})]})]}),(0,h.jsx)("div",{className:hv.notesFullWidthField,children:(0,h.jsx)(J,{id:"notes",label:"Notes",value:null!==(s=a.notes)&&void 0!==s?s:"",onChange:e=>m({notes:e.target.value})})})]}),(0,h.jsxs)("div",{className:hv.actionsRow,children:[(0,h.jsxs)("div",{className:hv.statusActionField,children:[(0,h.jsx)(dv,{label:"Status",value:a.status,onChange:e=>{m({status:e}),g("status")},onBlur:()=>g("status"),hasError:Boolean(o.status&&(l.status||c)),ariaDescribedBy:o.status&&(l.status||c)?"status-error":void 0}),o.status&&(l.status||c)&&(0,h.jsx)("div",{id:"status-error",className:hv.fieldError,children:o.status})]}),(0,h.jsxs)("div",{className:hv.actions,children:[(0,h.jsx)(p,{variant:"ghost",onClick:v,title:"Reset form fields to defaults","aria-label":"Reset new trade form",children:"Reset"}),(0,h.jsx)(p,{type:"submit",variant:"primary",children:a.analysisId?"Add (from Analysis)":"Add"})]})]})]},u)]})})}const Kv=function(e){let{mode:t,isMobile:n,form:r,formErrors:i,touched:s,formSubmitted:a,formKey:o,debugUiEnabled:l,lastStatus:c,onChangeForm:u,onBlurField:d,onSubmit:f,onReset:p,setMarketFilter:m,onSaveAnalysis:g,initialAnalysis:y}=e;return"analysis"===t?(0,h.jsx)("div",{"data-testid":"add-panel-analysis",children:(0,h.jsx)(_e,{title:"Add Analysis",children:(0,h.jsx)("div",{style:{marginTop:12},children:(0,h.jsx)(we,{initial:y,onSave:g})})})}):(0,h.jsx)("div",{"data-testid":"add-panel-trade",children:!n&&(0,h.jsx)(Gv,{form:r,formErrors:null!==i&&void 0!==i?i:{},touched:null!==s&&void 0!==s?s:{},formSubmitted:null!==a&&void 0!==a&&a,formKey:null!==o&&void 0!==o?o:0,debugUiEnabled:null!==l&&void 0!==l&&l,lastStatus:null!==c&&void 0!==c?c:null,onChangeForm:null!==u&&void 0!==u?u:()=>{},onBlurField:null!==d&&void 0!==d?d:()=>{},onSubmit:null!==f&&void 0!==f?f:()=>{},onReset:null!==p&&void 0!==p?p:()=>{},setMarketFilter:null!==m&&void 0!==m?m:()=>{}})})};const Jv=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:480;const[t,n]=(0,r.useState)(()=>{const t=globalThis;if("undefined"===typeof globalThis||"undefined"===typeof t.matchMedia)return!1;try{var n,r;return null!==(n=null===(r=t.matchMedia)||void 0===r?void 0:r.call(t,"(max-width:".concat(e,"px)")).matches)&&void 0!==n&&n}catch(i){return!1}});return(0,r.useEffect)(()=>{const t=globalThis;if("undefined"===typeof globalThis||"undefined"===typeof t.matchMedia)return;const r=t.matchMedia("(max-width:".concat(e,"px)")),i=e=>n(e.matches);try{r.addEventListener("change",i)}catch(o){var s,a;null===(s=(a=r).addListener)||void 0===s||s.call(a,i)}return n(r.matches),()=>{try{r.removeEventListener("change",i)}catch(n){var e,t;null===(e=(t=r).removeListener)||void 0===e||e.call(t,i)}}},[e]),t};const Qv=function(e){let{isMobile:t,newTradeModalOpen:n,setNewTradeModalOpen:r,form:i,formErrors:s,touched:a,formSubmitted:o,formKey:l,debugUiEnabled:c,lastStatus:u,onChangeForm:d,onBlurField:f,onSubmit:g,onReset:y,setMarketFilter:v}=e;return t?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:m.mobileNewTradeBtnWrap,children:(0,h.jsx)("button",{type:"button",className:m.mobileNewTradeBtn,onClick:()=>r(!0),children:"New Trade"})}),n&&(0,h.jsx)("div",{className:m.mobileModalBackdrop,role:"dialog","aria-modal":"true",tabIndex:-1,onClick:()=>r(!1),children:(0,h.jsxs)("div",{className:m.mobileModalContent,onClick:e=>e.stopPropagation(),tabIndex:0,children:[(0,h.jsx)("button",{type:"button","aria-label":"Close",onClick:()=>r(!1),style:{position:"absolute",top:8,right:8,background:"none",border:"none",fontSize:22,cursor:"pointer"},children:"\xd7"}),(0,h.jsx)("div",{style:{marginBottom:12,fontWeight:700,fontSize:18},children:"New Trade"}),(0,h.jsx)(Gv,{form:i,formErrors:s,touched:a,formSubmitted:o,formKey:l,debugUiEnabled:c,lastStatus:u,onChangeForm:d,onBlurField:f,onSubmit:g,onReset:y,setMarketFilter:v}),(0,h.jsxs)("div",{className:m.mobileModalFooter,children:[(0,h.jsx)(p,{variant:"ghost",onClick:()=>r(!1),children:"Close"}),(0,h.jsx)(p,{variant:"primary",onClick:async()=>{try{await g()}catch(e){}},children:"Add"})]})]})})]}):null},Yv="mt_user_settings_v1";function Xv(){try{const e=window.localStorage.getItem(Yv);return e?JSON.parse(e):{}}catch(e){return console.warn("Failed to load settings",e),{}}}function Zv(e){try{window.localStorage.setItem(Yv,JSON.stringify(e))}catch(t){console.warn("Failed to save settings",t)}}const $v=[{id:"c1",market:"Crypto",symbol:"ETHUSD",entryDate:"2025-12-23T12:10:00Z",size:.25,price:1850,side:"LONG",status:"OPEN",pnl:12.3,notes:"Mean-reversion entry",entry:"1848",sl:1820,tp1:1875,tp2:1900,tp3:1950,tp4:2e3,margin:80,leverage:5},{id:"c2",market:"Crypto",symbol:"BTCUSD",entryDate:"2025-12-23T11:45:00Z",size:.08,price:43e3,side:"SHORT",status:"OPEN",pnl:-40,notes:"Fading breakout",entry:"43050",sl:43500,tp1:42500,tp2:42e3,tp3:40500,tp4:4e4,margin:700,leverage:10},{id:"c3",market:"Crypto",symbol:"SOLUSD",entryDate:"2025-12-23T10:20:00Z",size:15,price:98.2,side:"LONG",status:"OPEN",pnl:6.1,notes:"Breakout retest",entry:"97.5",sl:95,tp1:104,tp2:110,tp3:120,tp4:130,margin:150,leverage:4},{id:"c4",market:"Crypto",symbol:"ADAUSD",entryDate:"2025-12-23T09:35:00Z",size:300,price:1.34,side:"SHORT",status:"CLOSED",pnl:-3.5,notes:"News spike",entry:"1.36",sl:1.4,tp1:1.3,tp2:1.25,tp3:1.2,tp4:1.15,margin:60,leverage:8},{id:"c5",market:"Crypto",symbol:"XRPUSD",entryDate:"2025-12-23T08:50:00Z",size:600,price:.98,side:"LONG",status:"OPEN",pnl:10,notes:"Range trade",entry:"0.97",sl:.93,tp1:1.02,tp2:1.08,tp3:1.15,tp4:1.22,margin:40,leverage:6},{id:"c6",market:"Crypto",symbol:"MATICUSD",entryDate:"2025-12-23T07:30:00Z",size:400,price:2.2,side:"LONG",status:"OPEN",pnl:2.2,notes:"Accumulation area",entry:"2.18",sl:2.05,tp1:2.35,tp2:2.6,tp3:3,tp4:3.5,margin:70,leverage:5},{id:"c7",market:"Crypto",symbol:"DOTUSD",entryDate:"2025-12-23T06:15:00Z",size:120,price:7.8,side:"SHORT",status:"OPEN",pnl:-1.1,notes:"Momentum fade",entry:"7.95",sl:8.5,tp1:7.2,tp2:6.8,tp3:6,tp4:5.5,margin:60,leverage:6},{id:"c8",market:"Crypto",symbol:"LINKUSD",entryDate:"2025-12-23T05:50:00Z",size:90,price:18.2,side:"LONG",status:"OPEN",pnl:4,notes:"Bull flag",entry:"18.0",sl:17.2,tp1:19.5,tp2:21,tp3:24,tp4:27,margin:120,leverage:3},{id:"c9",market:"Crypto",symbol:"AVAXUSD",entryDate:"2025-12-23T05:10:00Z",size:40,price:38.4,side:"LONG",status:"OPEN",pnl:8.5,notes:"Dip buy",entry:"37.8",sl:36,tp1:40,tp2:42.5,tp3:48,tp4:55,margin:90,leverage:4},{id:"c10",market:"Crypto",symbol:"SOLUSD",entryDate:"2025-12-24T02:00:00Z",size:5,price:100,side:"LONG",status:"CLOSED",pnl:25,notes:"Scalp",entry:"99.5",sl:98,tp1:101,tp2:105,tp3:110,tp4:115,margin:60,leverage:2}],e_=[{id:"f1",market:"Forex",symbol:"EURUSD",entryDate:"2025-12-23T14:00:00Z",size:12e3,price:1.118,side:"SHORT",status:"OPEN",pnl:-6.4,notes:"Breakdown",entry:"1.1185",sl:1.121,tp1:1.112,tp2:1.108,tp3:1.102,tp4:1.098,margin:110,leverage:20},{id:"f2",market:"Forex",symbol:"GBPUSD",entryDate:"2025-12-23T13:30:00Z",size:9e3,price:1.3255,side:"LONG",status:"OPEN",pnl:8,notes:"Momentum play",entry:"1.3240",sl:1.32,tp1:1.335,tp2:1.345,tp3:1.36,tp4:1.375,margin:130,leverage:15},{id:"f3",market:"Forex",symbol:"USDJPY",entryDate:"2025-12-23T12:45:00Z",size:6e3,price:135.1,side:"SHORT",status:"OPEN",pnl:-2,notes:"Reversal",entry:"135.50",sl:136,tp1:134.2,tp2:133.5,tp3:132,tp4:130.5,margin:140,leverage:25},{id:"f4",market:"Forex",symbol:"AUDUSD",entryDate:"2025-12-23T11:20:00Z",size:7500,price:.752,side:"LONG",status:"CLOSED",pnl:15.1,notes:"Fed comments",entry:"0.7480",sl:.745,tp1:.76,tp2:.77,tp3:.78,tp4:.79,margin:95,leverage:10},{id:"f5",market:"Forex",symbol:"USDCAD",entryDate:"2025-12-23T10:40:00Z",size:5e3,price:1.275,side:"LONG",status:"OPEN",pnl:1.2,notes:"Carry trade",entry:"1.2740",sl:1.27,tp1:1.279,tp2:1.285,tp3:1.295,tp4:1.305,margin:80,leverage:12},{id:"f6",market:"Forex",symbol:"NZDUSD",entryDate:"2025-12-23T09:50:00Z",size:4e3,price:.6785,side:"SHORT",status:"OPEN",pnl:-.8,notes:"Trend continuation",entry:"0.6792",sl:.682,tp1:.675,tp2:.67,tp3:.665,tp4:.66,margin:60,leverage:15},{id:"f7",market:"Forex",symbol:"EURJPY",entryDate:"2025-12-23T08:30:00Z",size:3e3,price:151.4,side:"LONG",status:"OPEN",pnl:5,notes:"Correlation play",entry:"151.10",sl:150.5,tp1:152,tp2:153,tp3:155,tp4:157,margin:120,leverage:10},{id:"f8",market:"Forex",symbol:"GBPJPY",entryDate:"2025-12-23T07:20:00Z",size:2500,price:179.55,side:"SHORT",status:"OPEN",pnl:-7.3,notes:"Volatility spike",entry:"179.90",sl:181,tp1:178,tp2:176.5,tp3:174,tp4:172,margin:200,leverage:8}],t_=[...$v,...e_];async function n_(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5;const s=[],a=Array.isArray(t)&&t.length>0?[...t]:[],o=[];for(;o.length<i&&a.length>0;){const e=Math.floor(Math.random()*a.length);o.push(a.splice(e,1)[0])}const l=e;for(const f of o)try{var c;const e=f,t=e.symbol;let n="UNKNOWN";var u;if(t&&"object"===typeof t&&"value"in t)n=String(null!==(u=t.value)&&void 0!==u?u:"UNKNOWN");else"string"===typeof t&&(n=t);const i=[{key:"double-advantage"},{key:"ema-50-daily"},{key:"fib-level",value:"0.618 (94660.7)"},{key:"liquidity-cluster"},{key:"fair-value-gap"}],a=[i[2],i[Math.floor(2*Math.random())],i[3+Math.floor(2*Math.random())]],o=["monthly","weekly","daily","4h","2h","1h","15min"].map((e,t)=>({timeframe:e,note:"".concat(e.toUpperCase()," note for ").concat(n),tradingViewLink:"https://tradingview.com/chart/".concat(n,"/").concat(e,"?mock=").concat(t)})),h={symbol:n,market:null!==(c=e.market)&&void 0!==c?c:void 0,notes:"Mock analysis for ".concat(n),setups:a,timeframes:o},p=Vy.create(h),m=Vy.toDTO(p);if(s.push(m),l&&"function"===typeof l.save&&await l.save(m),r&&"function"===typeof r.update)try{const e=Bg.toDTO(f);e.analysisId=p.id.value;const t=Bg.create(e);await r.update(t)}catch(d){console.warn("Failed to link analysis to trade",d)}}catch(d){console.warn("Failed to create mock analysis for trade",d)}if(l&&"function"===typeof l.seed)try{l.seed(s)}catch(d){console.warn("seed() call for analyses failed",d)}if(l&&"function"===typeof l.listAll)try{return void n(await l.listAll())}catch(h){}n(s)}async function r_(e,t){if(e){try{const t=e;if(t&&"function"===typeof t.clear)await t.clear();else if(t&&"function"===typeof t.listAll){const n=await t.listAll();for(const t of n)"function"===typeof e.delete&&await e.delete(t.id)}}catch(n){console.warn("Failed to clear analyses",n)}t([])}else t([])}const i_=function(e){let{open:t,onClose:n,repoRef:i,setPositions:s,analysisService:a}=e;const[o,l]=(0,r.useState)("both"),[u,d]=(0,r.useState)(!1);return t?(0,h.jsx)("div",{className:m.backdrop,role:"dialog","aria-modal":"true",children:(0,h.jsxs)("div",{className:m.mockDialog,children:[(0,h.jsx)("h3",{children:"Lade Mock-Daten"}),(0,h.jsx)("p",{children:"W\xe4hle welches Set an Testdaten du laden m\xf6chtest. Bereits vorhandene Daten bleiben erhalten."}),(0,h.jsxs)("div",{style:{display:"flex",gap:8,marginTop:12,marginBottom:12},children:[(0,h.jsx)(p,{variant:"crypto"===o?"primary":"ghost",onClick:()=>l("crypto"),children:"Crypto"}),(0,h.jsx)(p,{variant:"forex"===o?"primary":"ghost",onClick:()=>l("forex"),children:"Forex"}),(0,h.jsx)(p,{variant:"both"===o?"primary":"ghost",onClick:()=>l("both"),children:"Both"})]}),(0,h.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[(0,h.jsx)(p,{variant:"ghost",onClick:n,children:"Cancel"}),(0,h.jsx)(p,{variant:"primary",onClick:async()=>{d(!0);try{const t="crypto"===o?$v:"forex"===o?e_:t_;if(await async function(e,t,n){const r=e;if(r&&"function"===typeof r.seed)try{r.seed(t)}catch(i){console.error("seed() call failed",i)}else if(r&&"function"===typeof r.save)for(const s of t)try{const e=Bg.create(s);await r.save(e)}catch(i){console.error("Failed to save mock trade via save()",i)}else n(e=>[...t.map(e=>c({},e)).map(e=>{var t;return c(c({},e),{},{entryDate:hg.toInputValue(e.entryDate),status:null!==(t=e.status)&&void 0!==t?t:"OPEN"})}),...e]);if(e&&"function"===typeof e.getAll)try{const t=(await e.getAll()).map(e=>Bg.toDTO(e));n(t)}catch(i){console.error("Failed to reload trades after seeding",i)}}(i.current,t,s),await async function(e,t,n){const r=[];for(const o of n)try{const n=await e.createAnalysis(o);if(r.push(n),t)try{const e=(await t.getAll()).find(e=>String(Bg.toDTO(e).symbol||"").toUpperCase()===String(o.symbol).toUpperCase());if(e){const r=Bg.toDTO(e);r.analysisId=n.id;const i=Bg.create(r);await t.update(i)}}catch(i){}}catch(s){}try{globalThis.dispatchEvent(new CustomEvent("analyses-updated",{detail:{type:"seeded"}}))}catch(a){}return r}(a,i.current,[{symbol:"BTCUSD",market:"Crypto",notes:"BTC seeded analyses with TradingView links",timeframes:[{timeframe:"4h",tradingViewLink:"https://www.tradingview.com/x/zuXCVxnH/"},{timeframe:"1h",tradingViewLink:"https://www.tradingview.com/x/zuXCVxnH/"},{timeframe:"daily",tradingViewLink:"https://www.tradingview.com/x/zuXCVxnH/"},{timeframe:"2h",tradingViewLink:"https://www.tradingview.com/x/zuXCVxnH/"},{timeframe:"15min",tradingViewLink:"https://www.tradingview.com/x/zuXCVxnH/"},{timeframe:"weekly",tradingViewLink:"https://www.tradingview.com/x/zuXCVxnH/"},{timeframe:"monthly",tradingViewLink:"https://www.tradingview.com/x/zuXCVxnH/"}]},{symbol:"USDCAD",market:"Forex",notes:"USDCAD seeded analyses with TradingView links",timeframes:[{timeframe:"4h",tradingViewLink:"https://www.tradingview.com/x/MGlHVCHj/"},{timeframe:"1h",tradingViewLink:"https://www.tradingview.com/x/MGlHVCHj/"},{timeframe:"daily",tradingViewLink:"https://www.tradingview.com/x/MGlHVCHj/"},{timeframe:"2h",tradingViewLink:"https://www.tradingview.com/x/MGlHVCHj/"},{timeframe:"15min",tradingViewLink:"https://www.tradingview.com/x/MGlHVCHj/"},{timeframe:"weekly",tradingViewLink:"https://www.tradingview.com/x/MGlHVCHj/"},{timeframe:"monthly",tradingViewLink:"https://www.tradingview.com/x/MGlHVCHj/"}]},{symbol:"ETHUSD",market:"Crypto",notes:"ETH 4H seeded from mock loader",timeframes:[{timeframe:"4h",tradingViewLink:"https://www.tradingview.com/chart/?symbol=BINANCE:ETHUSDT"},{timeframe:"1h",tradingViewLink:"https://www.tradingview.com/chart/?symbol=BINANCE:ETHUSDT"},{timeframe:"daily",tradingViewLink:"https://www.tradingview.com/chart/?symbol=BINANCE:ETHUSDT"},{timeframe:"weekly",tradingViewLink:"https://www.tradingview.com/chart/?symbol=BINANCE:ETHUSDT"}]},{symbol:"EURUSD",market:"Forex",notes:"EURUSD seeded from mock loader",timeframes:[{timeframe:"4h",tradingViewLink:"https://www.tradingview.com/chart/?symbol=FX:EURUSD"},{timeframe:"1h",tradingViewLink:"https://www.tradingview.com/chart/?symbol=FX:EURUSD"},{timeframe:"daily",tradingViewLink:"https://www.tradingview.com/chart/?symbol=FX:EURUSD"},{timeframe:"weekly",tradingViewLink:"https://www.tradingview.com/chart/?symbol=FX:EURUSD"}]},{symbol:"GBPUSD",market:"Forex",notes:"GBPUSD seeded from mock loader",timeframes:[{timeframe:"4h",tradingViewLink:"https://www.tradingview.com/chart/?symbol=FX:GBPUSD"},{timeframe:"1h",tradingViewLink:"https://www.tradingview.com/chart/?symbol=FX:GBPUSD"},{timeframe:"daily",tradingViewLink:"https://www.tradingview.com/chart/?symbol=FX:GBPUSD"},{timeframe:"weekly",tradingViewLink:"https://www.tradingview.com/chart/?symbol=FX:GBPUSD"}]}]),i.current&&"function"===typeof i.current.getAll)try{const e=(await i.current.getAll()).map(e=>Bg.toDTO(e));s(e)}catch(e){}}finally{d(!1),n()}},children:u?"Loading\u2026":"Load"})]})]})}):null},s_={list:"TradeList_list__j0GbO",item:"TradeList_item__eGiun",selected:"TradeList_selected__52-ZM",rowLeft:"TradeList_rowLeft__UCVkT",symbol:"TradeList_symbol__kXp64",analysisLinkBadge:"TradeList_analysisLinkBadge__HE0dc",meta:"TradeList_meta__S-tEo",rowRight:"TradeList_rowRight__w+Ouk",analysisBtn:"TradeList_analysisBtn__DJ9nu",analysisContent:"TradeList_analysisContent__LrlwG",analysisIcon:"TradeList_analysisIcon__qPITs",analysisLinkIcon:"TradeList_analysisLinkIcon__N-Yfs",metrics:"TradeList_metrics__2oSJY",metricItem:"TradeList_metricItem__DdIeR",metricLabel:"TradeList_metricLabel__6B7Dv",metricValue:"TradeList_metricValue__glVzq",metricInteractive:"TradeList_metricInteractive__2QBX7",metricPositive:"TradeList_metricPositive__v2gua",metricNegative:"TradeList_metricNegative__m72yd",metricsCompact:"TradeList_metricsCompact__54s0Q",tpLevelsCompact:"TradeList_tpLevelsCompact__v71kl",tpValues:"TradeList_tpValues__KlL97",tpMetaDate:"TradeList_tpMetaDate__kUyHc",actionDropdownWrap:"TradeList_actionDropdownWrap__SKsbl",deleteBtn:"TradeList_deleteBtn__j2isi",side:"TradeList_side__-Lerh",sideLong:"TradeList_sideLong__gHN2u",sideShort:"TradeList_sideShort__4U9vW",sideCompact:"TradeList_sideCompact__8iheV",status:"TradeList_status__dhEyy",statusOpen:"TradeList_statusOpen__lYQGE",statusClosed:"TradeList_statusClosed__hYREW",statusFilled:"TradeList_statusFilled__njzoj",compact:"TradeList_compact__uuI2D"},a_={card:"PositionCard_card__bmj0M",left:"PositionCard_left__o8Fvq",symbol:"PositionCard_symbol__7bVoZ",meta:"PositionCard_meta__L+6LJ",sideLong:"PositionCard_sideLong__1yyHE",sideShort:"PositionCard_sideShort__NDz3c",right:"PositionCard_right__TP1ZB",pnlPositive:"PositionCard_pnlPositive__q8pkG",pnlNegative:"PositionCard_pnlNegative__AozEU",expandBtn:"PositionCard_expandBtn__fFFl0",actions:"PositionCard_actions__I09Mx",small:"PositionCard_small__E-wMO",compact:"PositionCard_compact__2-Lft"};function o_(e){let{id:t,symbol:n,side:r,size:i,entry:s,sl:a,pnl:o,onExpand:l,onToggleSide:c,onClose:u,onSetSLtoBE:d,onSetSLHit:f,onSetTPHit:p,onMarkClosed:m,onMarkOpen:g,onDelete:y,tp1IsHit:v,tp2IsHit:_,tp3IsHit:b,tp4IsHit:w}=e;const E="LONG"===r?a_.sideLong:a_.sideShort,S={},T={1:Boolean(v),2:Boolean(_),3:Boolean(b),4:Boolean(w)};if(c){const e="LONG"===r?"SHORT":"LONG";S["toggle-side"]={value:"toggle-side",label:"Switch to ".concat(e),onSelect:()=>c(t)}}d&&(S["sl-be"]={value:"sl-be",label:"Set SL to BE",onSelect:()=>d(t),variant:"success"}),g&&(S["status-open"]={value:"status-open",label:"Mark OPEN",onSelect:()=>g(t)}),m&&(S["status-closed"]={value:"status-closed",label:"Mark CLOSED",onSelect:()=>m(t)}),f&&(S["sl-hit"]={value:"sl-hit",label:"Mark SL hit",onSelect:()=>f(t)}),p&&["1","2","3","4"].forEach(e=>{const n=Number(e),r="tp-".concat(e),i=T[n];S[r]={value:r,label:i?"Clear TP".concat(e," hit"):"Mark TP".concat(e," hit"),onSelect:()=>p(t,n),variant:i?void 0:"success"}}),u&&(S.filled={value:"filled",label:"Mark FILLED",onSelect:()=>u(t)}),y&&(S.delete={value:"delete",label:"Delete",onSelect:()=>y(t)});const I=["sl-be","sl-hit","tp-1","tp-2","tp-3","tp-4","status-open","status-closed","filled","delete","toggle-side"].map(e=>S[e]).filter(e=>Boolean(e));return(0,h.jsxs)("div",{className:a_.card,role:"group","aria-labelledby":"pos-".concat(t,"-symbol"),children:[(0,h.jsxs)("div",{className:a_.left,children:[(0,h.jsx)("div",{id:"pos-".concat(t,"-symbol"),className:a_.symbol,children:n}),(0,h.jsxs)("div",{className:[a_.meta,E].filter(Boolean).join(" "),children:[r," \xb7 ",i]}),s&&(0,h.jsxs)("div",{className:a_.small,children:["Entry: ",s]}),a&&(0,h.jsxs)("div",{className:a_.small,children:["SL: ",a]})]}),(0,h.jsxs)("div",{className:a_.right,children:[(0,h.jsx)("div",{className:o>=0?a_.pnlPositive:a_.pnlNegative,children:o.toFixed(2)}),(0,h.jsxs)("div",{className:a_.actions,children:[I.length>0&&(0,h.jsx)(py,{options:I,ariaLabel:"Aktionen f\xfcr ".concat(n),size:"compact"}),(0,h.jsx)("button",{type:"button",className:a_.expandBtn,onClick:()=>null===l||void 0===l?void 0:l(t),"aria-label":"Toggle details for ".concat(n),children:"\u25b8"})]})]})]})}const l_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return"number"===typeof e?e.toFixed(t):"-"},c_=e=>{if("number"!==typeof e)return"-";const t=Number.isInteger(e)?0:1;return"".concat(e.toFixed(t),"x")},u_=e=>"number"===typeof e?e.toString():"-",d_=new Set(["price","size","sl","tp1","tp2","tp3","tp4","margin","leverage"]),h_="0.0001",f_="0.01",p_="0.0001",m_="0.0001",g_="0.0001",y_="0.0001",v_="0.01",__="0.1",b_=(e,t)=>{const n=t?"positive":"number"===typeof e?0===e?"positive":"negative":void 0;return{label:"SL",value:t?"0.0":l_(e,2),accent:n,focusField:"sl",rawValue:t?0:e,inputType:"number",step:"0.0001"}};function w_(e){let{trade:t,extraClass:n}=e;const r=[d.button,n||""].filter(Boolean).join(" "),i=Boolean(t.analysisId),s=i?(0,h.jsxs)("svg",{className:s_.analysisIcon,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:[(0,h.jsx)("path",{d:"M9.5 14.5 8.1 15.9a3 3 0 1 1-4.2-4.2l3-3a3 3 0 0 1 4.2 0",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),(0,h.jsx)("path",{d:"m14.5 9.5 1.4-1.4a3 3 0 0 1 4.2 4.2l-3 3a3 3 0 0 1-4.2 0",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),(0,h.jsx)("path",{d:"M9 15 15 9",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"})]}):(0,h.jsx)("svg",{className:s_.analysisIcon,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:(0,h.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z",fill:"currentColor"})});return(0,h.jsx)(vy,{ariaLabel:"".concat(i?"Open":"Create"," analysis for ").concat(t.symbol),variant:"ghost",color:"primary",className:r,title:i?"Open analysis":"Create analysis","data-testid":"create-analysis-".concat(t.id),icon:s,onClick:e=>{if(e.preventDefault(),e.stopPropagation(),i&&t.analysisId)try{globalThis.location.hash="#/analysis?id=".concat(encodeURIComponent(t.analysisId)),setTimeout(()=>{try{globalThis.dispatchEvent(new CustomEvent("open-analysis",{detail:{id:t.analysisId}}))}catch(e){}},50)}catch(n){}else(e=>{try{const t="Forex"===e.market||"Crypto"===e.market?e.market:void 0;globalThis.dispatchEvent(new CustomEvent("prefill-analysis",{detail:{tradeId:e.id,symbol:e.symbol,notes:e.notes,market:t}}))}catch(t){}})(t)}})}function E_(e){let{trades:t,selectedId:n,onSelect:i,compactView:s=!1,onToggleSide:a,onSetSLtoBE:o,onSetSLHit:l,onSetTPHit:u,onMarkClosed:d,onMarkOpen:f,onClose:p,onDelete:m,onInlineUpdate:g}=e;const y=e=>[s_.metricItem,"positive"===e?s_.metricPositive:"","negative"===e?s_.metricNegative:""].filter(Boolean).join(" "),[v,_]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!v)return;t.some(e=>e.id===v.id)||_(null)},[v,t]);const b=()=>{if(!v)return;if(!g)return void _(null);const e=((e,t)=>{if(d_.has(e)){if(""===t.trim())return;const e=Number(t);if(Number.isNaN(e))return;return e}return t})(v.field,v.value);g(v.id,v.field,e),_(null)},w=(e,t,n)=>{const r=void 0===n||null===n?"":"number"===typeof n?"".concat(n):n;_({id:e,field:t,value:r})},E=e=>{const t=e.target.value;_(e=>e?c(c({},e),{},{value:t}):e)},S=e=>{"Enter"===e.key?(e.preventDefault(),b()):"Escape"===e.key&&(e.preventDefault(),_(null))},T=(e,t,n,r)=>{if(r&&v&&v.id===e.id&&v.field===t.focusField&&t.focusField){var i,s;const r=null!==(i=t.inputType)&&void 0!==i?i:d_.has(t.focusField)?"number":"text",a="".concat(t.label," editor for ").concat(e.symbol);return(0,h.jsxs)("span",{className:"".concat(n," ").concat(s_.metricEditing),children:[(0,h.jsx)("span",{className:s_.metricLabel,children:t.label}),(0,h.jsx)("input",{autoFocus:!0,"aria-label":a,className:s_.metricInput,type:r,value:null!==(s=null===v||void 0===v?void 0:v.value)&&void 0!==s?s:"",onChange:E,onKeyDown:S,onBlur:b,step:"number"===r?t.step:void 0})]},"".concat(e.id,"-").concat(t.label))}return(0,h.jsxs)("span",{className:n,role:r?"button":void 0,tabIndex:r?0:void 0,"aria-label":r?"Edit ".concat(t.label):void 0,onClick:n=>r&&I(n,e.id,t),onKeyDown:n=>r&&k(n,e.id,t),children:[(0,h.jsx)("span",{className:s_.metricLabel,children:t.label}),(0,h.jsx)("span",{className:s_.metricValue,children:t.value})]},"".concat(e.id,"-").concat(t.label))},I=(e,t,n)=>{n.focusField&&(e.stopPropagation(),i(t,n.focusField),w(t,n.focusField,n.rawValue))},k=(e,t,n)=>{n.focusField&&("Enter"!==e.key&&" "!==e.key&&"Spacebar"!==e.key||(e.preventDefault(),e.stopPropagation(),i(t,n.focusField),w(t,n.focusField,n.rawValue)))};return s?(0,h.jsx)("div",{className:s_.list,role:"list",children:t.map(e=>{const t=(e.side||"").toString().replace(/['"`]/g,"").trim(),n="LONG"===t.toUpperCase()||"buy"===t.toLowerCase()?"LONG":"SHORT",r=b_(e.sl,e.slIsBE),s=Boolean(e.tp1IsHit),c=Boolean(e.tp2IsHit),g=Boolean(e.tp3IsHit),v=Boolean(e.tp4IsHit),_=[r,{label:"PnL",value:l_(e.pnl,2)},{label:"Entry",value:l_(e.price,4),focusField:"price",rawValue:e.price,inputType:"number",step:h_},{label:"Size",value:u_(e.size),focusField:"size",rawValue:e.size,inputType:"number",step:f_},{label:"Margin",value:l_(e.margin,2),focusField:"margin",rawValue:e.margin,inputType:"number",step:v_},{label:"Leverage",value:c_(e.leverage),focusField:"leverage",rawValue:e.leverage,inputType:"number",step:__}],b=[{label:"TP1",value:l_(e.tp1,2),focusField:"tp1",rawValue:e.tp1,inputType:"number",step:p_,accent:s?"positive":void 0},{label:"TP2",value:l_(e.tp2,2),focusField:"tp2",rawValue:e.tp2,inputType:"number",step:m_,accent:c?"positive":void 0},{label:"TP3",value:l_(e.tp3,2),focusField:"tp3",rawValue:e.tp3,inputType:"number",step:g_,accent:g?"positive":void 0},{label:"TP4",value:l_(e.tp4,2),focusField:"tp4",rawValue:e.tp4,inputType:"number",step:y_,accent:v?"positive":void 0}];return(0,h.jsxs)("div",{className:s_.compactItem,children:[(0,h.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[(0,h.jsx)(o_,{id:e.id,symbol:e.symbol,side:n,size:e.size,entry:e.entryDate,pnl:"number"===typeof e.pnl?e.pnl:0,onExpand:e=>i(e),onToggleSide:a,onSetSLtoBE:o,onSetSLHit:l,onSetTPHit:u,onMarkClosed:d,onMarkOpen:f,onClose:p,onDelete:m,tp1IsHit:e.tp1IsHit,tp2IsHit:e.tp2IsHit,tp3IsHit:e.tp3IsHit,tp4IsHit:e.tp4IsHit}),(0,h.jsx)("div",{children:(0,h.jsx)(w_,{trade:e,extraClass:s_.analysisBtn})})]}),(0,h.jsxs)("div",{className:s_.tpLevelsCompact,children:[(0,h.jsx)("div",{className:"".concat(s_.metrics," ").concat(s_.metricsCompact),children:_.map(t=>{const n=Boolean(t.focusField),r=[y(t.accent),n?s_.metricInteractive:""].filter(Boolean).join(" ");return T(e,t,r,n)})}),(0,h.jsx)("div",{className:"".concat(s_.metrics," ").concat(s_.metricsCompact),children:b.map(t=>{const n=Boolean(t.focusField),r=[y(t.accent),n?s_.metricInteractive:""].filter(Boolean).join(" ");return T(e,t,r,n)})}),(0,h.jsx)("div",{className:s_.tpMetaDate,children:new Date(e.entryDate).toLocaleDateString()})]})]},e.id)})}):(0,h.jsx)("div",{className:s_.list,role:"list",children:t.map(e=>{const t=n===e.id,r=(e.side||"").toString().replace(/['"`]/g,"").trim().toLowerCase(),s="long"===r||"buy"===r?"long":"short",c="long"===s?s_.sideLong:s_.sideShort,g=(e.status||"").toString().trim().toUpperCase(),v="OPEN"===g?s_.statusOpen:"CLOSED"===g?s_.statusClosed:s_.statusFilled,_=b_(e.sl,e.slIsBE),b={1:Boolean(e.tp1IsHit),2:Boolean(e.tp2IsHit),3:Boolean(e.tp3IsHit),4:Boolean(e.tp4IsHit)},w=[_,{label:"PnL",value:l_(e.pnl,2)},{label:"Entry",value:l_(e.price,4),focusField:"price",rawValue:e.price,inputType:"number",step:h_},{label:"Size",value:u_(e.size),focusField:"size",rawValue:e.size,inputType:"number",step:f_},{label:"Margin",value:l_(e.margin,2),focusField:"margin",rawValue:e.margin,inputType:"number",step:v_},{label:"Leverage",value:c_(e.leverage),focusField:"leverage",rawValue:e.leverage,inputType:"number",step:__},{label:"TP1",value:l_(e.tp1,2),focusField:"tp1",rawValue:e.tp1,inputType:"number",step:p_,accent:b[1]?"positive":void 0},{label:"TP2",value:l_(e.tp2,2),focusField:"tp2",rawValue:e.tp2,inputType:"number",step:m_,accent:b[2]?"positive":void 0},{label:"TP3",value:l_(e.tp3,2),focusField:"tp3",rawValue:e.tp3,inputType:"number",step:g_,accent:b[3]?"positive":void 0},{label:"TP4",value:l_(e.tp4,2),focusField:"tp4",rawValue:e.tp4,inputType:"number",step:y_,accent:b[4]?"positive":void 0}],E={};if(a){const t="long"===s?"SHORT":"LONG";E["toggle-side"]={value:"toggle-side",label:"Switch to ".concat(t),onSelect:()=>a(e.id)}}o&&(E["sl-be"]={value:"sl-be",label:"Set SL to BE",onSelect:()=>o(e.id),variant:"success"}),f&&(E["status-open"]={value:"status-open",label:"Mark OPEN",onSelect:()=>f(e.id)}),d&&(E["status-closed"]={value:"status-closed",label:"Mark CLOSED",onSelect:()=>d(e.id)}),l&&(E["sl-hit"]={value:"sl-hit",label:"Mark SL hit",onSelect:()=>l(e.id)}),u&&["1","2","3","4"].forEach(t=>{const n=Number(t),r="tp-".concat(t),i=b[n];E[r]={value:r,label:i?"Clear TP".concat(t," hit"):"Mark TP".concat(t," hit"),onSelect:()=>u(e.id,n),variant:i?void 0:"success"}}),p&&(E.filled={value:"filled",label:"Mark FILLED",onSelect:()=>p(e.id)});const S=["sl-be","sl-hit","tp-1","tp-2","tp-3","tp-4","status-open","status-closed","filled","toggle-side"].map(e=>E[e]).filter(e=>Boolean(e));return(0,h.jsxs)("div",{className:[s_.item,t?s_.selected:""].filter(Boolean).join(" "),onClick:()=>i(e.id),"aria-label":"Select ".concat(e.symbol),role:"listitem","aria-pressed":t,tabIndex:0,onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key&&"Spacebar"!==t.key||(t.preventDefault(),i(e.id))},children:[(0,h.jsxs)("div",{className:s_.rowLeft,children:[(0,h.jsxs)("div",{className:s_.symbol,role:"button",tabIndex:0,onClick:t=>{t.stopPropagation(),i(e.id,"symbol")},onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),t.stopPropagation(),i(e.id,"symbol"))},children:[e.analysisId&&(0,h.jsx)("span",{className:s_.analysisLinkBadge,title:"Analysis linked","aria-hidden":!0,children:(0,h.jsxs)("svg",{className:s_.analysisLinkIcon,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,h.jsx)("path",{d:"M9.5 14.5 8.1 15.9a3 3 0 1 1-4.2-4.2l3-3a3 3 0 0 1 4.2 0",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),(0,h.jsx)("path",{d:"m14.5 9.5 1.4-1.4a3 3 0 0 1 4.2 4.2l-3 3a3 3 0 0 1-4.2 0",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"}),(0,h.jsx)("path",{d:"M9 15 15 9",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"})]})}),e.symbol]}),(0,h.jsx)("div",{className:s_.meta,role:"button",tabIndex:0,onClick:t=>{t.stopPropagation(),i(e.id,"entryDate")},onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),t.stopPropagation(),i(e.id,"entryDate"))},children:new Date(e.entryDate).toLocaleDateString()}),(0,h.jsx)("div",{className:s_.metrics,role:"group","aria-label":"Kennzahlen f\xfcr ".concat(e.symbol),children:w.map(t=>{const n=Boolean(t.focusField),r=[y(t.accent),n?s_.metricInteractive:""].filter(Boolean).join(" ");return T(e,t,r,n)})})]}),(0,h.jsxs)("div",{className:s_.rowRight,children:[(0,h.jsx)("div",{style:{marginRight:8},children:(0,h.jsx)(w_,{trade:e,extraClass:s_.analysisBtn})}),(0,h.jsx)("div",{className:[s_.side,c].join(" "),"aria-label":"Side: ".concat(s),title:s,role:"button",tabIndex:0,onClick:t=>{t.stopPropagation(),i(e.id,"side")},children:s.toUpperCase()}),(0,h.jsx)("div",{className:[s_.status,v].join(" "),"aria-label":"Status: ".concat(g),title:g,role:"button",tabIndex:0,onClick:t=>{t.stopPropagation(),i(e.id,"status")},children:g||"UNKNOWN"}),m&&(0,h.jsx)(vy,{ariaLabel:"Delete ".concat(e.symbol),title:"Delete trade",variant:"ghost",className:s_.deleteBtn,onClick:t=>{t.stopPropagation(),m(e.id)},onKeyDown:e=>{e.stopPropagation()},icon:(0,h.jsx)("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:(0,h.jsx)("path",{d:"M6 6 18 18M18 6 6 18",fill:"none",stroke:"currentColor",strokeWidth:"1.9",strokeLinecap:"round"})})}),S.length>0&&(0,h.jsx)("div",{className:s_.actionDropdownWrap,onClick:e=>e.stopPropagation(),onKeyDown:e=>e.stopPropagation(),children:(0,h.jsx)(py,{options:S,ariaLabel:"Aktionen f\xfcr ".concat(e.symbol)})})]})]},e.id)})})}const S_=function(e){let{tradeListItems:t,selectedId:n,onSelect:r,performAction:i,performTPHit:s,compactGrid:a,onInlineUpdate:o,onRequestDelete:l}=e;return(0,h.jsx)("div",{className:m.leftPane,children:(0,h.jsx)(E_,{trades:t,selectedId:n,onSelect:r,onToggleSide:e=>i("toggle-side",e),onSetSLtoBE:e=>i("sl-be",e),onSetSLHit:e=>i("sl-hit",e),onMarkClosed:e=>i("status-closed",e),onMarkOpen:e=>i("status-open",e),onClose:e=>i("close",e),onSetTPHit:(e,t)=>s(e,t),onInlineUpdate:o,onDelete:l,compactView:a})})};class T_{constructor(e){this.repo=e}async addTrade(e){const t=Bg.create(e);return await this.save(t)}async updateTrade(e){const t=Bg.create(e);return await this.update(t)}async listTrades(){return(await this.getAll()).map(e=>Bg.toDTO(e))}async save(e){if("function"===typeof this.repo.save)return await this.repo.save(e);if("function"===typeof this.repo.update)return await this.repo.update(e);throw new Error("Repository does not implement save or update")}async update(e){if("function"===typeof this.repo.update)return await this.repo.update(e);if("function"===typeof this.repo.save)return await this.repo.save(e);throw new Error("Repository does not implement update or save")}async delete(e){if("function"===typeof this.repo.delete)return await this.repo.delete(e);throw new Error("Repository does not implement delete")}async getAll(){return"function"===typeof this.repo.getAll?await this.repo.getAll():[]}}const I_=[["tp1","tp1IsHit"],["tp2","tp2IsHit"],["tp3","tp3IsHit"],["tp4","tp4IsHit"]],k_={1:"tp1IsHit",2:"tp2IsHit",3:"tp3IsHit",4:"tp4IsHit"};const C_=((e,t)=>{const n=null!==(t=null===(e={NODE_ENV:"production"})||void 0===e?void 0:e.VITE_USE_FIREBASE)&&void 0!==t?t:"true";return"boolean"===typeof n?n:"string"===typeof n&&"true"===n.toLowerCase()})(),A_=new zy((()=>{if(C_){const e=new ig;return new Yg({remote:e})}return new Yg})());function N_(e){let{repo:t,forceCompact:n}=e;const[i,s]=(0,r.useState)(()=>{try{const e=Xv();return"boolean"!==typeof e.showLoadMockButton||e.showLoadMockButton}catch(e){return!0}});(0,r.useEffect)(()=>{const e=()=>{try{const e=Xv();s("boolean"!==typeof e.showLoadMockButton||e.showLoadMockButton)}catch(e){}};return globalThis.addEventListener("storage",e),()=>globalThis.removeEventListener("storage",e)},[]);const[a,o]=(0,r.useState)(!1),l=(0,r.useRef)(null!==t&&void 0!==t?t:null);if((0,r.useEffect)(()=>{l.current=null!==t&&void 0!==t?t:null},[t]),!l.current)if("undefined"!==typeof process)try{l.current=new zg,console.info("[TradeJournal] using LocalStorageTradeRepository fallback")}catch(fe){}else 0;const[u,d]=(0,r.useState)(null),{positions:f,setPositions:g,performAction:y,performTPHit:v,handleInlineUpdate:_,undoInfo:b,handleUndo:w,updateTradeById:E}=function(e){let{repoRef:t,tradeService:n,analysisService:i,setLastStatus:s}=e;const a=(0,r.useRef)(null!==n&&void 0!==n?n:t.current?new T_(t.current):null),[o,l]=(0,r.useState)([]),u=(0,r.useRef)([]),d=(0,r.useCallback)(e=>{"function"===typeof e?l(t=>{const n=e(t);return u.current=n,n}):(u.current=e,l(e))},[]),[h,f]=(0,r.useState)(null),p=(0,r.useRef)(null),m=(0,r.useCallback)(()=>{p.current&&window.clearTimeout(p.current),p.current=null,f(null)},[]),g=(0,r.useCallback)((e,n,r)=>{d(i=>{const o=i.find(t=>t.id===e);let l;if(o){const o=c({},n);if(void 0!==o.side){"object"===typeof o.side&&null!==o.side&&"value"in o.side&&(o.side=o.side.value);const e=String(o.side).toUpperCase();o.side="LONG"===e||"SHORT"===e?e:"LONG"}void 0!==o.sl&&(o.slIsBE=void 0),I_.forEach(e=>{let[t,n]=e;void 0!==o[t]&&(o[n]=void 0)}),l=i.map(t=>t.id===e?c(c({},t),o):t);const u=l.find(t=>t.id===e);(async()=>{try{if(!t.current)return void console.warn("Repository unavailable");const n=c({},u);0===n.sl&&delete n.sl;const i=Bg.create(n);a.current?await a.current.update(i):await t.current.update(i),null===s||void 0===s||s(null!==r&&void 0!==r?r:"Update persisted");try{globalThis.dispatchEvent(new CustomEvent("trades-updated"))}catch(e){}}catch(n){console.error("Failed to persist trade update",n),null===s||void 0===s||s("Update failed")}})()}else{const o=Object.assign({},n,{id:e});l=[o,...i],(async()=>{try{if(!t.current)return void console.warn("Repository unavailable");const n=c({},o);0===n.sl&&delete n.sl;const i=Bg.create(n);a.current?await a.current.save(i):"function"===typeof t.current.save?await t.current.save(i):"function"===typeof t.current.update&&await t.current.update(i),null===s||void 0===s||s(null!==r&&void 0!==r?r:"Restored persisted");try{globalThis.dispatchEvent(new CustomEvent("trades-updated"))}catch(e){}}catch(n){console.error("Failed to persist restored trade",n),null===s||void 0===s||s("Restore failed")}})()}return l})},[t,s]),y=(0,r.useCallback)((e,n)=>{var r;const i=null!==(r=u.current.find(e=>e.id===n))&&void 0!==r?r:o.find(e=>e.id===n);if(!i)return;const l=c({},i);if("toggle-side"===e){const e="LONG"===i.side?"SHORT":"LONG";g(n,{side:e})}else if("sl-be"===e){g(n,{sl:void 0,slIsBE:!0},"SL set to BE and persisted");try{globalThis.dispatchEvent(new CustomEvent("trades-updated"))}catch(fe){}}else"status-open"===e?g(n,{status:"OPEN"},"Open persisted"):"sl-hit"===e||"status-closed"===e?g(n,{status:"CLOSED"},"Closed persisted"):"close"===e?g(n,{status:"FILLED"},"Filled persisted"):"delete"===e&&(d(e=>e.filter(e=>e.id!==n)),(async()=>{try{if(a.current)await a.current.delete(n);else{if(!t.current)return;await t.current.delete(n)}null===s||void 0===s||s("Deleted")}catch(e){console.error("Failed to delete trade from repo",e),null===s||void 0===s||s("Delete failed")}})());f({id:n,prev:l}),p.current&&window.clearTimeout(p.current),p.current=window.setTimeout(()=>{f(null),p.current=null},5e3)},[o,t,g,s]),v=(0,r.useCallback)((e,t)=>{var n;const r=null!==(n=u.current.find(t=>t.id===e))&&void 0!==n?n:o.find(t=>t.id===e);if(!r)return;const i=c({},r),s={};let a="TP hit persisted";if(t&&k_[t]){const e=k_[t],n=Boolean(r[e]);s[e]=!n||void 0,n?a="TP marker cleared":s.status="CLOSED"}else s.status="CLOSED";g(e,s,a),f({id:e,prev:i}),p.current&&window.clearTimeout(p.current),p.current=window.setTimeout(()=>{f(null),p.current=null},5e3)},[o,g]),_=(0,r.useCallback)((e,t,n)=>{const r={};switch(t){case"price":r.price="number"===typeof n?n:void 0;break;case"size":r.size="number"===typeof n?n:void 0;break;case"sl":r.sl="number"===typeof n?n:void 0,r.slIsBE=void 0;break;case"tp1":r.tp1="number"===typeof n?n:void 0,r.tp1IsHit=void 0;break;case"tp2":r.tp2="number"===typeof n?n:void 0,r.tp2IsHit=void 0;break;case"tp3":r.tp3="number"===typeof n?n:void 0,r.tp3IsHit=void 0;break;case"tp4":r.tp4="number"===typeof n?n:void 0,r.tp4IsHit=void 0;break;case"margin":r.margin="number"===typeof n?n:void 0;break;case"leverage":r.leverage="number"===typeof n?n:void 0;break;case"entryDate":"string"===typeof n&&(r.entryDate=n)}0!==Object.keys(r).length&&g(e,r,"Inline edit persisted")},[g]),b=(0,r.useCallback)(()=>{h&&(g(h.id,h.prev),m())},[h,g,m]);return{positions:o,setPositions:d,updateTradeById:g,performAction:y,performTPHit:v,handleInlineUpdate:_,undoInfo:h,handleUndo:b,clearUndo:m}}({repoRef:l,analysisService:A_,setLastStatus:d}),[S,I]=(0,r.useState)(null),[k,C]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=e=>{try{const t=e.detail;if(!t)return;const n={symbol:t.symbol,notes:t.notes,market:t.market};I(n),t.tradeId&&C(t.tradeId),O("analysis")}catch(t){}};return globalThis.addEventListener("prefill-analysis",e),()=>globalThis.removeEventListener("prefill-analysis",e)},[]);const[A,N]=(0,r.useState)("All"),[x,R]=(0,r.useState)("ALL"),[P,D]=(0,r.useState)(null),[L,O]=(0,r.useState)("list"),[j,F]=(0,r.useState)("All"),[M,U]=(0,r.useState)(0);(0,r.useEffect)(()=>{},[L]),(0,r.useEffect)(()=>{let e=!0;return(async()=>{try{if(!l.current)return;console.info("[TradeJournal] initial load: repo present, calling getAll()");const t=await l.current.getAll();if(console.info("[TradeJournal] initial load: repo.getAll() returned",Array.isArray(t)?t.length:typeof t,Array.isArray(t)?t.slice(0,5):t),!e)return;const n=t.map(e=>Bg.toDTO(e));console.info("[TradeJournal] initial load: mapped to DTOs",n.length),g(n)}catch(t){console.warn("[TradeJournal] initial load: failed to load trades from repo")}})(),()=>{e=!1}},[]),(0,r.useEffect)(()=>{const e=async e=>{try{if(!l.current)return;const e=(await l.current.getAll()).map(e=>Bg.toDTO(e));g(e)}catch(t){}};return globalThis.addEventListener("trades-updated",e),()=>globalThis.removeEventListener("trades-updated",e)},[]);const[B,V]=(0,r.useState)(!1),z=Jv(480),H=(0,r.useRef)(null),[W,q]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=H.current;if(!e)return;if("boolean"===typeof n)return void q(n);const t=()=>{const t=getComputedStyle(e),n=parseInt(t.paddingLeft||"0",10),r=parseInt(t.paddingRight||"0",10),i=e.clientWidth-n-r,s=Math.round(22*e.clientWidth/100),a=Math.min(Math.max(280,s),420);q(i<a+900+18+220)},r=new ResizeObserver(t);return r.observe(e),t(),()=>r.disconnect()},[n]);const G=(()=>{let e=f;return"All"!==A&&(e=e.filter(e=>e.market===A)),"OPEN"===x&&(e=e.filter(e=>"OPEN"===e.status)),"CLOSED"===x&&(e=e.filter(e=>"CLOSED"===e.status)),"FILLED"===x&&(e=e.filter(e=>"FILLED"===e.status)),e})(),K=G,{form:J,setForm:Q,touched:Y,setTouched:X,formSubmitted:Z,formKey:$,handleAdd:ee,resetNewTradeForm:te,formErrors:ne}=tv({repoRef:l,setPositions:g,analysisService:A_,newTradeModalOpen:B,setNewTradeModalOpen:V,setLastStatus:d}),re=r.useCallback(async e=>{X(e=>c(c({},e),{},{price:!0}));try{await ee(e)}catch(t){console.warn("handleAdd failed",t)}},[ee,X]),[ie,se]=(0,r.useState)(!1),[ae,oe]=(0,r.useState)(null),[le,ce]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=e=>{try{const n=e.detail;if(n&&"string"===typeof n.analysisId){const e=n.analysisId,r=f.find(t=>t.analysisId===e);if(r){var t;O("list"),N(null!==(t=r.market)&&void 0!==t?t:"All"),D(r.id)}else{let t=0;const n=5,r=()=>{t+=1;const i=f.find(t=>t.analysisId===e);var s;i?(O("list"),N(null!==(s=i.market)&&void 0!==s?s:"All"),D(i.id)):t<n&&setTimeout(r,150)};r()}}}catch(n){}};return globalThis.addEventListener("open-trade",e),()=>globalThis.removeEventListener("open-trade",e)},[f,z]);const ue=Boolean(l.current),de="undefined"!==typeof globalThis?Xv():{},he="boolean"===typeof de.debugUI?de.debugUI:"undefined"!==typeof process&&("true"==={NODE_ENV:"production",PUBLIC_URL:"/traders-mirror",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_FIREBASE:"true",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"842512285290",REACT_APP_BUILD_TAG:"",REACT_APP_BUILD_SHA:"fe8e1f7d7be3d94ffab07172b15fcd8341eda200",REACT_APP_BUILD_TIME:"2026-01-24T21:29:52Z",REACT_APP_FIREBASE_STORAGE_BUCKET:"c3s-monkey-trader.appspot.com",REACT_APP_FIREBASE_AUTH_DOMAIN:"c3s-monkey-trader.firebaseapp.com",REACT_APP_BUILD_BRANCH:"main",REACT_APP_FIRESTORE_FORCE_LONG_POLLING:"true",REACT_APP_FIREBASE_PROJECT_ID:"c3s-monkey-trader",REACT_APP_FIREBASE_APP_ID:"1:842512285290:web:c87e2c00233deaa601413",REACT_APP_FIREBASE_API_KEY:"AIzaSyAgwG2YEqpz-kf7wPKqfNKihKcBnfskzbc"}.REACT_APP_DEBUG_UI||!1);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:m.headerRow,children:[(0,h.jsx)("h2",{className:m.title,children:"Trading Journal"}),(0,h.jsx)("div",{className:m.controls,children:i&&(0,h.jsx)(p,{variant:"secondary",onClick:()=>o(!0),children:"Load mock data"})})]}),(0,h.jsx)(Qv,{isMobile:z,newTradeModalOpen:B,setNewTradeModalOpen:V,form:J,formErrors:ne,touched:Y,formSubmitted:Z,formKey:$,debugUiEnabled:he,lastStatus:u,onChangeForm:e=>Q(t=>c(c({},t),e)),onBlurField:e=>X(t=>c(c({},t),{},{[e]:!0})),onSubmit:re,onReset:te,setMarketFilter:e=>N(""===e?"All":e),handleAdd:ee}),(0,h.jsxs)("div",{ref:H,className:"".concat(W?"".concat(m.grid," ").concat(m.gridCompact):"".concat(m.grid)," ").concat(m.fullScreen," ").concat("analysis"===L?m.analysisActive:"").trim(),children:[(0,h.jsx)("div",{className:m.left,children:(0,h.jsx)(Kv,{mode:"analysis"===L?"analysis":"trade",isMobile:z,form:J,formErrors:ne,touched:Y,formSubmitted:Z,formKey:$,debugUiEnabled:he,lastStatus:u,onChangeForm:e=>Q(t=>c(c({},t),e)),onBlurField:e=>X(t=>c(c({},t),{},{[e]:!0})),onSubmit:re,onReset:te,setMarketFilter:e=>N(""===e?"All":e),initialAnalysis:null!==S&&void 0!==S?S:void 0,onSaveAnalysis:async e=>{try{var t;const r={symbol:e.symbol,notes:e.notes,market:null!==(t=e.market)&&void 0!==t?t:void 0,timeframes:Array.isArray(e.timeframes)?e.timeframes.map(e=>({timeframe:e.timeframe,tradingViewLink:e.tradingViewLink,note:e.note})):e.timeframes},i=await A_.createAnalysis(r);if(k&&E){try{E(k,{analysisId:i.id})}catch(n){}C(null),I(null)}O("analysis")}catch(r){console.warn("Failed to save analysis",r)}}})}),(0,h.jsx)("div",{className:m.right,children:(0,h.jsxs)("div",{className:"".concat(m.cardFullBleedTrade," ").concat(m.tradesArea).trim(),children:[(0,h.jsxs)("div",{className:m.tradesHeader,children:[(0,h.jsx)("div",{className:m.tradesHeaderColumn,children:(0,h.jsx)("div",{className:m.tradesTitle,children:"analysis"===L?"Analysen":"Trades"})}),(0,h.jsxs)("div",{className:m.tradesControls,children:[(0,h.jsxs)("div",{className:m.tradesTabs,role:"tablist","aria-label":"Trades tabs",children:[(0,h.jsx)(p,{type:"button",role:"tab","aria-selected":"list"===L,variant:"list"===L?"primary":"ghost",className:"list"===L?m.tradesTabActive:m.tradesTab,onClick:()=>O("list"),children:"List"}),(0,h.jsx)(p,{type:"button",role:"tab","aria-selected":"analysis"===L,variant:"analysis"===L?"primary":"ghost",className:"analysis"===L?m.tradesTabActive:m.tradesTab,onClick:()=>O("analysis"),children:"Analyse"})]}),(0,h.jsx)("div",{className:m.marketFiltersWrap,children:(0,h.jsx)(ay,{marketFilter:"analysis"===L?j:A,setMarketFilter:e=>"analysis"===L?F(e):N(e),showStatusFilters:!0,statusFilters:(0,h.jsx)(hy,{marketFilter:"analysis"===L?j:A,setMarketFilter:e=>{const t=""===e?"All":e;return"analysis"===L?F(t):N(t)},tradeStatusFilter:x,setTradeStatusFilter:e=>R(e)}),hideMarketFilters:!0,count:"analysis"===L?M:G.length,countLabel:"analysis"===L?"analyses":"trades"})})]})]}),(0,h.jsx)("div",{className:[m.listAndDetailWrap,"list"===L?m.listOnly:""].filter(Boolean).join(" "),children:"list"===L?(0,h.jsx)(S_,{tradeListItems:K,selectedId:P,onSelect:e=>{D(e)},performAction:y,performTPHit:v,compactGrid:W,onInlineUpdate:_,onRequestDelete:e=>(oe(e),ce("delete"),se(!0),Promise.resolve())}):(0,h.jsx)($y,{onCreateTradeSuggestion:async e=>{var t,n,r,i,s,a,o;const l=(e=>{const t=e?new Date(e):new Date,n=e=>String(e).padStart(2,"0"),r=t.getFullYear(),i=n(t.getMonth()+1),s=n(t.getDate()),a=n(t.getHours()),o=n(t.getMinutes());return"".concat(r,"-").concat(i,"-").concat(s,"T").concat(a,":").concat(o)})(e.entryDate);Q({symbol:e.symbol,entryDate:l,size:null!==(t=e.size)&&void 0!==t?t:void 0,price:null!==(n=e.price)&&void 0!==n?n:void 0,side:null!==(r=e.side)&&void 0!==r?r:"LONG",market:null!==(i=e.market)&&void 0!==i?i:"",notes:"Suggested from analysis (".concat(null!==(s=e.market)&&void 0!==s?s:"unspecified",")"),status:"OPEN",analysisId:null!==(a=e.analysisId)&&void 0!==a?a:void 0}),O("list"),N(null!==(o=e.market)&&void 0!==o?o:"All"),D(null)},marketFilter:j,onMarketFilterChange:e=>F(e),showFilterToolbar:!1,useCard:!1,onVisibleCountChange:U})})]})})]}),(0,h.jsx)(T,{open:ie,onConfirm:()=>{le&&ae&&(y(le,ae),se(!1),ce(null),oe(null))},onCancel:()=>{se(!1),ce(null),oe(null)},title:"Best\xe4tigung erforderlich",message:"Sind Sie sicher, dass Sie diese Aktion durchf\xfchren m\xf6chten?",confirmLabel:"Ja",cancelLabel:"Abbrechen",confirmVariant:"delete"===le?"danger":"primary"}),(0,h.jsx)(i_,{open:a,onClose:()=>o(!1),repoRef:l,setPositions:g,analysisService:A_}),b&&(0,h.jsx)("div",{className:m.undoBanner,children:(0,h.jsxs)("div",{className:m.undoContent,children:[(0,h.jsx)("div",{children:"Aktion durchgef\xfchrt \u2014 R\xfcckg\xe4ngig m\xf6glich"}),(0,h.jsx)(p,{variant:"ghost",onClick:w,children:"Undo"})]})}),ue&&he&&(0,h.jsxs)("div",{className:m.statusBanner,children:[(0,h.jsxs)("div",{children:[f.length," trades loaded"]}),u&&(0,h.jsx)("div",{className:m.statusMessage,children:u})]})]})}function x_(e){return"object"===typeof e&&null!==e}function R_(e,t){if(function(e){if(!x_(e))return!1;const t=e;return"symbol"in t&&x_(t.symbol)&&"value"in t.symbol}(e)){var n,r,i;const s=e,a=s.symbol,o=s.entryDate;return{id:String(s.id),market:null!==(n=s.market)&&void 0!==n?n:"All",symbol:String(a.value),entryDate:String(o&&"object"===typeof o&&"value"in o?o.value:null!==o&&void 0!==o?o:(new Date).toISOString()),confluence:null!==(r=s.confluence)&&void 0!==r?r:void 0,size:x_(s.size)&&"value"in s.size?Number(s.size.value):Number(s.size),price:x_(s.price)&&"value"in s.price?Number(s.price.value):Number(s.price),side:x_(s.side)&&"value"in s.side?String(s.side.value):s.side,status:null!==(i=s.status)&&void 0!==i?i:"OPEN",pnl:"number"===typeof s.pnl?s.pnl:0,notes:s.notes,entry:s.entry,sl:"number"===typeof s.sl?s.sl:void 0,slIsBE:"boolean"===typeof s.slIsBE?s.slIsBE:void 0,tp1:"number"===typeof s.tp1?s.tp1:void 0,tp2:"number"===typeof s.tp2?s.tp2:void 0,tp3:"number"===typeof s.tp3?s.tp3:void 0,tp4:"number"===typeof s.tp4?s.tp4:void 0,tp1IsHit:"boolean"===typeof s.tp1IsHit?s.tp1IsHit:void 0,tp2IsHit:"boolean"===typeof s.tp2IsHit?s.tp2IsHit:void 0,tp3IsHit:"boolean"===typeof s.tp3IsHit?s.tp3IsHit:void 0,tp4IsHit:"boolean"===typeof s.tp4IsHit?s.tp4IsHit:void 0,margin:"number"===typeof s.margin?s.margin:void 0,leverage:"number"===typeof s.leverage?s.leverage:void 0,analysisId:"string"===typeof s.analysisId?s.analysisId:void 0,userId:t}}if(x_(e)){var s,a,o,l,c;const n=e;return{id:String(n.id),market:null!==(s=n.market)&&void 0!==s?s:"All",symbol:String(n.symbol),entryDate:String(null!==(a=n.entryDate)&&void 0!==a?a:(new Date).toISOString()),confluence:null!==(o=n.confluence)&&void 0!==o?o:void 0,size:Number(n.size),price:Number(n.price),side:null!==(l=n.side)&&void 0!==l?l:"LONG",status:null!==(c=n.status)&&void 0!==c?c:"OPEN",pnl:"number"===typeof n.pnl?n.pnl:0,notes:n.notes,entry:n.entry,sl:"number"===typeof n.sl?n.sl:void 0,slIsBE:"boolean"===typeof n.slIsBE?n.slIsBE:void 0,tp1:"number"===typeof n.tp1?n.tp1:void 0,tp2:"number"===typeof n.tp2?n.tp2:void 0,tp3:"number"===typeof n.tp3?n.tp3:void 0,tp4:"number"===typeof n.tp4?n.tp4:void 0,tp1IsHit:"boolean"===typeof n.tp1IsHit?n.tp1IsHit:void 0,tp2IsHit:"boolean"===typeof n.tp2IsHit?n.tp2IsHit:void 0,tp3IsHit:"boolean"===typeof n.tp3IsHit?n.tp3IsHit:void 0,tp4IsHit:"boolean"===typeof n.tp4IsHit?n.tp4IsHit:void 0,margin:"number"===typeof n.margin?n.margin:void 0,leverage:"number"===typeof n.leverage?n.leverage:void 0,analysisId:"string"===typeof n.analysisId?n.analysisId:void 0,userId:t}}return{id:"unknown",market:"All",symbol:"UNKNOWN",entryDate:(new Date).toISOString(),size:0,price:0,side:"LONG",status:"OPEN",pnl:0,userId:t}}const P_=class{async save(e){const{db:t}=tg(),n=rg();if(!n)throw new Error("Not authenticated");const r=R_(Bg.toDTO(e),n),i=Object.fromEntries(Object.entries(r).filter(e=>{let[,t]=e;return void 0!==t})),s=Jp(t,"users",n,"trades",r.id);await Gm(s,i)}async getAll(){const{db:e}=tg(),t=rg();if(!t)return[];const n=Rm(Kp(e,"users",t,"trades"));return(await qm(n)).docs.map(e=>e.data()).map(e=>Bg.create({id:e.id,symbol:e.symbol,confluence:e.confluence,entryDate:e.entryDate,size:e.size,price:e.price,side:e.side,notes:e.notes,market:e.market,sl:e.sl,slIsBE:e.slIsBE,userId:e.userId,tp1:e.tp1,tp2:e.tp2,tp3:e.tp3,tp4:e.tp4,tp1IsHit:e.tp1IsHit,tp2IsHit:e.tp2IsHit,tp3IsHit:e.tp3IsHit,tp4IsHit:e.tp4IsHit,leverage:e.leverage,margin:e.margin,analysisId:e.analysisId,status:e.status}))}async update(e){await this.save(e)}async delete(e){const{db:t}=tg(),n=rg();if(!n)throw new Error("Not authenticated");const r=Jp(t,"users",n,"trades",e);await Km(r)}},D_="trade_outbox_v1";function L_(){try{const e=localStorage.getItem(D_);if(!e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch(e){return[]}}function O_(e){try{localStorage.setItem(D_,JSON.stringify(e))}catch(t){}}const j_=class{constructor(e){if(this.local=new zg(void 0,{seedDefaults:!1}),this.remote=void 0,this.bootstrapped=!1,this.remote=null===e||void 0===e?void 0:e.remote,this.remote){(async()=>{try{if(this.bootstrapped)return;this.bootstrapped=!0;try{await this.flushOutbox()}catch(e){}const t=await this.remote.getAll();if(Array.isArray(t)&&t.length)for(const e of t)await this.local.update(e)}catch(t){}})();try{queueMicrotask(()=>{try{globalThis.dispatchEvent(new CustomEvent("repo-sync-status",{detail:{feature:"trade",status:"online"}}))}catch(e){}})}catch(t){}if("undefined"!==typeof window&&"function"===typeof window.addEventListener){window.addEventListener("online",()=>{this.flushOutbox()});try{globalThis.addEventListener("repo-sync-force",()=>{this.flushOutbox()})}catch(n){}}"undefined"!==typeof navigator&&navigator.onLine&&this.flushOutbox();try{const{db:e}=tg(),t=rg();if(t){Jm(Rm(Kp(e,"users",t,"trades")),async e=>{try{const r=e.docs.map(e=>e.data());for(const e of r)try{const t=Bg.create({id:e.id,symbol:e.symbol,entryDate:e.entryDate,size:e.size,price:e.price,side:e.side,notes:e.notes,market:e.market,sl:e.sl,slIsBE:e.slIsBE,tp1:e.tp1,tp2:e.tp2,tp3:e.tp3,tp4:e.tp4,tp1IsHit:e.tp1IsHit,tp2IsHit:e.tp2IsHit,tp3IsHit:e.tp3IsHit,tp4IsHit:e.tp4IsHit,leverage:e.leverage,margin:e.margin,analysisId:e.analysisId,status:e.status});await this.local.update(t)}catch(t){}try{globalThis.dispatchEvent(new CustomEvent("trades-updated",{detail:{type:"remote"}}))}catch(n){}}catch(r){}})}}catch(r){}}else try{queueMicrotask(()=>{try{globalThis.dispatchEvent(new CustomEvent("repo-sync-status",{detail:{feature:"trade",status:"local"}}))}catch(e){}})}catch(i){}}async getAll(){return this.local.getAll()}async save(e){const t=Bg.toDTO(e);await this.local.save(e),this.remote&&this.trySync({op:"save",dto:t})}async update(e){const t=Bg.toDTO(e);await this.local.update(e),this.remote&&this.trySync({op:"update",dto:t})}async delete(e){await this.local.delete(e),this.remote&&this.trySync({op:"delete",id:e})}async trySync(e){if(this.remote)try{"delete"===e.op?await this.remote.delete(e.id):"save"===e.op?await this.remote.save(Bg.create(e.dto)):await this.remote.update(Bg.create(e.dto));try{globalThis.dispatchEvent(new CustomEvent("repo-sync-status",{detail:{feature:"trade",status:"online"}}))}catch(t){}}catch(n){const t=L_();t.push(e),O_(t);try{globalThis.dispatchEvent(new CustomEvent("repo-sync-status",{detail:{feature:"trade",status:"queued",queuedCount:t.length}}))}catch(r){}}}async flushOutbox(){if(!this.remote)return;const e=L_();if(!e.length)return;const t=[];for(const i of e)try{"delete"===i.op?await this.remote.delete(i.id):"save"===i.op?await this.remote.save(Bg.create(i.dto)):await this.remote.update(Bg.create(i.dto))}catch(n){t.push(i)}O_(t);try{globalThis.dispatchEvent(new CustomEvent("repo-sync-status",{detail:{feature:"trade",status:t.length?"queued":"online",queuedCount:t.length||void 0}}))}catch(r){}}},F_={container:"Settings_container__aXLvw",section:"Settings_section__E7ZC-",themeRow:"Settings_themeRow__rnWtg",previewCard:"Settings_previewCard__Hm+oQ",previewActive:"Settings_previewActive__1Zqf2",previewHeader:"Settings_previewHeader__FUEGA",previewBody:"Settings_previewBody__wQHZa",sampleRow:"Settings_sampleRow__C8AtR",sampleBox:"Settings_sampleBox__dDCnM",sampleBtn:"Settings_sampleBtn__0ybSI",sampleText:"Settings_sampleText__PmVxy",themeBtn:"Settings_themeBtn__U-fDX",active:"Settings_active__L091Y",help:"Settings_help__j2zmm",debugRow:"Settings_debugRow__TOM77",toggleRow:"Settings_toggleRow__e8fUu",stateText:"Settings_stateText__9UasJ",stateOn:"Settings_stateOn__AUw7c",stateOff:"Settings_stateOff__H7wXh",syncRow:"Settings_syncRow__fxdQn",syncHelp:"Settings_syncHelp__O2h8s",debugBtn:"Settings_debugBtn__tq0Tn",on:"Settings_on__dmrXk",off:"Settings_off__2vtsd",storageButtons:"Settings_storageButtons__pRLMn",dangerBtn:"Settings_dangerBtn__dH8dj",restoreBtn:"Settings_restoreBtn__TeZEv",infoBanner:"Settings_infoBanner__WOws4",compact:"Settings_compact__o1Yi6"},M_={switcher:"ThemeSwitcher_switcher__Yok8i",btn:"ThemeSwitcher_btn__y5zpr",active:"ThemeSwitcher_active__8PVtg",swatch:"ThemeSwitcher_swatch__uHe35",label:"ThemeSwitcher_label__qdf7c"},U_=["nightscope","warmledger","datagrid","solarized","neon","forest","sunrise","mono","aurora"],B_={nightscope:"linear-gradient(90deg,#58d68d,#00bcd4)",warmledger:"linear-gradient(90deg,#f7b267,#f26d3d)",datagrid:"linear-gradient(90deg,#4fb3ff,#2b8bff)",solarized:"linear-gradient(90deg,#2aa198,#b58900)",neon:"linear-gradient(90deg,#ff2dd4,#00ffd5)",forest:"linear-gradient(90deg,#79c267,#2e8b57)",sunrise:"linear-gradient(90deg,#ff7a59,#ffd166)",mono:"linear-gradient(90deg,#cfcfcf,#9a9a9a)",aurora:"linear-gradient(90deg,#8b5cf6,#3de7c9,#ffd27a)"};function V_(){const[e,t]=(0,r.useState)(()=>localStorage.getItem("theme")||"nightscope");(0,r.useEffect)(()=>{document.documentElement.setAttribute("data-theme",e);try{localStorage.setItem("theme",e)}catch(t){}},[e]);return(0,h.jsx)("div",{className:M_.switcher,role:"toolbar","aria-label":"Theme switcher",children:U_.map(n=>(0,h.jsxs)("button",{className:[M_.btn,e===n?M_.active:""].filter(Boolean).join(" "),onClick:()=>(e=>{t(e)})(n),title:n,children:[(0,h.jsx)("span",{className:M_.swatch,style:{background:B_[n]},"aria-hidden":!0}),(0,h.jsx)("span",{className:M_.label,children:n})]},n))})}const z_={container:"Toast_container__Ck6ws",toast:"Toast_toast__p7J7V",message:"Toast_message__ANpeW",close:"Toast_close__mbPpZ",info:"Toast_info__quY4d",success:"Toast_success__HhXJv",error:"Toast_error__mFof-",left:"Toast_left__N43c0",icon:"Toast_icon__8PiYF",entering:"Toast_entering__y4owT",toastIn:"Toast_toastIn__qckhX",leaving:"Toast_leaving__J+DXr",toastOut:"Toast_toastOut__ew5zc"},H_=(0,r.createContext)(null);const W_=function(e){let{children:t}=e;const[n,i]=(0,r.useState)([]),s=(0,r.useRef)({}),a=(0,r.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e));const t=s.current[e];t&&(clearTimeout(t),delete s.current[e])},[]),o=(0,r.useCallback)(e=>{i(t=>t.map(t=>t.id===e?c(c({},t),{},{leaving:!0}):t));const t=window.setTimeout(()=>a(e),320);s.current[e]=t},[a]),l=(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";const n="".concat(Date.now().toString(36),"-").concat(Math.random().toString(36).slice(2,8)),r={id:n,message:e,type:t};i(e=>[r,...e]);const a=window.setTimeout(()=>o(n),4e3);s.current[n]=a},[a]);return(0,r.useEffect)(()=>()=>{Object.values(s.current).forEach(e=>clearTimeout(e)),s.current={}},[]),(0,h.jsxs)(H_.Provider,{value:{addToast:l},children:[t,(0,h.jsx)("div",{className:z_.container,"aria-live":"polite","aria-atomic":"true",children:n.map(e=>(0,h.jsxs)("div",{className:"".concat(z_.toast," ").concat(z_[e.type]," ").concat(e.leaving?z_.leaving:z_.entering),role:"status",children:[(0,h.jsxs)("div",{className:z_.left,children:[(0,h.jsx)("span",{className:z_.icon,"aria-hidden":!0,children:"success"===e.type?(0,h.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):"error"===e.type?(0,h.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):(0,h.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,h.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,h.jsx)("path",{d:"M12 8v4l2 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,h.jsx)("div",{className:z_.message,children:e.message})]}),(0,h.jsx)("button",{className:z_.close,onClick:()=>o(e.id),"aria-label":"Dismiss",children:"\xd7"})]},e.id))})]})};function q_(e){var t;let{compactView:n}=e;const[i,s]=(0,r.useState)({}),[a,o]=(0,r.useState)(!1),l=function(e){let t=0,n=!1,r=!1;return Object.values(e).forEach(e=>{"queued"===e.status&&(t+=e.queuedCount||1),"online"===e.status&&(n=!0),"local"===e.status&&(r=!0)}),t>0?{status:"queued",queuedCount:t}:n?{status:"online"}:{status:"local"}}(i),{addToast:u}=function(){const e=(0,r.useContext)(H_);return null!==e&&void 0!==e?e:{addToast:()=>{}}}(),d=(0,r.useRef)(null);(0,r.useEffect)(()=>{function e(e){const t=e,{feature:n,status:r,queuedCount:i}=t.detail||{};n&&r&&s(e=>c(c({},e),{},{[n]:{status:r,queuedCount:i}}))}return globalThis.addEventListener("repo-sync-status",e),()=>{globalThis.removeEventListener("repo-sync-status",e)}},[]),(0,r.useEffect)(()=>{a&&("online"!==l.status||l.queuedCount&&l.queuedCount>0||(u("Sync completed","success"),o(!1),d.current&&(clearTimeout(d.current),d.current=null)))},[l,a,u]);const f=a?"Syncing\u2026":"queued"===l.status?"Sync: Queued ".concat(null!==(t=l.queuedCount)&&void 0!==t?t:"").trim():"online"===l.status?"Sync: Online":"Sync: Local",p=n?"".concat(_y," ").concat(by):_y,m="queued"===l.status?"".concat(p," ").concat(Sy):"online"===l.status?"".concat(p," ").concat(Ey):"".concat(p," ").concat(wy),g=()=>{try{o(!0),u("Sync started","info"),globalThis.dispatchEvent(new CustomEvent("repo-sync-force")),d.current&&clearTimeout(d.current),d.current=window.setTimeout(()=>{a&&(u("Sync timed out","error"),o(!1)),d.current=null},1e4)}catch(e){o(!1)}};return(0,h.jsxs)("span",{className:m,role:"button",tabIndex:0,onClick:()=>g(),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),g())},"aria-pressed":a,"aria-live":"polite",children:[a?(0,h.jsx)("span",{className:Ty,"aria-hidden":"true"}):null,f]})}const G_="Switch_wrapper__U2Zt7",K_="Switch_label__6bmFt",J_="Switch_switch__MizaD",Q_="Switch_off__VLVqN",Y_="Switch_on__RDYbp",X_="Switch_disabled__fg8mh",Z_="Switch_knob__udntj";function $_(e){let{checked:t,onChange:n,id:r,label:i,ariaLabel:s,disabled:a}=e;return(0,h.jsxs)("div",{className:G_,children:[i&&(0,h.jsx)("label",{htmlFor:r,className:K_,children:i}),(0,h.jsx)("button",{id:r,role:"switch","aria-checked":t,"aria-label":s,className:"".concat(J_," ").concat(t?Y_:Q_," ").concat(a?X_:""),onClick:()=>!a&&n(!t),type:"button",disabled:a,children:(0,h.jsx)("span",{className:Z_,"aria-hidden":!0})})]})}function eb(){const[e,t]=r.useState(()=>{const e=Xv(),t="undefined"!==typeof process&&("true"==={NODE_ENV:"production",PUBLIC_URL:"/traders-mirror",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_FIREBASE:"true",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"842512285290",REACT_APP_BUILD_TAG:"",REACT_APP_BUILD_SHA:"fe8e1f7d7be3d94ffab07172b15fcd8341eda200",REACT_APP_BUILD_TIME:"2026-01-24T21:29:52Z",REACT_APP_FIREBASE_STORAGE_BUCKET:"c3s-monkey-trader.appspot.com",REACT_APP_FIREBASE_AUTH_DOMAIN:"c3s-monkey-trader.firebaseapp.com",REACT_APP_BUILD_BRANCH:"main",REACT_APP_FIRESTORE_FORCE_LONG_POLLING:"true",REACT_APP_FIREBASE_PROJECT_ID:"c3s-monkey-trader",REACT_APP_FIREBASE_APP_ID:"1:842512285290:web:c87e2c00233deaa601413",REACT_APP_FIREBASE_API_KEY:"AIzaSyAgwG2YEqpz-kf7wPKqfNKihKcBnfskzbc"}.REACT_APP_DEBUG_UI||!1);return"boolean"===typeof e.debugUI?e.debugUI:t});return(0,h.jsxs)("div",{className:F_.debugRow,children:[(0,h.jsx)("label",{className:F_.fieldLabel,children:"Debug UI"}),(0,h.jsx)("div",{children:(0,h.jsx)("button",{role:"switch","aria-checked":e,"aria-label":"Toggle debug UI",className:"".concat(F_.debugBtn," ").concat(e?F_.on:F_.off),onClick:()=>{return t(n=!e),void Zv(c(c({},Xv()),{},{debugUI:n}));var n},type:"button",children:e?"Debug ON":"Debug OFF"})}),(0,h.jsx)("p",{className:F_.help,children:"Enable developer UI features (status banners, extra logs). Stored in browser settings."})]})}function tb(){const[e,t]=r.useState(()=>{const e=Xv();return"boolean"!==typeof e.showLoadMockButton||e.showLoadMockButton});return(0,h.jsxs)("div",{className:F_.debugRow,children:[(0,h.jsx)("label",{className:F_.fieldLabel,children:'Show "Load mock data"'}),(0,h.jsx)("div",{children:(0,h.jsx)("button",{"aria-checked":e,"aria-label":"Toggle show load mock button",className:"".concat(F_.debugBtn," ").concat(e?F_.on:F_.off),onClick:()=>{return t(n=!e),void Zv(c(c({},Xv()),{},{showLoadMockButton:n}));var n},type:"button",children:e?"Visible":"Hidden"})}),(0,h.jsx)("p",{className:F_.help,children:'Show or hide the "Load mock data" control in the Trading Journal. Stored in browser settings.'})]})}function nb(){const e=((e,t)=>{const n=null!==(e={NODE_ENV:"production"})&&void 0!==e?e:{},r=null!==(t=n.VITE_USE_FIREBASE)&&void 0!==t?t:"true",i="boolean"===typeof r?r:"string"===typeof r&&"true"===r.toLowerCase(),s=Boolean(n.VITE_FIREBASE_API_KEY||"AIzaSyAgwG2YEqpz-kf7wPKqfNKihKcBnfskzbc");return i||s})(),[t,n]=r.useState(()=>{const t=Xv();return!!e&&("boolean"!==typeof t.useCloudSync||t.useCloudSync)}),i=e?t?"Enabled":"Disabled":"Unavailable",s=e&&t?F_.stateOn:F_.stateOff;return(0,h.jsxs)("div",{className:F_.debugRow,children:[(0,h.jsx)("label",{className:F_.fieldLabel,children:"Cloud Sync (Firebase)"}),(0,h.jsxs)("div",{className:F_.toggleRow,children:[(0,h.jsx)($_,{checked:t&&e,onChange:e=>{n(e);Zv(c(c({},Xv()),{},{useCloudSync:e}));try{globalThis.dispatchEvent(new CustomEvent("settings-changed",{detail:{useCloudSync:e}}))}catch(t){}},ariaLabel:"Toggle cloud sync",disabled:!e}),(0,h.jsx)("span",{className:"".concat(F_.stateText," ").concat(s),children:i})]}),(0,h.jsx)("p",{className:F_.help,children:"Uses local storage offline-first and syncs to Firebase when enabled. Preference is saved to your browser. If disabled, the app stays local-only."}),(0,h.jsxs)("div",{className:F_.syncRow,children:[(0,h.jsx)(q_,{compactView:!0}),(0,h.jsx)("span",{className:F_.syncHelp,children:"Current sync status"})]})]})}function rb(){const[e,t]=r.useState(!1),[n,i]=r.useState(null),[s,a]=r.useState(null),o=r.useRef(null),l=e=>{i(e),t(!0)};r.useEffect(()=>()=>{if(o.current){try{window.clearTimeout(o.current)}catch(e){}o.current=null}},[]);return(0,h.jsxs)("div",{className:F_.debugRow,style:{alignItems:"center"},children:[(0,h.jsx)("label",{className:F_.fieldLabel,children:"Storage"}),(0,h.jsxs)("div",{className:F_.storageButtons,children:[(0,h.jsx)(p,{variant:"danger",onClick:()=>{l("clear")},children:"Delete demo data"}),(0,h.jsx)(p,{variant:"primary",onClick:()=>{l("restore")},children:"Add demo data"})]}),(0,h.jsx)(T,{open:e,title:"clear"===n?"Delete demo data":"Add demo data",message:"clear"===n?"Alle gespeicherten Trades entfernen? Diese Aktion kann nicht r\xfcckg\xe4ngig gemacht werden.":"Demo-Daten wiederherstellen? Existierende Daten werden \xfcberschrieben.",confirmLabel:"clear"===n?"L\xf6schen":"Wiederherstellen",cancelLabel:"Abbrechen",onConfirm:async()=>{if(!n)return void t(!1);const e=()=>{};try{if("clear"===n){const t=localStorage.getItem("mt_trades_v1");let n=0;try{const e=t?JSON.parse(t):[];Array.isArray(e)&&(n=e.length)}catch(r){n=0}localStorage.removeItem("mt_trades_v1");try{r_(new ag,e)}catch(s){console.warn("Failed to clear analyses when deleting demo data",s)}a("Deleted ".concat(n," stored trade").concat(1===n?"":"s")),o.current&&window.clearTimeout(o.current),o.current=window.setTimeout(()=>window.location.reload(),1200)}else if("restore"===n){const t=Array.isArray(t_)?t_.length:0;localStorage.setItem("mt_trades_v1",JSON.stringify(t_));try{const n=new zg(void 0,{seedDefaults:!1}),r=new ag;(async()=>{try{const i=await n.getAll();await n_(r,i,e,n,Math.min(5,t))}catch(s){console.warn("Failed to seed analyses for restored demo trades",s)}})()}catch(s){console.warn("Failed to initialize repos for demo data restore",s)}a("Loaded ".concat(t," demo trade").concat(1===t?"":"s")),o.current&&window.clearTimeout(o.current),o.current=window.setTimeout(()=>window.location.reload(),1200)}}finally{t(!1),i(null)}},onCancel:()=>{t(!1),i(null)},confirmVariant:"clear"===n?"danger":"primary"}),(0,h.jsx)("p",{className:F_.help,children:"Remove or restore the demo trades stored in your browser localStorage (key: mt_trades_v1)."}),s&&(0,h.jsx)("div",{role:"status","aria-live":"polite",className:F_.infoBanner,children:s})]})}function ib(e){let{compactView:t}=e;const n=r.useMemo(()=>{const e={NODE_ENV:"production"}||0,t="string"===typeof e.VITE_BUILD_SHA?e.VITE_BUILD_SHA:void 0,n="string"===typeof e.VITE_BUILD_TAG?e.VITE_BUILD_TAG:void 0,r="string"===typeof e.VITE_BUILD_TIME?e.VITE_BUILD_TIME:void 0,i="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/traders-mirror",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_FIREBASE:"true",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"842512285290",REACT_APP_BUILD_TAG:"",REACT_APP_BUILD_SHA:"fe8e1f7d7be3d94ffab07172b15fcd8341eda200",REACT_APP_BUILD_TIME:"2026-01-24T21:29:52Z",REACT_APP_FIREBASE_STORAGE_BUCKET:"c3s-monkey-trader.appspot.com",REACT_APP_FIREBASE_AUTH_DOMAIN:"c3s-monkey-trader.firebaseapp.com",REACT_APP_BUILD_BRANCH:"main",REACT_APP_FIRESTORE_FORCE_LONG_POLLING:"true",REACT_APP_FIREBASE_PROJECT_ID:"c3s-monkey-trader",REACT_APP_FIREBASE_APP_ID:"1:842512285290:web:c87e2c00233deaa601413",REACT_APP_FIREBASE_API_KEY:"AIzaSyAgwG2YEqpz-kf7wPKqfNKihKcBnfskzbc"}?"main":void 0,s="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/traders-mirror",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_FIREBASE:"true",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"842512285290",REACT_APP_BUILD_TAG:"",REACT_APP_BUILD_SHA:"fe8e1f7d7be3d94ffab07172b15fcd8341eda200",REACT_APP_BUILD_TIME:"2026-01-24T21:29:52Z",REACT_APP_FIREBASE_STORAGE_BUCKET:"c3s-monkey-trader.appspot.com",REACT_APP_FIREBASE_AUTH_DOMAIN:"c3s-monkey-trader.firebaseapp.com",REACT_APP_BUILD_BRANCH:"main",REACT_APP_FIRESTORE_FORCE_LONG_POLLING:"true",REACT_APP_FIREBASE_PROJECT_ID:"c3s-monkey-trader",REACT_APP_FIREBASE_APP_ID:"1:842512285290:web:c87e2c00233deaa601413",REACT_APP_FIREBASE_API_KEY:"AIzaSyAgwG2YEqpz-kf7wPKqfNKihKcBnfskzbc"}?"fe8e1f7d7be3d94ffab07172b15fcd8341eda200":void 0,a="undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/traders-mirror",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_FIREBASE:"true",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"842512285290",REACT_APP_BUILD_TAG:"",REACT_APP_BUILD_SHA:"fe8e1f7d7be3d94ffab07172b15fcd8341eda200",REACT_APP_BUILD_TIME:"2026-01-24T21:29:52Z",REACT_APP_FIREBASE_STORAGE_BUCKET:"c3s-monkey-trader.appspot.com",REACT_APP_FIREBASE_AUTH_DOMAIN:"c3s-monkey-trader.firebaseapp.com",REACT_APP_BUILD_BRANCH:"main",REACT_APP_FIRESTORE_FORCE_LONG_POLLING:"true",REACT_APP_FIREBASE_PROJECT_ID:"c3s-monkey-trader",REACT_APP_FIREBASE_APP_ID:"1:842512285290:web:c87e2c00233deaa601413",REACT_APP_FIREBASE_API_KEY:"AIzaSyAgwG2YEqpz-kf7wPKqfNKihKcBnfskzbc"}?"2026-01-24T21:29:52Z":void 0;let o=String(("string"===typeof e.VITE_BUILD_BRANCH?e.VITE_BUILD_BRANCH:void 0)||i||""),l=String(t||s||""),c=String(n||""),u=String(r||a||"");try{const e="undefined"!==typeof window&&window.__BUILD_INFO__||void 0;e&&(o=o||String(e.branch||""),l=l||String(e.sha||""),c=c||String(e.tag||""),u=u||String(e.time||""))}catch(d){}return{branch:o,sha:l,tag:c,time:u}},[]),[i,s]=r.useState(n);return r.useEffect(()=>{if(!(!n.branch||!n.sha||!n.tag||!n.time))return;let e=!1;return(async()=>{try{const t=await fetch("build-info.json",{cache:"no-store"});if(!t.ok)return;const n=await t.json();if(e)return;s(e=>({branch:e.branch||String(n.branch||""),sha:e.sha||String(n.sha||""),tag:e.tag||String(n.tag||""),time:e.time||String(n.time||"")}))}catch(t){}})(),()=>{e=!0}},[n.branch,n.sha,n.tag,n.time]),(0,h.jsxs)("div",{className:t?"".concat(F_.container," ").concat(F_.compact):F_.container,"data-compact":t,children:[(0,h.jsx)("h2",{children:"Settings"}),(0,h.jsxs)("section",{className:F_.section,children:[(0,h.jsx)("h3",{children:"Look & Feel"}),(0,h.jsx)("p",{className:F_.help,children:"Choose a theme to apply the color scheme across the app. This setting is saved to your browser."}),(0,h.jsx)("div",{className:F_.themeRow,children:(0,h.jsx)(V_,{})})]}),(0,h.jsxs)("section",{className:F_.section,children:[(0,h.jsx)("h3",{children:"Debug"}),(0,h.jsx)(eb,{}),(0,h.jsx)(nb,{}),(0,h.jsx)(tb,{}),(0,h.jsx)(rb,{})]}),(0,h.jsxs)("section",{className:F_.section,children:[(0,h.jsx)("h3",{children:"Build Info"}),(0,h.jsx)("p",{className:F_.help,children:"Metadata about this deployed build."}),(0,h.jsxs)("div",{className:F_.debugRow,children:[(0,h.jsx)("label",{className:F_.fieldLabel,children:"Branch"}),(0,h.jsx)("div",{children:i.branch||"n/a"})]}),(0,h.jsxs)("div",{className:F_.debugRow,children:[(0,h.jsx)("label",{className:F_.fieldLabel,children:"Commit"}),(0,h.jsx)("div",{children:i.sha?(0,h.jsx)("a",{href:"https://github.com/".concat("undefined"!==typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/traders-mirror",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_USE_FIREBASE:"true",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"842512285290",REACT_APP_BUILD_TAG:"",REACT_APP_BUILD_SHA:"fe8e1f7d7be3d94ffab07172b15fcd8341eda200",REACT_APP_BUILD_TIME:"2026-01-24T21:29:52Z",REACT_APP_FIREBASE_STORAGE_BUCKET:"c3s-monkey-trader.appspot.com",REACT_APP_FIREBASE_AUTH_DOMAIN:"c3s-monkey-trader.firebaseapp.com",REACT_APP_BUILD_BRANCH:"main",REACT_APP_FIRESTORE_FORCE_LONG_POLLING:"true",REACT_APP_FIREBASE_PROJECT_ID:"c3s-monkey-trader",REACT_APP_FIREBASE_APP_ID:"1:842512285290:web:c87e2c00233deaa601413",REACT_APP_FIREBASE_API_KEY:"AIzaSyAgwG2YEqpz-kf7wPKqfNKihKcBnfskzbc"}.GITHUB_REPOSITORY||"monkey-trader/traders-mirror","/commit/").concat(i.sha),target:"_blank",rel:"noreferrer",children:i.sha.substring(0,7)}):"n/a"})]}),(0,h.jsxs)("div",{className:F_.debugRow,children:[(0,h.jsx)("label",{className:F_.fieldLabel,children:"Tag"}),(0,h.jsx)("div",{children:i.tag||"n/a"})]}),(0,h.jsxs)("div",{className:F_.debugRow,children:[(0,h.jsx)("label",{className:F_.fieldLabel,children:"Built"}),(0,h.jsx)("div",{children:i.time||"n/a"})]})]})]})}const sb="Layout_shell__R3AlY",ab="Layout_main__ewt4V",ob="Layout_fullWidth__V+tZ1",lb="Header_header__WZIeb",cb="Header_brand__vGE-p",ub="Header_nav__g371M",db="Header_controls__qA5QD",hb="Header_hamburger__ineOB",fb="Header_mobileNav__ozvIV",pb="Header_mobileOpen__HKIaZ",mb="Header_backdrop__ruh8h",gb="Header_backdropVisible__ShbBa",yb="UserBadge_badge__y0F6Z",vb="UserBadge_avatar__SQQJB",_b="UserBadge_name__YJ6RY",bb="UserBadge_actions__c19cy";class wb extends Error{constructor(e){super(e),this.name="AuthError"}}class Eb extends wb{constructor(){super("User is not authenticated"),this.name="AuthNotAuthenticatedError"}}class Sb extends wb{constructor(e){super(e),this.name="AuthProviderError"}}class Tb{constructor(e){if(this.value=void 0,!e||"string"!==typeof e||e.trim().length<3)throw new Ib(e);this.value=e.trim()}}class Ib extends Error{constructor(e){super("Invalid UserId: ".concat(String(e))),this.name="UserIdInvalidError"}}class kb{static create(e){var t,n;if(!e||"object"!==typeof e)throw new Error("Invalid input for AuthUserFactory");const r=e;return{id:new Tb(String(null!==(t=null!==(n=r.id)&&void 0!==n?n:r.uid)&&void 0!==t?t:"")).value,displayName:"string"===typeof r.displayName?r.displayName:null,email:"string"===typeof r.email?r.email:null,photoURL:"string"===typeof r.photoURL?r.photoURL:null}}}var Cb;const Ab="test"===(null===(Cb={NODE_ENV:"production"})||void 0===Cb?void 0:Cb.MODE)?new class{constructor(){this.currentUser=null}async getCurrentUser(){return this.currentUser}async signInWithGoogle(){const e={id:"test-user",displayName:"Test User",email:"test@example.com",photoURL:null};return this.currentUser=e,e}async signOut(){this.currentUser=null}onAuthStateChanged(e){return e(this.currentUser),()=>{}}}:new class{async getCurrentUser(){ng();const{auth:e}=tg(),t=e.currentUser;return t?kb.create(t):null}async signInWithGoogle(){ng();const{auth:e}=tg(),t=new Ei,n=await async function(e,t,n){if(hn(e.app))return Promise.reject(Mn(e,"operation-not-supported-in-this-environment"));const r=Kr(e);Vn(e,t,_i);const i=cs(r,n);return new gs(r,"signInViaPopup",t,i).executeNotNull()}(e,t);return kb.create(n.user)}async signOut(){ng();const{auth:e}=tg();await function(e){return $e(e).signOut()}(e)}onAuthStateChanged(e){ng();const{auth:t}=tg();try{Pi(t,Fi)}catch(r){}const n=function(e,t,n,r){return $e(e).onAuthStateChanged(t,n,r)}(t,t=>{e(t?kb.create(t):null)});return n}},Nb=new class{constructor(e){this.repo=e}async getCurrentUser(){const e=await this.repo.getCurrentUser();if(!e)throw new Eb;return e}async signInWithGoogle(){try{return await this.repo.signInWithGoogle()}catch(e){const t=e instanceof Error?e.message:String(e);throw new Sb("Google Sign-In failed: ".concat(t))}}async signOut(){await this.repo.signOut()}onAuthStateChanged(e){return this.repo.onAuthStateChanged(e)}}(Ab),xb=(0,r.createContext)(void 0),Rb=e=>{let{children:t}=e;const[n,i]=(0,r.useState)(null),[s,a]=(0,r.useState)(!0),[o,l]=(0,r.useState)(null);(0,r.useEffect)(()=>{a(!0);const e=Nb.onAuthStateChanged(e=>{i(e),l(null),a(!1)});return()=>{try{e()}catch(t){}}},[]);return(0,h.jsx)(xb.Provider,{value:{user:n,loading:s,error:o,signIn:async()=>{a(!0);try{const e=await Nb.signInWithGoogle();i(e),l(null)}catch(e){const t=e instanceof Error?e.message:String(e);l(t)}finally{a(!1)}},signOut:async()=>{a(!0),await Nb.signOut(),i(null),l(null),a(!1)},clearError:()=>l(null)},children:t})};function Pb(){const e=(0,r.useContext)(xb);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}const Db=e=>{let{compactView:t=!1}=e;const{user:n,signOut:r,loading:i}=Pb();if(!n)return null;const s=n.displayName||n.email||"User",a=function(e){var t,n;if(!e)return"?";const r=e.trim(),i=r.split(/\s+/);return i.length>=2?(i[0][0]+i[1][0]).toUpperCase():null!==(t=null===(n=r[0])||void 0===n?void 0:n.toUpperCase())&&void 0!==t?t:"?"}(s);return(0,h.jsxs)("div",{className:yb,"aria-label":"User account",children:[(0,h.jsx)("span",{className:vb,"aria-hidden":!0,children:n.photoURL?(0,h.jsx)("img",{src:n.photoURL,width:28,height:28,alt:s||"avatar"}):a}),!t&&(0,h.jsx)("span",{className:_b,children:s}),(0,h.jsx)("div",{className:bb,children:(0,h.jsx)(p,{variant:"secondary",onClick:r,disabled:i,"aria-label":"Logout",children:"Logout"})})]})},Lb="RepoOutboxBadge_outbox__sRrqa",Ob="RepoOutboxBadge_count__UFEI1";const jb=function(){const[e,t]=(0,r.useState)(0),n=r.useRef({});return(0,r.useEffect)(()=>{function e(e){const r=e.detail||{};r.feature&&(n.current[r.feature]=r.queuedCount&&r.queuedCount>0?r.queuedCount:0);const i=Object.values(n.current).reduce((e,t)=>e+(t||0),0);t(i)}return globalThis.addEventListener("repo-sync-status",e),()=>globalThis.removeEventListener("repo-sync-status",e)},[]),e?(0,h.jsxs)("div",{className:Lb,role:"status",title:"Outbox: ".concat(e," pending"),"aria-live":"polite",children:[(0,h.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:[(0,h.jsx)("path",{d:"M3 7h18M3 7l3 13h12l3-13",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),(0,h.jsx)("path",{d:"M16 3v4M8 3v4",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]}),(0,h.jsx)("span",{className:Ob,children:e})]}):null};function Fb(){const[e,t]=(0,r.useState)(!1),n=(0,r.useRef)(null),i=(0,r.useRef)(null);return(0,r.useEffect)(()=>{function r(e){"Escape"===e.key&&t(!1)}function s(r){const s=r.target;e&&(n.current&&n.current.contains(s)||i.current&&i.current.contains(s)||t(!1))}return document.addEventListener("keydown",r),document.addEventListener("mousedown",s),()=>{document.removeEventListener("keydown",r),document.removeEventListener("mousedown",s)}},[e]),(0,r.useEffect)(()=>{const t=document.body.style.overflow;return document.body.style.overflow=e?"hidden":t||"",()=>{document.body.style.overflow=t||""}},[e]),(0,r.useEffect)(()=>{if(e&&n.current){const e=n.current.querySelector("a");null===e||void 0===e||e.focus()}},[e]),(0,h.jsxs)("header",{className:lb,children:[(0,h.jsx)("div",{className:cb,children:"Traders Mirror"}),(0,h.jsxs)("nav",{className:ub,children:[(0,h.jsx)("a",{href:"#/journal",children:"Journal"}),(0,h.jsx)("a",{href:"#/analysis",children:"Analyse"}),(0,h.jsx)("a",{href:"#/settings",children:"Settings"})]}),(0,h.jsx)("button",{ref:i,type:"button",className:hb,"aria-label":e?"Close menu":"Open menu","aria-expanded":e,"aria-controls":"mobile-nav",onClick:()=>t(e=>!e),children:(0,h.jsxs)("svg",{width:"20",height:"14",viewBox:"0 0 20 14",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:[(0,h.jsx)("rect",{y:"1",width:"20",height:"2",rx:"1",fill:"currentColor"}),(0,h.jsx)("rect",{y:"6",width:"20",height:"2",rx:"1",fill:"currentColor"}),(0,h.jsx)("rect",{y:"11",width:"20",height:"2",rx:"1",fill:"currentColor"})]})}),(0,h.jsx)("div",{className:"".concat(mb," ").concat(e?gb:""),"aria-hidden":!e,onClick:()=>t(!1)}),(0,h.jsxs)("div",{id:"mobile-nav",ref:n,className:"".concat(fb," ").concat(e?pb:""),role:"menu","aria-hidden":!e,children:[(0,h.jsx)("a",{href:"#/journal",role:"menuitem",onClick:()=>t(!1),children:"Journal"}),(0,h.jsx)("a",{href:"#/analysis",role:"menuitem",onClick:()=>t(!1),children:"Analyse"}),(0,h.jsx)("a",{href:"#/settings",role:"menuitem",onClick:()=>t(!1),children:"Settings"})]}),(0,h.jsxs)("div",{className:db,children:[(0,h.jsx)(jb,{}),"undefined"!==typeof window&&window.location&&window.location.hash&&window.location.hash.startsWith("#/settings")?(0,h.jsx)(q_,{}):null,(0,h.jsx)(Db,{})]})]})}function Mb(e){let{children:t,fullWidth:n=!1}=e;return(0,h.jsx)("div",{className:sb,children:(0,h.jsxs)("div",{className:n?"app-container ".concat(ob):"app-container",children:[(0,h.jsx)(Fb,{}),(0,h.jsx)("main",{className:ab,children:t})]})})}const Ub=()=>{const{signIn:e,loading:t,error:n,clearError:r}=Pb();return(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[(0,h.jsx)(p,{onClick:()=>{r(),e()},disabled:t,variant:"primary",children:t?"Loading...":"Login mit Google"}),n?(0,h.jsx)("div",{role:"alert",style:{color:"#c62828",fontSize:14,maxWidth:420,textAlign:"center"},children:n}):null]})},Bb=e=>{let{children:t}=e;const{user:n,loading:r}=Pb();return r?(0,h.jsx)("div",{children:"Loading..."}):n?(0,h.jsx)(h.Fragment,{children:t}):(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:[(0,h.jsx)("p",{children:"Bitte einloggen, um fortzufahren."}),(0,h.jsx)(Ub,{})]})};const Vb=function(){(0,r.useEffect)(()=>{const e=localStorage.getItem("theme");e?document.documentElement.setAttribute("data-theme",e):document.documentElement.getAttribute("data-theme")||document.documentElement.setAttribute("data-theme","nightscope")},[]);const[e,t]=(0,r.useState)(()=>window.location.hash||"#/journal"),[n,i]=(0,r.useState)(0);(0,r.useEffect)(()=>{const e=()=>t(window.location.hash||"#/journal");window.addEventListener("hashchange",e);const n=()=>i(e=>e+1);return globalThis.addEventListener("settings-changed",n),globalThis.addEventListener("storage",n),()=>{window.removeEventListener("hashchange",e),globalThis.removeEventListener("settings-changed",n),globalThis.removeEventListener("storage",n)}},[]);const s=e.startsWith("#/settings"),a=e.startsWith("#/analysis");let o;if(s)o=(0,h.jsx)(ib,{});else if(a)o=(0,h.jsx)($y,{});else{const e=((e,t)=>{const n=null!==(e={NODE_ENV:"production"})&&void 0!==e?e:{},r=null!==(t=n.VITE_USE_FIREBASE)&&void 0!==t?t:"true",i="boolean"===typeof r?r:"string"===typeof r&&"true"===r.toLowerCase(),s=Boolean(n.VITE_FIREBASE_API_KEY||"AIzaSyAgwG2YEqpz-kf7wPKqfNKihKcBnfskzbc");return i||s})(),t=(()=>{try{const e=localStorage.getItem("mt_user_settings_v1");if(!e)return;const t=JSON.parse(e);return"boolean"===typeof t.useCloudSync?t.useCloudSync:void 0}catch(e){return}})(),n=e&&!1!==t,r=(()=>{if(n){const e=new P_;return new j_({remote:e})}return new j_})();o=(0,h.jsx)(N_,{repo:r})}return(0,h.jsx)(Rb,{children:(0,h.jsx)(Bb,{children:(0,h.jsx)(W_,{children:(0,h.jsx)(Mb,{fullWidth:!0,children:o})})})})};i.createRoot(document.getElementById("root")).render((0,h.jsx)(r.StrictMode,{children:(0,h.jsx)(Rb,{children:(0,h.jsx)(Vb,{})})}))})();
//# sourceMappingURL=main.47773370.js.map