' Architecture: Onion / Ports & Adapters
@startuml architecture
skinparam componentStyle rectangle

package "Presentation" {
  [TradeJournal.tsx] as UI
  [ErrorMapper\nsrc/presentation/trade/errorMapper.ts] as ErrorMapper
}

package "Application" {
  [TradeService.ts] as Service
  [Use-Cases] as UseCases
}

package "Domain" {
  [Entities\nTrade.ts] as DomainEntity
  [ValueObjects\nSize.ts\nPrice.ts\nTradeSymbol.ts\nTradeTarget.ts] as VOs
  [Factories\nTradeFactory.ts] as Factory
  [Domain Errors\nDomainErrors.ts] as Errors
  [Interfaces\nTradeRepository.ts] as Ports
  [Services\nTradeTargetingService.ts] as DomainServices
}

package "Infrastructure" {
  [InMemoryTradeRepository.ts] as AdapterRepo
  [External Adapters] as Ext
}

'Relationships (Ports & Adapters)
UI --> Service : use
UI --> ErrorMapper : map errors
Service --> Factory : create / validate
Service --> DomainServices : assess / apply targeting
Factory --> VOs : normalize / validate
Service --> Ports : depends on (import type)
AdapterRepo ..> Ports : implements
AdapterRepo --> Ext : persist/store

' Layer boundaries (onion-like)
Service ..> DomainEntity : orchestrates
Factory ..> DomainEntity : creates
DomainServices ..> DomainEntity : evaluate / mutate targets
DomainServices ..> VOs : validate targets

note left of UI
Presentation: React + CSS Modules

- Validation and mapping of domain errors to field/global messages happens in Presentation layer (ErrorMapper)
end note

note right of AdapterRepo
Infrastructure: Adapters implement Ports
end note
@enduml
